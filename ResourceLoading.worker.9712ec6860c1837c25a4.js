!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}({4:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"create",(function(){return S})),n.d(r,"clone",(function(){return E})),n.d(r,"copy",(function(){return N})),n.d(r,"fromValues",(function(){return k})),n.d(r,"set",(function(){return C})),n.d(r,"identity",(function(){return B})),n.d(r,"transpose",(function(){return F})),n.d(r,"invert",(function(){return O})),n.d(r,"adjoint",(function(){return U})),n.d(r,"determinant",(function(){return V})),n.d(r,"multiply",(function(){return R})),n.d(r,"translate",(function(){return L})),n.d(r,"scale",(function(){return D})),n.d(r,"rotate",(function(){return z})),n.d(r,"rotateX",(function(){return j})),n.d(r,"rotateY",(function(){return P})),n.d(r,"rotateZ",(function(){return q})),n.d(r,"fromTranslation",(function(){return H})),n.d(r,"fromScaling",(function(){return W})),n.d(r,"fromRotation",(function(){return G})),n.d(r,"fromXRotation",(function(){return X})),n.d(r,"fromYRotation",(function(){return Y})),n.d(r,"fromZRotation",(function(){return Z})),n.d(r,"fromRotationTranslation",(function(){return K})),n.d(r,"fromQuat2",(function(){return J})),n.d(r,"getTranslation",(function(){return Q})),n.d(r,"getScaling",(function(){return $})),n.d(r,"getRotation",(function(){return tt})),n.d(r,"fromRotationTranslationScale",(function(){return et})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return nt})),n.d(r,"fromQuat",(function(){return rt})),n.d(r,"frustum",(function(){return it})),n.d(r,"perspective",(function(){return at})),n.d(r,"perspectiveFromFieldOfView",(function(){return ot})),n.d(r,"ortho",(function(){return st})),n.d(r,"lookAt",(function(){return ut})),n.d(r,"targetTo",(function(){return ct})),n.d(r,"str",(function(){return ht})),n.d(r,"frob",(function(){return ft})),n.d(r,"add",(function(){return lt})),n.d(r,"subtract",(function(){return dt})),n.d(r,"multiplyScalar",(function(){return pt})),n.d(r,"multiplyScalarAndAdd",(function(){return mt})),n.d(r,"exactEquals",(function(){return _t})),n.d(r,"equals",(function(){return vt})),n.d(r,"mul",(function(){return gt})),n.d(r,"sub",(function(){return yt}));var i={};n.r(i),n.d(i,"create",(function(){return bt})),n.d(i,"clone",(function(){return Mt})),n.d(i,"length",(function(){return xt})),n.d(i,"fromValues",(function(){return wt})),n.d(i,"copy",(function(){return It})),n.d(i,"set",(function(){return Tt})),n.d(i,"add",(function(){return At})),n.d(i,"subtract",(function(){return St})),n.d(i,"multiply",(function(){return Et})),n.d(i,"divide",(function(){return Nt})),n.d(i,"ceil",(function(){return kt})),n.d(i,"floor",(function(){return Ct})),n.d(i,"min",(function(){return Bt})),n.d(i,"max",(function(){return Ft})),n.d(i,"round",(function(){return Ot})),n.d(i,"scale",(function(){return Ut})),n.d(i,"scaleAndAdd",(function(){return Vt})),n.d(i,"distance",(function(){return Rt})),n.d(i,"squaredDistance",(function(){return Lt})),n.d(i,"squaredLength",(function(){return Dt})),n.d(i,"negate",(function(){return zt})),n.d(i,"inverse",(function(){return jt})),n.d(i,"normalize",(function(){return Pt})),n.d(i,"dot",(function(){return qt})),n.d(i,"cross",(function(){return Ht})),n.d(i,"lerp",(function(){return Wt})),n.d(i,"hermite",(function(){return Gt})),n.d(i,"bezier",(function(){return Xt})),n.d(i,"random",(function(){return Yt})),n.d(i,"transformMat4",(function(){return Zt})),n.d(i,"transformMat3",(function(){return Kt})),n.d(i,"transformQuat",(function(){return Jt})),n.d(i,"rotateX",(function(){return Qt})),n.d(i,"rotateY",(function(){return $t})),n.d(i,"rotateZ",(function(){return te})),n.d(i,"angle",(function(){return ee})),n.d(i,"zero",(function(){return ne})),n.d(i,"str",(function(){return re})),n.d(i,"exactEquals",(function(){return ie})),n.d(i,"equals",(function(){return ae})),n.d(i,"sub",(function(){return se})),n.d(i,"mul",(function(){return ue})),n.d(i,"div",(function(){return ce})),n.d(i,"dist",(function(){return he})),n.d(i,"sqrDist",(function(){return fe})),n.d(i,"len",(function(){return le})),n.d(i,"sqrLen",(function(){return de})),n.d(i,"forEach",(function(){return pe}));var a,o={};n.r(o),n.d(o,"create",(function(){return ve})),n.d(o,"identity",(function(){return ge})),n.d(o,"setAxisAngle",(function(){return ye})),n.d(o,"getAxisAngle",(function(){return be})),n.d(o,"getAngle",(function(){return Me})),n.d(o,"multiply",(function(){return xe})),n.d(o,"rotateX",(function(){return we})),n.d(o,"rotateY",(function(){return Ie})),n.d(o,"rotateZ",(function(){return Te})),n.d(o,"calculateW",(function(){return Ae})),n.d(o,"exp",(function(){return Se})),n.d(o,"ln",(function(){return Ee})),n.d(o,"pow",(function(){return Ne})),n.d(o,"slerp",(function(){return ke})),n.d(o,"random",(function(){return Ce})),n.d(o,"invert",(function(){return Be})),n.d(o,"conjugate",(function(){return Fe})),n.d(o,"fromMat3",(function(){return Oe})),n.d(o,"fromEuler",(function(){return Ue})),n.d(o,"str",(function(){return Ve})),n.d(o,"clone",(function(){return He})),n.d(o,"fromValues",(function(){return We})),n.d(o,"copy",(function(){return Ge})),n.d(o,"set",(function(){return Xe})),n.d(o,"add",(function(){return Ye})),n.d(o,"mul",(function(){return Ze})),n.d(o,"scale",(function(){return Ke})),n.d(o,"dot",(function(){return Je})),n.d(o,"lerp",(function(){return Qe})),n.d(o,"length",(function(){return $e})),n.d(o,"len",(function(){return tn})),n.d(o,"squaredLength",(function(){return en})),n.d(o,"sqrLen",(function(){return nn})),n.d(o,"normalize",(function(){return rn})),n.d(o,"exactEquals",(function(){return an})),n.d(o,"equals",(function(){return on})),n.d(o,"rotationTo",(function(){return sn})),n.d(o,"sqlerp",(function(){return un})),n.d(o,"setAxes",(function(){return cn})),function(t){t[t.LoadingAsync=0]="LoadingAsync",t[t.LoadingSync=1]="LoadingSync",t[t.Loaded=2]="Loaded",t[t.Unloaded=3]="Unloaded",t[t.Failed=4]="Failed"}(a||(a={}));var s,u,c,h,f,l,d,p,m,_,v,g,y;function b(t,e=""){if(!t){const t=new Error(`Assert fail: ${e}`);throw console.error(t.stack),t}}function M(t,e){if(null!=t)return t;throw new Error(w(e,"Missing object"))}function x(t){return null!=t}function w(t,e){return null!=t?t:e}!function(t){t[t.VertexArrayObject=1]="VertexArrayObject",t[t.TextureFloat=2]="TextureFloat",t[t.TextureHalf=4]="TextureHalf",t[t.TextureFloatLinearFiltering=8]="TextureFloatLinearFiltering",t[t.TextureHalfLinearFiltering=16]="TextureHalfLinearFiltering",t[t.TextureWrite=32]="TextureWrite",t[t.ShaderDerivatives=64]="ShaderDerivatives",t[t.Instancing=128]="Instancing",t[t.AnistropicFiltering=256]="AnistropicFiltering"}(s||(s={})),function(t){t[t.Undefined=0]="Undefined",t[t.Float=1]="Float",t[t.Float2=2]="Float2",t[t.Float3=3]="Float3",t[t.Float4=4]="Float4",t[t.Int=5]="Int",t[t.Int2=6]="Int2",t[t.Int3=7]="Int3",t[t.Int4=8]="Int4",t[t.Uint=9]="Uint",t[t.Uint2=10]="Uint2",t[t.Uint3=11]="Uint3",t[t.Uint4=12]="Uint4",t[t.Short=13]="Short",t[t.Short2=14]="Short2",t[t.Short3=15]="Short3",t[t.Short4=16]="Short4",t[t.Ushort=17]="Ushort",t[t.Ushort2=18]="Ushort2",t[t.Ushort3=19]="Ushort3",t[t.Ushort4=20]="Ushort4",t[t.Char=21]="Char",t[t.Char2=22]="Char2",t[t.Char3=23]="Char3",t[t.Char4=24]="Char4",t[t.Uchar=25]="Uchar",t[t.Uchar2=26]="Uchar2",t[t.Uchar3=27]="Uchar3",t[t.Uchar4=28]="Uchar4",t[t.Half=29]="Half",t[t.Half2=30]="Half2",t[t.Half3=31]="Half3",t[t.Half4=32]="Half4",t[t.Float3x3=33]="Float3x3",t[t.Float3x4=34]="Float3x4",t[t.Float4x4=35]="Float4x4",t[t.Texture2D=240]="Texture2D",t[t.Texture3D=241]="Texture3D",t[t.TextureCube=242]="TextureCube",t[t.Short_Norm=256]="Short_Norm",t[t.Short2_Norm=257]="Short2_Norm",t[t.Short3_Norm=258]="Short3_Norm",t[t.Short4_Norm=259]="Short4_Norm",t[t.Ushort_Norm=260]="Ushort_Norm",t[t.Ushort2_Norm=261]="Ushort2_Norm",t[t.Ushort3_Norm=262]="Ushort3_Norm",t[t.Ushort4_Norm=263]="Ushort4_Norm",t[t.Char_Norm=264]="Char_Norm",t[t.Char2_Norm=265]="Char2_Norm",t[t.Char3_Norm=266]="Char3_Norm",t[t.Char4_Norm=267]="Char4_Norm",t[t.Uchar_Norm=268]="Uchar_Norm",t[t.Uchar2_Norm=269]="Uchar2_Norm",t[t.Uchar3_Norm=270]="Uchar3_Norm",t[t.Uchar4_Norm=271]="Uchar4_Norm"}(u||(u={})),function(t){t[t.Texture2D=240]="Texture2D",t[t.Texture3D=241]="Texture3D",t[t.TextureCube=242]="TextureCube"}(c||(c={})),function(t){t[t.Undefined=0]="Undefined",t[t.U565=1]="U565",t[t.U8=2]="U8",t[t.U8_sRGB=3]="U8_sRGB",t[t.U8x2=4]="U8x2",t[t.U8x2_sRGB=5]="U8x2_sRGB",t[t.U8x3=6]="U8x3",t[t.U8x3_sRGB=7]="U8x3_sRGB",t[t.U8x4=8]="U8x4",t[t.U8x4_sRGB=9]="U8x4_sRGB",t[t.U10_10_10_2=10]="U10_10_10_2",t[t.F11_11_10=11]="F11_11_10",t[t.F16=12]="F16",t[t.F16x2=13]="F16x2",t[t.F16x3=14]="F16x3",t[t.F16x4=15]="F16x4",t[t.F32x2=16]="F32x2",t[t.F32x3=17]="F32x3",t[t.F32x4=18]="F32x4",t[t.Depth32=19]="Depth32",t[t.Depth24Stencil8=20]="Depth24Stencil8"}(h||(h={})),function(t){t[t.Nearest=0]="Nearest",t[t.Linear=1]="Linear"}(f||(f={})),function(t){t[t.Never=0]="Never",t[t.Less=1]="Less",t[t.Equal=2]="Equal",t[t.LessEqual=3]="LessEqual",t[t.Greater=4]="Greater",t[t.NotEqual=5]="NotEqual",t[t.GreaterEqual=6]="GreaterEqual",t[t.Always=7]="Always"}(l||(l={})),function(t){t[t.Points=0]="Points",t[t.Lines=1]="Lines",t[t.LineLoop=2]="LineLoop",t[t.LineStrip=3]="LineStrip",t[t.Triangles=4]="Triangles",t[t.TriangleStrip=5]="TriangleStrip",t[t.TriangleFan=6]="TriangleFan"}(d||(d={})),function(t){t[t.Undefined=0]="Undefined",t[t.Uniform=1]="Uniform",t[t.Vertex=2]="Vertex",t[t.Index=3]="Index",t[t.Readback=4]="Readback"}(p||(p={})),function(t){t[t.Undefined=0]="Undefined",t[t.UniformBuffer=1]="UniformBuffer",t[t.Texture=2]="Texture"}(m||(m={})),function(t){t[t.None=0]="None",t[t.Static=1]="Static",t[t.Dynamic=2]="Dynamic"}(_||(_={})),function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Front=2]="Front"}(v||(v={})),function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Source=2]="Source",t[t.OneMinusSource=3]="OneMinusSource"}(g||(g={})),function(t){t[t.Vertex=0]="Vertex",t[t.Instance=1]="Instance"}(y||(y={}));var I=1e-6,T="undefined"!=typeof Float32Array?Float32Array:Array,A=Math.random;Math.PI;function S(){var t=new T(16);return T!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function E(t){var e=new T(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function N(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function k(t,e,n,r,i,a,o,s,u,c,h,f,l,d,p,m){var _=new T(16);return _[0]=t,_[1]=e,_[2]=n,_[3]=r,_[4]=i,_[5]=a,_[6]=o,_[7]=s,_[8]=u,_[9]=c,_[10]=h,_[11]=f,_[12]=l,_[13]=d,_[14]=p,_[15]=m,_}function C(t,e,n,r,i,a,o,s,u,c,h,f,l,d,p,m,_){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=f,t[11]=l,t[12]=d,t[13]=p,t[14]=m,t[15]=_,t}function B(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function F(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function O(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],p=e[12],m=e[13],_=e[14],v=e[15],g=n*s-r*o,y=n*u-i*o,b=n*c-a*o,M=r*u-i*s,x=r*c-a*s,w=i*c-a*u,I=h*m-f*p,T=h*_-l*p,A=h*v-d*p,S=f*_-l*m,E=f*v-d*m,N=l*v-d*_,k=g*N-y*E+b*S+M*A-x*T+w*I;return k?(k=1/k,t[0]=(s*N-u*E+c*S)*k,t[1]=(i*E-r*N-a*S)*k,t[2]=(m*w-_*x+v*M)*k,t[3]=(l*x-f*w-d*M)*k,t[4]=(u*A-o*N-c*T)*k,t[5]=(n*N-i*A+a*T)*k,t[6]=(_*b-p*w-v*y)*k,t[7]=(h*w-l*b+d*y)*k,t[8]=(o*E-s*A+c*I)*k,t[9]=(r*A-n*E-a*I)*k,t[10]=(p*x-m*b+v*g)*k,t[11]=(f*b-h*x-d*g)*k,t[12]=(s*T-o*S-u*I)*k,t[13]=(n*S-r*T+i*I)*k,t[14]=(m*y-p*M-_*g)*k,t[15]=(h*M-f*y+l*g)*k,t):null}function U(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],p=e[12],m=e[13],_=e[14],v=e[15];return t[0]=s*(l*v-d*_)-f*(u*v-c*_)+m*(u*d-c*l),t[1]=-(r*(l*v-d*_)-f*(i*v-a*_)+m*(i*d-a*l)),t[2]=r*(u*v-c*_)-s*(i*v-a*_)+m*(i*c-a*u),t[3]=-(r*(u*d-c*l)-s*(i*d-a*l)+f*(i*c-a*u)),t[4]=-(o*(l*v-d*_)-h*(u*v-c*_)+p*(u*d-c*l)),t[5]=n*(l*v-d*_)-h*(i*v-a*_)+p*(i*d-a*l),t[6]=-(n*(u*v-c*_)-o*(i*v-a*_)+p*(i*c-a*u)),t[7]=n*(u*d-c*l)-o*(i*d-a*l)+h*(i*c-a*u),t[8]=o*(f*v-d*m)-h*(s*v-c*m)+p*(s*d-c*f),t[9]=-(n*(f*v-d*m)-h*(r*v-a*m)+p*(r*d-a*f)),t[10]=n*(s*v-c*m)-o*(r*v-a*m)+p*(r*c-a*s),t[11]=-(n*(s*d-c*f)-o*(r*d-a*f)+h*(r*c-a*s)),t[12]=-(o*(f*_-l*m)-h*(s*_-u*m)+p*(s*l-u*f)),t[13]=n*(f*_-l*m)-h*(r*_-i*m)+p*(r*l-i*f),t[14]=-(n*(s*_-u*m)-o*(r*_-i*m)+p*(r*u-i*s)),t[15]=n*(s*l-u*f)-o*(r*l-i*f)+h*(r*u-i*s),t}function V(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],d=t[12],p=t[13],m=t[14],_=t[15];return(e*o-n*a)*(f*_-l*m)-(e*s-r*a)*(h*_-l*p)+(e*u-i*a)*(h*m-f*p)+(n*s-r*o)*(c*_-l*d)-(n*u-i*o)*(c*m-f*d)+(r*u-i*s)*(c*p-h*d)}function R(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],d=e[10],p=e[11],m=e[12],_=e[13],v=e[14],g=e[15],y=n[0],b=n[1],M=n[2],x=n[3];return t[0]=y*r+b*s+M*f+x*m,t[1]=y*i+b*u+M*l+x*_,t[2]=y*a+b*c+M*d+x*v,t[3]=y*o+b*h+M*p+x*g,y=n[4],b=n[5],M=n[6],x=n[7],t[4]=y*r+b*s+M*f+x*m,t[5]=y*i+b*u+M*l+x*_,t[6]=y*a+b*c+M*d+x*v,t[7]=y*o+b*h+M*p+x*g,y=n[8],b=n[9],M=n[10],x=n[11],t[8]=y*r+b*s+M*f+x*m,t[9]=y*i+b*u+M*l+x*_,t[10]=y*a+b*c+M*d+x*v,t[11]=y*o+b*h+M*p+x*g,y=n[12],b=n[13],M=n[14],x=n[15],t[12]=y*r+b*s+M*f+x*m,t[13]=y*i+b*u+M*l+x*_,t[14]=y*a+b*c+M*d+x*v,t[15]=y*o+b*h+M*p+x*g,t}function L(t,e,n){var r,i,a,o,s,u,c,h,f,l,d,p,m=n[0],_=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*_+e[8]*v+e[12],t[13]=e[1]*m+e[5]*_+e[9]*v+e[13],t[14]=e[2]*m+e[6]*_+e[10]*v+e[14],t[15]=e[3]*m+e[7]*_+e[11]*v+e[15]):(r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=d,t[11]=p,t[12]=r*m+s*_+f*v+e[12],t[13]=i*m+u*_+l*v+e[13],t[14]=a*m+c*_+d*v+e[14],t[15]=o*m+h*_+p*v+e[15]),t}function D(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function z(t,e,n,r){var i,a,o,s,u,c,h,f,l,d,p,m,_,v,g,y,b,M,x,w,T,A,S,E,N=r[0],k=r[1],C=r[2],B=Math.hypot(N,k,C);return B<I?null:(N*=B=1/B,k*=B,C*=B,i=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],u=e[1],c=e[2],h=e[3],f=e[4],l=e[5],d=e[6],p=e[7],m=e[8],_=e[9],v=e[10],g=e[11],y=N*N*o+a,b=k*N*o+C*i,M=C*N*o-k*i,x=N*k*o-C*i,w=k*k*o+a,T=C*k*o+N*i,A=N*C*o+k*i,S=k*C*o-N*i,E=C*C*o+a,t[0]=s*y+f*b+m*M,t[1]=u*y+l*b+_*M,t[2]=c*y+d*b+v*M,t[3]=h*y+p*b+g*M,t[4]=s*x+f*w+m*T,t[5]=u*x+l*w+_*T,t[6]=c*x+d*w+v*T,t[7]=h*x+p*w+g*T,t[8]=s*A+f*S+m*E,t[9]=u*A+l*S+_*E,t[10]=c*A+d*S+v*E,t[11]=h*A+p*S+g*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function j(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],o=e[5],s=e[6],u=e[7],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=o*i+h*r,t[6]=s*i+f*r,t[7]=u*i+l*r,t[8]=c*i-a*r,t[9]=h*i-o*r,t[10]=f*i-s*r,t[11]=l*i-u*r,t}function P(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=o*i-h*r,t[2]=s*i-f*r,t[3]=u*i-l*r,t[8]=a*r+c*i,t[9]=o*r+h*i,t[10]=s*r+f*i,t[11]=u*r+l*i,t}function q(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],o=e[1],s=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=o*i+h*r,t[2]=s*i+f*r,t[3]=u*i+l*r,t[4]=c*i-a*r,t[5]=h*i-o*r,t[6]=f*i-s*r,t[7]=l*i-u*r,t}function H(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function W(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G(t,e,n){var r,i,a,o=n[0],s=n[1],u=n[2],c=Math.hypot(o,s,u);return c<I?null:(o*=c=1/c,s*=c,u*=c,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=o*o*a+i,t[1]=s*o*a+u*r,t[2]=u*o*a-s*r,t[3]=0,t[4]=o*s*a-u*r,t[5]=s*s*a+i,t[6]=u*s*a+o*r,t[7]=0,t[8]=o*u*a+s*r,t[9]=s*u*a-o*r,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function X(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Y(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Z(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function K(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,u=i+i,c=a+a,h=r*s,f=r*u,l=r*c,d=i*u,p=i*c,m=a*c,_=o*s,v=o*u,g=o*c;return t[0]=1-(d+m),t[1]=f+g,t[2]=l-v,t[3]=0,t[4]=f-g,t[5]=1-(h+m),t[6]=p+_,t[7]=0,t[8]=l+v,t[9]=p-_,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function J(t,e){var n=new T(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=r*r+i*i+a*a+o*o;return f>0?(n[0]=2*(s*o+h*r+u*a-c*i)/f,n[1]=2*(u*o+h*i+c*r-s*a)/f,n[2]=2*(c*o+h*a+s*i-u*r)/f):(n[0]=2*(s*o+h*r+u*a-c*i),n[1]=2*(u*o+h*i+c*r-s*a),n[2]=2*(c*o+h*a+s*i-u*r)),K(t,e,n),t}function Q(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function $(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(u,c,h),t}function tt(t,e){var n=new T(3);$(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],o=e[0]*r,s=e[1]*i,u=e[2]*a,c=e[4]*r,h=e[5]*i,f=e[6]*a,l=e[8]*r,d=e[9]*i,p=e[10]*a,m=o+h+p,_=0;return m>0?(_=2*Math.sqrt(m+1),t[3]=.25*_,t[0]=(f-d)/_,t[1]=(l-u)/_,t[2]=(s-c)/_):o>h&&o>p?(_=2*Math.sqrt(1+o-h-p),t[3]=(f-d)/_,t[0]=.25*_,t[1]=(s+c)/_,t[2]=(l+u)/_):h>p?(_=2*Math.sqrt(1+h-o-p),t[3]=(l-u)/_,t[0]=(s+c)/_,t[1]=.25*_,t[2]=(f+d)/_):(_=2*Math.sqrt(1+p-o-h),t[3]=(s-c)/_,t[0]=(l+u)/_,t[1]=(f+d)/_,t[2]=.25*_),t}function et(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,c=a+a,h=o+o,f=i*u,l=i*c,d=i*h,p=a*c,m=a*h,_=o*h,v=s*u,g=s*c,y=s*h,b=r[0],M=r[1],x=r[2];return t[0]=(1-(p+_))*b,t[1]=(l+y)*b,t[2]=(d-g)*b,t[3]=0,t[4]=(l-y)*M,t[5]=(1-(f+_))*M,t[6]=(m+v)*M,t[7]=0,t[8]=(d+g)*x,t[9]=(m-v)*x,t[10]=(1-(f+p))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function nt(t,e,n,r,i){var a=e[0],o=e[1],s=e[2],u=e[3],c=a+a,h=o+o,f=s+s,l=a*c,d=a*h,p=a*f,m=o*h,_=o*f,v=s*f,g=u*c,y=u*h,b=u*f,M=r[0],x=r[1],w=r[2],I=i[0],T=i[1],A=i[2],S=(1-(m+v))*M,E=(d+b)*M,N=(p-y)*M,k=(d-b)*x,C=(1-(l+v))*x,B=(_+g)*x,F=(p+y)*w,O=(_-g)*w,U=(1-(l+m))*w;return t[0]=S,t[1]=E,t[2]=N,t[3]=0,t[4]=k,t[5]=C,t[6]=B,t[7]=0,t[8]=F,t[9]=O,t[10]=U,t[11]=0,t[12]=n[0]+I-(S*I+k*T+F*A),t[13]=n[1]+T-(E*I+C*T+O*A),t[14]=n[2]+A-(N*I+B*T+U*A),t[15]=1,t}function rt(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,u=i+i,c=n*o,h=r*o,f=r*s,l=i*o,d=i*s,p=i*u,m=a*o,_=a*s,v=a*u;return t[0]=1-f-p,t[1]=h+v,t[2]=l-_,t[3]=0,t[4]=h-v,t[5]=1-c-p,t[6]=d+m,t[7]=0,t[8]=l+_,t[9]=d-m,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function it(t,e,n,r,i,a,o){var s=1/(n-e),u=1/(i-r),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t}function at(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function ot(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function st(t,e,n,r,i,a,o){var s=1/(e-n),u=1/(r-i),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(o+a)*c,t[15]=1,t}function ut(t,e,n,r){var i,a,o,s,u,c,h,f,l,d,p=e[0],m=e[1],_=e[2],v=r[0],g=r[1],y=r[2],b=n[0],M=n[1],x=n[2];return Math.abs(p-b)<I&&Math.abs(m-M)<I&&Math.abs(_-x)<I?B(t):(h=p-b,f=m-M,l=_-x,i=g*(l*=d=1/Math.hypot(h,f,l))-y*(f*=d),a=y*(h*=d)-v*l,o=v*f-g*h,(d=Math.hypot(i,a,o))?(i*=d=1/d,a*=d,o*=d):(i=0,a=0,o=0),s=f*o-l*a,u=l*i-h*o,c=h*a-f*i,(d=Math.hypot(s,u,c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=a,t[5]=u,t[6]=f,t[7]=0,t[8]=o,t[9]=c,t[10]=l,t[11]=0,t[12]=-(i*p+a*m+o*_),t[13]=-(s*p+u*m+c*_),t[14]=-(h*p+f*m+l*_),t[15]=1,t)}function ct(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=r[0],u=r[1],c=r[2],h=i-n[0],f=a-n[1],l=o-n[2],d=h*h+f*f+l*l;d>0&&(h*=d=1/Math.sqrt(d),f*=d,l*=d);var p=u*l-c*f,m=c*h-s*l,_=s*f-u*h;return(d=p*p+m*m+_*_)>0&&(p*=d=1/Math.sqrt(d),m*=d,_*=d),t[0]=p,t[1]=m,t[2]=_,t[3]=0,t[4]=f*_-l*m,t[5]=l*p-h*_,t[6]=h*m-f*p,t[7]=0,t[8]=h,t[9]=f,t[10]=l,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function ht(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ft(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function lt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function dt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function pt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function mt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function _t(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function vt(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=t[9],l=t[10],d=t[11],p=t[12],m=t[13],_=t[14],v=t[15],g=e[0],y=e[1],b=e[2],M=e[3],x=e[4],w=e[5],T=e[6],A=e[7],S=e[8],E=e[9],N=e[10],k=e[11],C=e[12],B=e[13],F=e[14],O=e[15];return Math.abs(n-g)<=I*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-y)<=I*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-b)<=I*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-M)<=I*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(o-x)<=I*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-w)<=I*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(u-T)<=I*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-A)<=I*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(h-S)<=I*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(f-E)<=I*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(l-N)<=I*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(d-k)<=I*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-C)<=I*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-B)<=I*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(_-F)<=I*Math.max(1,Math.abs(_),Math.abs(F))&&Math.abs(v-O)<=I*Math.max(1,Math.abs(v),Math.abs(O))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var gt=R,yt=dt;function bt(){var t=new T(3);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Mt(t){var e=new T(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function xt(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function wt(t,e,n){var r=new T(3);return r[0]=t,r[1]=e,r[2]=n,r}function It(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Tt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function At(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function St(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Et(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Nt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function kt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Ct(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Bt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Ft(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Ot(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Ut(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Vt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Rt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Lt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Dt(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function zt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function jt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Pt(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function qt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ht(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],u=n[2];return t[0]=i*u-a*s,t[1]=a*o-r*u,t[2]=r*s-i*o,t}function Wt(t,e,n,r){var i=e[0],a=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t}function Gt(t,e,n,r,i,a){var o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,c=o*(a-1),h=o*(3-2*a);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*h,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*h,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*h,t}function Xt(t,e,n,r,i,a){var o=1-a,s=o*o,u=a*a,c=s*o,h=3*a*s,f=3*u*o,l=u*a;return t[0]=e[0]*c+n[0]*h+r[0]*f+i[0]*l,t[1]=e[1]*c+n[1]*h+r[1]*f+i[1]*l,t[2]=e[2]*c+n[2]*h+r[2]*f+i[2]*l,t}function Yt(t,e){e=e||1;var n=2*A()*Math.PI,r=2*A()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Zt(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function Kt(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function Jt(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=e[0],u=e[1],c=e[2],h=i*c-a*u,f=a*s-r*c,l=r*u-i*s,d=i*l-a*f,p=a*h-r*l,m=r*f-i*h,_=2*o;return h*=_,f*=_,l*=_,d*=2,p*=2,m*=2,t[0]=s+h+d,t[1]=u+f+p,t[2]=c+l+m,t}function Qt(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function $t(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function te(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function ee(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(a*a+o*o+s*s),c=u&&qt(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function ne(t){return t[0]=0,t[1]=0,t[2]=0,t}function re(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function ie(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function ae(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2];return Math.abs(n-a)<=I*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=I*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=I*Math.max(1,Math.abs(i),Math.abs(s))}var oe,se=St,ue=Et,ce=Nt,he=Rt,fe=Lt,le=xt,de=Dt,pe=(oe=bt(),function(t,e,n,r,i,a){var o,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,o=n;o<s;o+=e)oe[0]=t[o],oe[1]=t[o+1],oe[2]=t[o+2],i(oe,oe,a),t[o]=oe[0],t[o+1]=oe[1],t[o+2]=oe[2];return t});function me(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function _e(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}!function(){var t,e=(t=new T(4),T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function ve(){var t=new T(4);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ge(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ye(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function be(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>I?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Me(t,e){var n=Je(t,e);return Math.acos(2*n*n-1)}function xe(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+o*s+i*c-a*u,t[1]=i*h+o*u+a*s-r*c,t[2]=a*h+o*c+r*u-i*s,t[3]=o*h-r*s-i*u-a*c,t}function we(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=a*u-i*s,t[3]=o*u-r*s,t}function Ie(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-a*s,t[1]=i*u+o*s,t[2]=a*u+r*s,t[3]=o*u-i*s,t}function Te(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=a*u+o*s,t[3]=o*u-a*s,t}function Ae(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Se(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),u=o>0?s*Math.sin(o)/o:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(o),t}function Ee(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(n*n+r*r+i*i+a*a),t}function Ne(t,e,n){return Ee(t,e),Ke(t,t,n),Se(t,t),t}function ke(t,e,n,r){var i,a,o,s,u,c=e[0],h=e[1],f=e[2],l=e[3],d=n[0],p=n[1],m=n[2],_=n[3];return(a=c*d+h*p+f*m+l*_)<0&&(a=-a,d=-d,p=-p,m=-m,_=-_),1-a>I?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(s=1-r,u=r),t[0]=s*c+u*d,t[1]=s*h+u*p,t[2]=s*f+u*m,t[3]=s*l+u*_,t}function Ce(t){var e=A(),n=A(),r=A(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function Be(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,t}function Fe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Oe(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}function Ue(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return t[0]=a*u*h-o*s*c,t[1]=o*s*h+a*u*c,t[2]=o*u*c-a*s*h,t[3]=o*u*h+a*s*c,t}function Ve(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Re,Le,De,ze,je,Pe,qe,He=function(t){var e=new T(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},We=function(t,e,n,r){var i=new T(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},Ge=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Xe=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},Ye=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Ze=xe,Ke=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},Je=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Qe=function(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=s+r*(n[3]-s),t},$e=me,tn=$e,en=_e,nn=en,rn=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t},an=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},on=function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],o=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-o)<=I*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=I*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=I*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=I*Math.max(1,Math.abs(a),Math.abs(c))},sn=(Re=bt(),Le=wt(1,0,0),De=wt(0,1,0),function(t,e,n){var r=qt(e,n);return r<-.999999?(Ht(Re,Le,e),le(Re)<1e-6&&Ht(Re,De,e),Pt(Re,Re),ye(t,Re,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ht(Re,e,n),t[0]=Re[0],t[1]=Re[1],t[2]=Re[2],t[3]=1+r,rn(t,t))}),un=(ze=ve(),je=ve(),function(t,e,n,r,i,a){return ke(ze,e,i,a),ke(je,n,r,a),ke(t,ze,je,2*a*(1-a)),t}),cn=(Pe=new T(9),T!=Float32Array&&(Pe[1]=0,Pe[2]=0,Pe[3]=0,Pe[5]=0,Pe[6]=0,Pe[7]=0),Pe[0]=1,Pe[4]=1,Pe[8]=1,qe=Pe,function(t,e,n,r){return qe[0]=n[0],qe[3]=n[1],qe[6]=n[2],qe[1]=r[0],qe[4]=r[1],qe[7]=r[2],qe[2]=-e[0],qe[5]=-e[1],qe[8]=-e[2],rn(t,Oe(t,qe))});function hn(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function fn(t,e,n,r){hn.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ln(t,e,n,r){hn.call(this,t,e,n,r)}function dn(t,e,n,r){hn.call(this,t,e,n,r)}Object.assign(hn.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var a;n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}a=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}a=n,n=0}for(;n<a;){var u=n+a>>>1;t<e[u]?a=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,a=0;a!==r;++a)e[a]=n[i+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(hn.prototype,{beforeStart_:hn.prototype.copySampleValue_,afterEnd_:hn.prototype.copySampleValue_}),fn.prototype=Object.assign(Object.create(hn.prototype),{constructor:fn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,a=t+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=t,o=2*e-n;break;case 2402:o=e+r[i=r.length-2]-r[i+1];break;default:i=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=t,s=2*n-e;break;case 2402:a=1,s=n+r[1]-r[0];break;default:a=t-1,s=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-o),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=a*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=s-o,c=this._offsetPrev,h=this._offsetNext,f=this._weightPrev,l=this._weightNext,d=(n-e)/(r-e),p=d*d,m=p*d,_=-f*m+2*f*p-f*d,v=(1+f)*m+(-1.5-2*f)*p+(-.5+f)*d+1,g=(-1-l)*m+(1.5+l)*p+.5*d,y=l*m-l*p,b=0;b!==o;++b)i[b]=_*a[c+b]+v*a[u+b]+g*a[s+b]+y*a[h+b];return i}}),ln.prototype=Object.assign(Object.create(hn.prototype),{constructor:ln,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=s-o,c=(n-e)/(r-e),h=1-c,f=0;f!==o;++f)i[f]=a[u+f]*h+a[s+f]*c;return i}}),dn.prototype=Object.assign(Object.create(hn.prototype),{constructor:dn,interpolate_:function(t){return this.copySampleValue_(t-1)}});var pn={arraySlice:function(t,e,n){return pn.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*e,u=0;u!==e;++u)i[o++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,a=t[0];void 0!==a&&void 0===a[r];)a=t[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(e.push(a.time),n.push.apply(n,o)),a=t[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(e.push(a.time),o.toArray(n,n.length)),a=t[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(e.push(a.time),n.push(o)),a=t[i++]}while(void 0!==a)}},subclip:function(t,e,n,r,i){i=i||30;var a=t.clone();a.name=e;for(var o=[],s=0;s<a.tracks.length;++s){for(var u=a.tracks[s],c=u.getValueSize(),h=[],f=[],l=0;l<u.times.length;++l){var d=u.times[l]*i;if(!(d<n||d>=r)){h.push(u.times[l]);for(var p=0;p<c;++p)f.push(u.values[l*c+p])}}0!==h.length&&(u.times=pn.convertArray(h,u.times.constructor),u.values=pn.convertArray(f,u.values.constructor),o.push(u))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a}};function mn(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=pn.convertArray(e,this.TimeBufferType),this.values=pn.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}Object.assign(mn,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:pn.convertArray(t.times,Array),values:pn.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(mn.prototype,{constructor:mn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new dn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new ln(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new fn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<t;)++i;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=pn.arraySlice(n,i,a),this.values=pn.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==r&&pn.isTypedArray(r)){o=0;for(var u=r.length;o!==u;++o){var c=r[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),t=!1;break}}}return t},optimize:function(){for(var t=pn.arraySlice(this.times),e=pn.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,a=t.length-1,o=1;o<a;++o){var s=!1,u=t[o];if(u!==t[o+1]&&(1!==o||u!==u[0]))if(r)s=!0;else for(var c=o*n,h=c-n,f=c+n,l=0;l!==n;++l){var d=e[c+l];if(d!==e[h+l]||d!==e[f+l]){s=!0;break}}if(s){if(o!==i){t[i]=t[o];var p=o*n,m=i*n;for(l=0;l!==n;++l)e[m+l]=e[p+l]}++i}}if(a>0){t[i]=t[a];for(p=a*n,m=i*n,l=0;l!==n;++l)e[m+l]=e[p+l];++i}return i!==t.length?(this.times=pn.arraySlice(t,0,i),this.values=pn.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=pn.arraySlice(this.times,0),e=pn.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}});for(var _n=[],vn=0;vn<256;vn++)_n[vn]=(vn<16?"0":"")+vn.toString(16);var gn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(_n[255&t]+_n[t>>8&255]+_n[t>>16&255]+_n[t>>24&255]+"-"+_n[255&e]+_n[e>>8&255]+"-"+_n[e>>16&15|64]+_n[e>>24&255]+"-"+_n[63&n|128]+_n[n>>8&255]+"-"+_n[n>>16&255]+_n[n>>24&255]+_n[255&r]+_n[r>>8&255]+_n[r>>16&255]+_n[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*gn.DEG2RAD},radToDeg:function(t){return t*gn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),c=a((e+r)/2),h=o((e+r)/2),f=a((e-r)/2),l=o((e-r)/2),d=a((r-e)/2),p=o((r-e)/2);"XYX"===i?t.set(s*h,u*f,u*l,s*c):"YZY"===i?t.set(u*l,s*h,u*f,s*c):"ZXZ"===i?t.set(u*f,u*l,s*h,s*c):"XZX"===i?t.set(s*h,u*p,u*d,s*c):"YXY"===i?t.set(u*d,s*h,u*p,s*c):"ZYZ"===i?t.set(u*p,u*d,s*h,s*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function yn(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function bn(t,e,n,r){hn.call(this,t,e,n,r)}function Mn(t,e,n,r){mn.call(this,t,e,n,r)}function xn(t,e,n,r){mn.call(this,t,e,n,r)}function wn(t,e,n){mn.call(this,t,e,n)}function In(t,e,n,r){mn.call(this,t,e,n,r)}function Tn(t,e,n,r){mn.call(this,t,e,n,r)}function An(t,e,n,r){mn.call(this,t,e,n,r)}function Sn(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=gn.generateUUID(),this.duration<0&&this.resetDuration()}function En(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tn;case"vector":case"vector2":case"vector3":case"vector4":return xn;case"color":return In;case"quaternion":return Mn;case"bool":case"boolean":return wn;case"string":return An}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];pn.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function Nn(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,a=new Array(i),o={endingStart:2400,endingEnd:2400},s=0;s!==i;++s){var u=r[s].createInterpolant(null);a[s]=u,u.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function kn(){}Object.assign(yn,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,a,o){var s=n[r+0],u=n[r+1],c=n[r+2],h=n[r+3],f=i[a+0],l=i[a+1],d=i[a+2],p=i[a+3];if(h!==p||s!==f||u!==l||c!==d){var m=1-o,_=s*f+u*l+c*d+h*p,v=_>=0?1:-1,g=1-_*_;if(g>Number.EPSILON){var y=Math.sqrt(g),b=Math.atan2(y,_*v);m=Math.sin(m*b)/y,o=Math.sin(o*b)/y}var M=o*v;if(s=s*m+f*M,u=u*m+l*M,c=c*m+d*M,h=h*m+p*M,m===1-o){var x=1/Math.sqrt(s*s+u*u+c*c+h*h);s*=x,u*=x,c*=x,h*=x}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=h}}),Object.defineProperties(yn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(yn.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,a=t.order,o=Math.cos,s=Math.sin,u=o(n/2),c=o(r/2),h=o(i/2),f=s(n/2),l=s(r/2),d=s(i/2);return"XYZ"===a?(this._x=f*c*h+u*l*d,this._y=u*l*h-f*c*d,this._z=u*c*d+f*l*h,this._w=u*c*h-f*l*d):"YXZ"===a?(this._x=f*c*h+u*l*d,this._y=u*l*h-f*c*d,this._z=u*c*d-f*l*h,this._w=u*c*h+f*l*d):"ZXY"===a?(this._x=f*c*h-u*l*d,this._y=u*l*h+f*c*d,this._z=u*c*d+f*l*h,this._w=u*c*h-f*l*d):"ZYX"===a?(this._x=f*c*h-u*l*d,this._y=u*l*h+f*c*d,this._z=u*c*d-f*l*h,this._w=u*c*h+f*l*d):"YZX"===a?(this._x=f*c*h+u*l*d,this._y=u*l*h+f*c*d,this._z=u*c*d-f*l*h,this._w=u*c*h-f*l*d):"XZY"===a&&(this._x=f*c*h-u*l*d,this._y=u*l*h-f*c*d,this._z=u*c*d+f*l*h,this._w=u*c*h+f*l*d),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],u=n[9],c=n[2],h=n[6],f=n[10],l=r+s+f;return l>0?(e=.5/Math.sqrt(l+1),this._w=.25/e,this._x=(h-u)*e,this._y=(a-c)*e,this._z=(o-i)*e):r>s&&r>f?(e=2*Math.sqrt(1+r-s-f),this._w=(h-u)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(a+c)/e):s>f?(e=2*Math.sqrt(1+s-r-f),this._w=(a-c)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(u+h)/e):(e=2*Math.sqrt(1+f-r-s),this._w=(o-i)/e,this._x=(a+c)/e,this._y=(u+h)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(gn.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,a=t._w,o=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+a*o+r*u-i*s,this._y=r*c+a*s+i*o-n*u,this._z=i*c+a*u+n*s-r*o,this._w=a*c-n*o-r*s-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-e;return this._w=u*a+e*this._w,this._x=u*n+e*this._x,this._y=u*r+e*this._y,this._z=u*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),h=Math.atan2(c,o),f=Math.sin((1-e)*h)/c,l=Math.sin(e*h)/c;return this._w=a*f+this._w*l,this._x=n*f+this._x*l,this._y=r*f+this._y*l,this._z=i*f+this._z*l,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),bn.prototype=Object.assign(Object.create(hn.prototype),{constructor:bn,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,u=(n-e)/(r-e),c=s+o;s!==c;s+=4)yn.slerpFlat(i,0,a,s-o,a,s,u);return i}}),Mn.prototype=Object.assign(Object.create(mn.prototype),{constructor:Mn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new bn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),xn.prototype=Object.assign(Object.create(mn.prototype),{constructor:xn,ValueTypeName:"vector"}),wn.prototype=Object.assign(Object.create(mn.prototype),{constructor:wn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),In.prototype=Object.assign(Object.create(mn.prototype),{constructor:In,ValueTypeName:"color"}),Tn.prototype=Object.assign(Object.create(mn.prototype),{constructor:Tn,ValueTypeName:"number"}),An.prototype=Object.assign(Object.create(mn.prototype),{constructor:An,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Sn,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,a=n.length;i!==a;++i)e.push(En(n[i]).scale(r));return new Sn(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,a=n.length;i!==a;++i)e.push(mn.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var c=pn.getKeyframeOrder(s);s=pn.sortedArray(s,1,c),u=pn.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new Tn(".morphTargetInfluences["+e[o].name+"]",s,u).scale(1/n))}return new Sn(t,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],u=s.name.match(i);if(u&&u.length>1){var c=r[f=u[1]];c||(r[f]=c=[]),c.push(s)}}var h=[];for(var f in r)h.push(Sn.CreateFromMorphTargetSequence(f,r[f],e,n));return h},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var a=[],o=[];pn.flattenJSON(n,a,o,r),0!==a.length&&i.push(new t(e,a,o))}},r=[],i=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var h={},f=0;f<c.length;f++)if(c[f].morphTargets)for(var l=0;l<c[f].morphTargets.length;l++)h[c[f].morphTargets[l]]=-1;for(var d in h){var p=[],m=[];for(l=0;l!==c[f].morphTargets.length;++l){var _=c[f];p.push(_.time),m.push(_.morphTarget===d?1:0)}r.push(new Tn(".morphTargetInfluence["+d+"]",p,m))}a=h.length*(o||1)}else{var v=".bones["+e[u].name+"]";n(xn,v+".position",c,"pos",r),n(Mn,v+".quaternion",c,"rot",r),n(xn,v+".scale",c,"scl",r)}}return 0===r.length?null:new Sn(i,a,r)}}),Object.assign(Sn.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Sn(this.name,this.duration,t)}}),Object.assign(Nn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,a=i/r,o=r/i;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/o,u[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(t-i)*n;if(a<0||0===n)return;this._startTime=null,e=n*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,h=0,f=u.length;h!==f;++h)u[h].evaluate(o),c[h].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,a=2202===r;if(0===t)return-1===i?e:a&&1==(1&i)?n-e:e;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=n||e<0){var o=Math.floor(e/n);e-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var u=t<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=e;if(a&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=e,o[1]=i+t,s[1]=n,this}}),Object.assign(kn.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});var Cn=new RegExp("[\\[\\]\\.:\\/]","g"),Bn="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Fn=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),On=/(WCOD+)?/.source.replace("WCOD",Bn),Un=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Vn=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Rn=new RegExp("^"+Fn+On+Un+Vn+"$"),Ln=["material","materials","bones"];function Dn(t,e,n){var r=n||zn.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function zn(t,e,n){this.path=e,this.parsedPath=n||zn.parseTrackName(e),this.node=zn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function jn(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Pn(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Object.assign(Dn.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(zn,{Composite:Dn,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new zn.Composite(t,e,n):new zn(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Cn,"")},parseTrackName:function(t){var e=Rn.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Ln.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var a=r(i.children);if(a)return a}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(zn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=zn.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var h=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(zn.prototype,{_getValue_unbound:zn.prototype.getValue,_setValue_unbound:zn.prototype.setValue}),Object.assign(jn.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*e;this._mixBufferRegion(n,r,o,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){a.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,a=r;i!==a;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)t[e+a]=t[n+a]},_slerp:function(t,e,n,r){yn.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=e+o;t[s]=t[s]*a+t[n+o]*r}}}),Pn.prototype=Object.assign(Object.create(kn.prototype),{constructor:Pn,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var h=0;h!==i;++h){var f=r[h],l=f.name,d=c[l];if(void 0!==d)a[h]=d;else{if(void 0!==(d=a[h])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,l));continue}var p=e&&e._propertyBindings[h].binding.parsedPath;++(d=new jn(zn.create(n,l,p),f.ValueTypeName,f.getValueSize())).referenceCount,this._addInactiveBinding(d,s,l),a[h]=d}o[h].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,a=i[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=r.length,r.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],a=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new ln(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Sn.findByName(n,t):t,a=null!==i?i.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var u=o.actionByRoot[r];if(void 0!==u)return u;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var c=new Nn(this,i,e);return this._bindAction(c,s),this._addInactiveAction(c,a,r),c},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Sn.findByName(n,t):t,a=i?i.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),a=this._accuIndex^=1,o=0;o!==n;++o){e[o]._update(r,t,i,a)}var s=this._bindings,u=this._nActiveBindings;for(o=0;o!==u;++o)s[o].apply(a);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var c=u._cacheIndex,h=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=c,e[c]=h,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});const qn=1313821514,Hn=5130562;let Wn=new TextDecoder;function Gn(t){return Wn.decode(t)}class Xn{constructor(t){const e=new DataView(t,0,12),n=new DataView(t,12),r=Gn(new Uint8Array(t,0,4)),i=e.getUint32(4,!0);e.getUint32(8,!0);if("glTF"!==r)throw new Error("Unsupported glTF-Binary header.");if(i<2)throw new Error("Unsupported legacy binary file detected.");let a=0;for(;a<n.byteLength;){const e=n.getUint32(a,!0);a+=4;const r=n.getUint32(a,!0);switch(a+=4,r){case qn:{const n=new Uint8Array(t,12+a,e);this.json=Gn(n)}break;case Hn:{const n=12+a;this.binaryChunk=new Uint8Array(t,n,e)}break;default:console.warn("Skipping unexpected glTF-Binary chunk type:",r)}a+=e}b(!!this.json,"glTF-Binary: JSON content not found.")}}class Yn{constructor(t,e){this.gltf=t,this.bufferData=e}bufferViewData(t){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const e=this.gltf.bufferViews[t],n=M(this.bufferData[e.buffer],`No data for buffer ${e.buffer}`),r=e.byteLength||0,i=e.byteOffset||0,a=n.buffer,o=n.byteOffset;return new Uint8Array(a,o+i,r)}accessorData(t){if(!this.gltf.accessors)throw new Error("No accessors views found.");const e=this.gltf.accessors[t],n=er[e.type];let r;const i=tr[e.componentType],a=i.BYTES_PER_ELEMENT*n*e.count;if(void 0!==e.bufferView){const t=this.bufferViewData(e.bufferView);r=new i(t.buffer,t.byteOffset+w(e.byteOffset,0),e.count*n)}else r=new i(a);if(e.sparse){const{count:t,indices:i,values:a}=e.sparse;let o=tr[i.componentType],s=this.bufferViewData(i.bufferView);const u=new o(s.buffer,s.byteOffset+(i.byteOffset||0),t);o=tr[e.componentType],s=this.bufferViewData(a.bufferView);const c=new o(this.bufferViewData(a.bufferView).buffer,s.byteOffset+(a.byteOffset||0),t*n);e.bufferView&&(r=new Uint8Array(r));const h=new tr[e.componentType](r.buffer);for(let e=0;e<t;e++)for(let t=0;t<n;t++)h[n*u[e]+t]=c[n*e+t]}return r}}function Zn(t,e){let n;switch(e){case 5120:n=u.Char;break;case 5121:n=u.Uchar;break;case 5122:n=u.Short;break;case 5123:n=u.Ushort;break;case 5125:n=u.Uint;break;case 5126:n=u.Float;break;default:throw new Error("Invalid GLTF component type")}switch(t){case"SCALAR":n+=0;break;case"VEC2":n+=1;break;case"VEC3":n+=2;break;case"VEC4":n+=3;break;case"MAT2":throw new Error("2x2 Matrice not yet supported");case"MAT3":n=u.Float3x3;break;case"MAT4":n=u.Float4x4}return n}function Kn(t){switch(t){case 5124:return u.Int;case 5126:return u.Float;case 35664:return u.Float2;case 35665:return u.Float3;case 35666:return u.Float4;case 35667:return u.Int2;case 35668:return u.Int3;case 35669:return u.Int4;case 35675:return u.Float3x3;case 35676:return u.Float4x4;case 35678:return u.Texture2D;default:throw new Error("Invalid GLTF component type")}}function Jn(t){switch(t){case 0:return d.Points;case 1:return d.Lines;case 2:return d.LineLoop;case 3:return d.LineStrip;case 4:return d.Triangles;case 5:return d.TriangleStrip;case 6:return d.TriangleFan;default:throw new Error("Invalid GLTF primitive mode")}}const Qn={9728:f.Nearest,9729:f.Linear},$n={9728:f.Nearest,9729:f.Linear},tr={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},er={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nr={POSITION:"a_pos",NORMAL:"a_normal",TANGENT:"a_tangent",JOINTS_0:"a_joints",WEIGHTS_0:"a_weights",COLOR_0:"a_color",TEXCOORD_0:"a_uv0",TEXCOORD_1:"a_uv1",MORPH0_POSITION:"a_posMorph0"},rr={NORMAL:"HAS_NORMALS 1",TANGENT:"HAS_TANGENT 1",JOINTS_0:"HAS_JOINT_SET0 1",WEIGHTS_0:"HAS_WEIGHT_SET0 1",COLOR_0:"HAS_COLOR0 1",TEXCOORD_0:"HAS_UV_SET0 1",TEXCOORD_1:"HAS_UV_SET1 1"},ir={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},ar={translation:"position",rotation:"quaternion",scale:"scale",weights:"_UNSUPPORTED"};function or(t,e,n){const r=n,i=e.gltf;let a;if(!x(n.material))throw new Error("Default material not yet supported");a=M(t.transient.materials[n.material]);const o=[];let s=void 0;const u=[];if(x(r.indices)){const n=M(i.accessors)[r.indices];s=sr(t,e,M(n.bufferView),p.Index)}let c;if(x(a.techniqueIndex)){c={};const e=M(t.transient.techniques).techniques[a.techniqueIndex],n=Object.keys(e.attributes);for(const t of n){c[e.attributes[t].semantic]=t}}else c=nr;const h={buffers:[]},f={};for(let n in r.attributes){const a=M(i.accessors)[r.attributes[n]],s=M(a.bufferView,"Undefined accessor buffers are not yet implemented"),l=f[s];let d;if(x(l))d=h.buffers[l];else{f[s]=u.length;const n=sr(t,e,s,p.Vertex);d={stride:w(M(i.bufferViews)[s].byteStride,0),layout:{}},u.push(n),h.buffers.push(d)}const m=rr[n];x(m)&&o.push(m);const _=M(c[n],`Unknown vertex attribute semantic: ${n}`);d.layout[_]={type:Zn(a.type,a.componentType),offset:a.byteOffset||0}}if(r.targets){o.push("HAS_MORPH0 1"),b(1===r.targets.length,"Only 1 morph target is currently supported");const n=r.targets[0];for(let r in n)if("POSITION"===r){const a=M(i.accessors)[n[r]],o=M(a.bufferView,"Undefined accessor buffers are not yet implemented"),s=M(i.bufferViews)[o];let f=h.buffers[o];const l=sr(t,e,o,p.Vertex);x(f)||(u[o]=l,f=h.buffers[o]={stride:w(s.byteStride,0),layout:{}});const d=c[`MORPH0_${r}`];f.layout[d]={type:Zn(a.type,a.componentType),offset:a.byteOffset||0}}}const l=i.accessors[M(r.indices,"Only indexed primitives are currently supported")],d=M(s,"Only indexed primitives are currently supported");return{mesh:{elementCount:l.count,vertexBuffers:u,primitiveType:Jn(w(r.mode,4)),indexType:Zn(l.type,l.componentType),indexBuffer:d,vertexLayout:h},materialIndex:n.material}}function sr(t,e,n,r){if(x(t.bufferViews[n]))return t.bufferViews[n];const i=M(e.gltf.bufferViews)[n].name||`buffer${n}`;t.bufferData[n]=new Uint8Array(e.bufferViewData(n)).buffer,b(!t.transferList.includes(t.bufferData[n])),t.transferList.push(t.bufferData[n]);const a={name:i,type:r,buffer:-1};return t.bufferViews[n]=a,a}function ur(t,e){return w(e.gltf.materials,[]).map((t,e)=>{var n;const r=null===(n=t.extensions)||void 0===n?void 0:n.KHR_techniques_webgl,i=r?r.technique:void 0,a=r?r.values:void 0;return{name:w(t.name,`Material${e}`),renderFormat:{blendingEnabled:!1},cullMode:t.doubleSided?v.None:v.Back,techniqueIndex:i,values:a}})}function cr(t,e){var n;if(!(null===(n=e.gltf.extensionsUsed)||void 0===n?void 0:n.includes("KHR_techniques_webgl")))return;const r=M(e.gltf.extensions.KHR_techniques_webgl);return{shaderData:r.shaders.map((n,r)=>{const i=M(n.bufferView,"Shader loading from URI not yet supported"),a=new Uint8Array(e.bufferViewData(i)).buffer;return b(!t.transferList.includes(a)),t.transferList.push(a),a}),shaders:r.programs.map(t=>({name:t.name,fsIndex:t.fragmentShader,vsIndex:t.vertexShader})),techniques:r.techniques.map((t,e)=>{const n={};for(const e in w(t.uniforms,{})){const r=t.uniforms[e];n[e]=Object.assign(Object.assign({},r),{type:Kn(r.type)})}return{shaderIndex:t.program,attributes:w(t.attributes,{}),uniforms:n}})}}function hr(t,e){return w(e.gltf.nodes,[]).map(t=>{const n=w(t.scale,[1,1,1]),a=w(t.rotation,[0,0,0,1]),s=w(t.translation,[0,0,0]),u={name:t.name,scale:i.fromValues(n[0],n[1],n[2]),rotation:o.fromValues(a[0],a[1],a[2],a[3]),translation:i.fromValues(s[0],s[1],s[2]),morphWeight:w(t.weights,[0])[0]};if(x(t.matrix)?(u.transform=new Float32Array(t.matrix),r.getRotation(u.rotation,u.transform),r.getTranslation(u.translation,u.transform),r.getScaling(u.scale,u.transform)):u.transform=r.fromRotationTranslationScale(r.create(),u.rotation,u.translation,u.scale),x(t.mesh)&&(u.meshId=t.mesh),x(t.skin)&&(u.skinId=t.skin),x(t.children)){u.children=[];for(let n=0;n<t.children.length;n++){const r=t.children[n];M(e.gltf.nodes)[r];u.children.push(r)}}return u})}async function fr(t,e){const n=w(e.gltf.images,[]),r=w(e.gltf.textures,[]),i=w(e.gltf.samplers,[]),a={type:c.Texture2D,format:h.U8x4,usage:_.Static},o={wrapS:10497,wrapT:10497},s=n.map(n=>{const r=M(n.bufferView,"Image loading from a URI is not yet supported"),i=e.bufferViewData(r);let a;if(x(self.createImageBitmap)){const t=new Blob([i],{type:M(n.mimeType)});a=createImageBitmap(t)}else a=Promise.resolve(new Uint8Array(i).buffer);return a.then(e=>(b(!t.transferList.includes(e)),t.transferList.push(e),e))}),u=r.map(t=>{const e=w(i[t.sampler],o),n=Object.assign({},a);return x(e.magFilter)&&(n.defaultMagFilter=Qn[e.magFilter],x(n.defaultMagFilter)||console.warn(`Unsupported texture mag filter: ${e.magFilter}`)),x(e.minFilter)&&(n.defaultMagFilter=$n[e.minFilter],x(n.defaultMagFilter)||console.warn(`Unsupported texture min filter: ${e.magFilter}`)),(x(e.wrapS)||x(e.wrapT))&&(x(n.defaultMagFilter)||console.warn(`Texture wrapping not yet supported: ${e.magFilter}`)),{name:t.name,desc:n,imageIndex:M(t.source)}});return{imageData:await Promise.all(s),textures:u}}function lr(t,e){let n=[];for(const r of w(e.gltf.animations,[])){const i=r.samplers.map(n=>{b(5126===e.gltf.accessors[n.input].componentType,"Non-float animation time type unsupported"),b(5126===e.gltf.accessors[n.output].componentType,"Non-float animation values type unsupported");const r=new Float32Array(e.accessorData(n.input)),i=new Float32Array(e.accessorData(n.output));return t.transferList.push(r.buffer,i.buffer),{times:r,values:i}}),a=[];for(const t of r.channels){const e=t.target.node;if(!x(e))continue;const n=ar[t.target.path],o=i[t.sampler],s=w(r.samplers[t.sampler].interpolation,"LINEAR");a.push({targetNodeId:e,targetProperty:n,times:o.times,values:o.values,interpolation:s})}n.push({name:r.name,maxTime:r.maxTime,tracks:a})}return n}class dr extends hn{copySampleValue_(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r,a=0;a!==r;a++)e[a]=n[i+a];return e}beforeStart_(t){this.copySampleValue_(t)}afterEnd_(t){this.copySampleValue_(t)}interpolate_(t,e,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,c=r-e,h=(n-e)/c,f=h*h,l=f*h,d=t*u,p=d-u,m=-2*l+3*f,_=l-f,v=1-m,g=_-f+h;for(let t=0;t!==o;t++){const e=a[p+t+o],n=a[p+t+s]*c,r=a[d+t+o],u=a[d+t]*c;i[t]=v*e+g*n+m*r+_*u}return i}}const pr=self,mr={texture:new class{async loadAsync(t){const e=await fetch(t.source.uri);if(200!=e.status)throw new Error("Failed to download image");const n=t.source.uri.match(/.*\/(.+?)\./);t.name=n&&n.length>1?n[1]:"Unknown",self.createImageBitmap?(t.imageBitmap=await createImageBitmap(await e.blob()),t.transferList.push(t.imageBitmap),t.status=a.LoadingSync):(t.imageBuffer=await e.arrayBuffer(),t.transferList.push(t.imageBuffer),t.status=a.LoadingSync)}loadSync(t,e){if(e.imageBitmap)e.texture=t.renderer.createTexture(e.name,{usage:_.Static,type:c.Texture2D,format:h.U8x3,maxAnistropy:16},e.imageBitmap),e.imageBitmap.close(),delete e.imageBitmap,e.status=a.Loaded;else{if(e.imageBuffer){var n=new Blob([e.imageBuffer],{type:"image/jpeg"});let t=window.URL.createObjectURL(n);delete e.imageBuffer,e.imageElement=new Image,e.imageElement.src=t,e.status=a.LoadingSync}x(e.imageElement)&&e.imageElement.complete&&(e.texture=t.renderer.createTexture(e.name,{usage:_.Static,type:c.Texture2D,format:h.U8x3,maxAnistropy:16},e.imageElement),delete e.imageElement,e.status=a.Loaded)}}unloadSync(t,e){x(e.texture)&&t.renderer.removeTexture(e.texture),x(e.imageBitmap)&&e.imageBitmap.close()}},gltf:new class{async loadAsync(t){const e=await fetch(t.source.uri);if(200!=e.status)throw new Error("Failed to download GLTF");const n=await e.arrayBuffer(),r=new Xn(n),i=JSON.parse(r.json),o=new Yn(i,[r.binaryChunk]);t.nodes=[],t.meshes=[],t.materials=[],t.textures=[],t.bufferViews=[],t.animations=[],t.rootNodeIds=[],t.bufferData=[],t.transient={techniques:cr(t,o),materials:ur(0,o),nodes:hr(0,o),animation:lr(t,o),textures:await fr(t,o)},function(t,e){const n=w(e.gltf.meshes,[]);t.meshes=[];for(let r=0;r<n.length;r++){const i=M(n[r]),a=[];for(let n of i.primitives)a.push(or(t,e,n));const o={name:i.name,id:r,primitives:a};t.meshes[r]=o}}(t,o),function(t,e){const n=w(e.gltf.skins,[]);t.skins=[];for(let r=0;r<n.length;r++){const i=n[r];let a=void 0;if(x(i.inverseBindMatrices)){const n=new Float32Array(e.accessorData(i.inverseBindMatrices));b(!t.transferList.includes(n.buffer)),t.transferList.push(n.buffer),a=[];for(let t=0;t<i.joints.length;t++)a[t]=n.subarray(16*t,16*t+16)}t.skins[r]={name:i.name,skeleton:i.skeleton,joints:i.joints,inverseBindMatrices:a}}}(t,o),function(t,e){const n=w(e.gltf.scene,0);if(x(n)){const r=M(e.gltf.scenes),i=M(r[n]);t.rootNodeIds=w(i.nodes,[])}}(t,o),b(!t.transferList.includes(n)),t.status=a.LoadingSync}loadSync(t,e){if(x(self.createImageBitmap))e.status=a.Loaded;else if(function(t,e){let n=!1;const r=t.transient.textures;let i=0;for(let s=0;s<r.textures.length;s++){const u=r.textures[s],c=r.imageData[u.imageIndex];if(x(t.textures[s]))i+=1;else{if(c instanceof ArrayBuffer){n=!0;var o=new Blob([c],{type:"image/jpeg"});let e=window.URL.createObjectURL(o);r.imageData[u.imageIndex]=new Image,r.imageData[u.imageIndex].src=e,t.status=a.LoadingSync}c.complete&&(b(x(t.textures),"This should have been defined as an empty array by loadTexturesSync()"),t.textures[s]={desc:u.desc,name:u.name,id:e.renderer.createTexture(u.name,u.desc,c)})}}return i===r.textures.length?t.status=a.Loaded:t.status=a.LoadingSync,!n}(e,t))return;e.techniques=function(t,e){if(!x(t))return[];const n=t.shaders.map(n=>{const r=t.shaderData[n.vsIndex],i=t.shaderData[n.fsIndex],a={name:n.name,vertSource:Gn(r),fragSource:Gn(i)};return e.renderer.createShader(a)});return t.techniques.map(t=>({shaderId:n[t.shaderIndex],attributes:t.attributes,uniforms:t.uniforms}))}(e.transient.techniques,t),e.materials=function(t,e){return t.map(t=>({name:t.name,renderFormat:t.renderFormat,cullMode:t.cullMode,values:t.values,technique:x(t.techniqueIndex)?e.techniques[t.techniqueIndex]:void 0}))}(e.transient.materials,e),e.nodes=e.transient.nodes,e.animations=function(t,e){const n=[];for(const r of t){const t=r.tracks.map(t=>{let n;switch(t.targetProperty){case"quaternion":n=Mn;break;case"position":case"scale":n=xn;break;default:throw new Error("Unsupported animation target property")}const r=new n(`${e.nodes[t.targetNodeId].name}.${t.targetProperty}`,Array.from(t.times),Array.from(t.values),ir[t.interpolation]);return"CUBICSPLINE"===t.interpolation&&(r.createInterpolant=function(t){return new dr(this.times,this.values,this.getValueSize()/3,t)},r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),r});n.push(new Sn(r.name,r.maxTime,t))}return n}(e.transient.animation,e),e.textures=function(t,e){const n=[];if(x(self.createImageBitmap)){for(const r of t.textures){const i=t.imageData[r.imageIndex];b(i instanceof ImageBitmap),n.push({desc:r.desc,name:r.name,id:e.renderer.createTexture(r.name,r.desc,i)})}for(const e of t.imageData)e.close()}return n}(e.transient.textures,t);for(let n in e.bufferData){const r=e.bufferViews[n],i=e.bufferData[n];r.buffer=t.renderer.createBuffer(r.name,r.type,_.Static,i)}e.status===a.Loaded&&delete e.transient}unloadSync(t,e){}}};onmessage=async t=>{vr.onMessage(t)};class _r{constructor(){this.processed=[],setInterval(()=>this.update(),_r.kTickIntervalMs)}async onMessage(t){const e=t.data;for(let t of e){const e=mr[t.source.type];if(e||(t.status=a.Failed),t.status===a.LoadingAsync)try{await e.loadAsync(t)}catch(e){t.status=a.Failed,t.error=e.stack}this.processed.push(t)}}update(){if(this.processed.length>0){const t=[];for(let e of this.processed)Array.prototype.push.apply(t,e.transferList);pr.postMessage(this.processed,t),this.processed.length=0}}}_r.kTickIntervalMs=33;const vr=new _r;e.default={}}});