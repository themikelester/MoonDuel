!function(t){function e(e){for(var n,i,s=e[0],o=e[1],a=0,u=[];a<s.length;a++)i=s[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);for(c&&c(e);u.length;)u.shift()()}var n={},r={1:0};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(t){var e=[],n=r[t];if(0!==n)if(n)e.push(n[2]);else{var s=new Promise((function(e,i){n=r[t]=[e,i]}));e.push(n[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(t){return i.p+""+({2:"vendors~dat-gui"}[t]||t)+"."+{2:"27ae622125c1762a514b"}[t]+".js"}(t);var c=new Error;o=function(e){a.onerror=a.onload=null,clearTimeout(u);var n=r[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",c.name="ChunkLoadError",c.type=i,c.request=s,n[1](c)}r[t]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(e)},i.m=t,i.c=n,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i.oe=function(t){throw console.error(t),t};var s=window.webpackJsonp=window.webpackJsonp||[],o=s.push.bind(s);s.push=e,s=s.slice();for(var a=0;a<s.length;a++)e(s[a]);var c=o;i(i.s=56)}([function(t,e,n){"use strict";function r(t,e=""){if(!t){const t=new Error(`Assert fail: ${e}`);throw console.error(t.stack),t}}function i(t,e){if(null!=t)return t;throw new Error(o(e,"Missing object"))}function s(t){return null!=t}function o(t,e){return null!=t?t:e}function a(t,e){const n=t.indexOf(e);return r(n>=0),t.splice(n,1),n}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return a}))},function(t,e,n){"use strict";n.d(e,"p",(function(){return r})),n.d(e,"q",(function(){return i})),n.d(e,"r",(function(){return s})),n.d(e,"o",(function(){return o})),n.d(e,"f",(function(){return a})),n.d(e,"m",(function(){return c})),n.d(e,"k",(function(){return u})),n.d(e,"i",(function(){return h})),n.d(e,"j",(function(){return l})),n.d(e,"d",(function(){return f})),n.d(e,"g",(function(){return d})),n.d(e,"c",(function(){return p})),n.d(e,"a",(function(){return m})),n.d(e,"n",(function(){return g})),n.d(e,"e",(function(){return y})),n.d(e,"b",(function(){return v})),n.d(e,"h",(function(){return b})),n.d(e,"l",(function(){return w}));const r=16,i=64,s=16,o=0;var a,c,u,h,l,f,d,p,m,g,y,v,b;function w(t){switch(t){case c.Float:return 4;case c.Float2:return 8;case c.Float3:return 12;case c.Float4:return 16;case c.Int:return 4;case c.Int2:return 8;case c.Int3:return 12;case c.Int4:return 16;case c.Uint:return 4;case c.Uint2:return 8;case c.Uint3:return 12;case c.Uint4:return 16;case c.Short:return 2;case c.Short2:return 4;case c.Short3:return 6;case c.Short4:return 8;case c.Ushort:return 2;case c.Ushort2:return 4;case c.Ushort3:return 6;case c.Ushort4:return 8;case c.Char:return 1;case c.Char2:return 2;case c.Char3:return 3;case c.Char4:return 4;case c.Uchar:return 1;case c.Uchar2:return 2;case c.Uchar3:return 3;case c.Uchar4:return 4;case c.Half:return 2;case c.Half2:return 4;case c.Half3:return 6;case c.Half4:return 8;case c.Float3x3:return 36;case c.Float4x4:return 64;default:throw new Error(`Unsupported type: ${t}`)}}!function(t){t[t.VertexArrayObject=1]="VertexArrayObject",t[t.TextureFloat=2]="TextureFloat",t[t.TextureHalf=4]="TextureHalf",t[t.TextureFloatLinearFiltering=8]="TextureFloatLinearFiltering",t[t.TextureHalfLinearFiltering=16]="TextureHalfLinearFiltering",t[t.TextureWrite=32]="TextureWrite",t[t.ShaderDerivatives=64]="ShaderDerivatives",t[t.Instancing=128]="Instancing",t[t.AnistropicFiltering=256]="AnistropicFiltering",t[t.ShaderGlsl100=512]="ShaderGlsl100",t[t.ShaderGlsl300=1024]="ShaderGlsl300"}(a||(a={})),function(t){t[t.Undefined=0]="Undefined",t[t.Float=1]="Float",t[t.Float2=2]="Float2",t[t.Float3=3]="Float3",t[t.Float4=4]="Float4",t[t.Int=5]="Int",t[t.Int2=6]="Int2",t[t.Int3=7]="Int3",t[t.Int4=8]="Int4",t[t.Uint=9]="Uint",t[t.Uint2=10]="Uint2",t[t.Uint3=11]="Uint3",t[t.Uint4=12]="Uint4",t[t.Short=13]="Short",t[t.Short2=14]="Short2",t[t.Short3=15]="Short3",t[t.Short4=16]="Short4",t[t.Ushort=17]="Ushort",t[t.Ushort2=18]="Ushort2",t[t.Ushort3=19]="Ushort3",t[t.Ushort4=20]="Ushort4",t[t.Char=21]="Char",t[t.Char2=22]="Char2",t[t.Char3=23]="Char3",t[t.Char4=24]="Char4",t[t.Uchar=25]="Uchar",t[t.Uchar2=26]="Uchar2",t[t.Uchar3=27]="Uchar3",t[t.Uchar4=28]="Uchar4",t[t.Half=29]="Half",t[t.Half2=30]="Half2",t[t.Half3=31]="Half3",t[t.Half4=32]="Half4",t[t.Float3x3=33]="Float3x3",t[t.Float3x4=34]="Float3x4",t[t.Float4x4=35]="Float4x4",t[t.Texture2D=240]="Texture2D",t[t.Texture3D=241]="Texture3D",t[t.TextureCube=242]="TextureCube",t[t.Short_Norm=256]="Short_Norm",t[t.Short2_Norm=257]="Short2_Norm",t[t.Short3_Norm=258]="Short3_Norm",t[t.Short4_Norm=259]="Short4_Norm",t[t.Ushort_Norm=260]="Ushort_Norm",t[t.Ushort2_Norm=261]="Ushort2_Norm",t[t.Ushort3_Norm=262]="Ushort3_Norm",t[t.Ushort4_Norm=263]="Ushort4_Norm",t[t.Char_Norm=264]="Char_Norm",t[t.Char2_Norm=265]="Char2_Norm",t[t.Char3_Norm=266]="Char3_Norm",t[t.Char4_Norm=267]="Char4_Norm",t[t.Uchar_Norm=268]="Uchar_Norm",t[t.Uchar2_Norm=269]="Uchar2_Norm",t[t.Uchar3_Norm=270]="Uchar3_Norm",t[t.Uchar4_Norm=271]="Uchar4_Norm"}(c||(c={})),function(t){t[t.Texture2D=240]="Texture2D",t[t.Texture3D=241]="Texture3D",t[t.TextureCube=242]="TextureCube"}(u||(u={})),function(t){t[t.Undefined=0]="Undefined",t[t.U565=1]="U565",t[t.U8=2]="U8",t[t.U8_sRGB=3]="U8_sRGB",t[t.U8x2=4]="U8x2",t[t.U8x2_sRGB=5]="U8x2_sRGB",t[t.U8x3=6]="U8x3",t[t.U8x3_sRGB=7]="U8x3_sRGB",t[t.U8x4=8]="U8x4",t[t.U8x4_sRGB=9]="U8x4_sRGB",t[t.U10_10_10_2=10]="U10_10_10_2",t[t.F11_11_10=11]="F11_11_10",t[t.F16=12]="F16",t[t.F16x2=13]="F16x2",t[t.F16x3=14]="F16x3",t[t.F16x4=15]="F16x4",t[t.F32x2=16]="F32x2",t[t.F32x3=17]="F32x3",t[t.F32x4=18]="F32x4",t[t.Depth32=19]="Depth32",t[t.Depth24Stencil8=20]="Depth24Stencil8"}(h||(h={})),function(t){t[t.Nearest=0]="Nearest",t[t.Linear=1]="Linear"}(l||(l={})),function(t){t[t.Never=0]="Never",t[t.Less=1]="Less",t[t.Equal=2]="Equal",t[t.LessEqual=3]="LessEqual",t[t.Greater=4]="Greater",t[t.NotEqual=5]="NotEqual",t[t.GreaterEqual=6]="GreaterEqual",t[t.Always=7]="Always"}(f||(f={})),function(t){t[t.Points=0]="Points",t[t.Lines=1]="Lines",t[t.LineLoop=2]="LineLoop",t[t.LineStrip=3]="LineStrip",t[t.Triangles=4]="Triangles",t[t.TriangleStrip=5]="TriangleStrip",t[t.TriangleFan=6]="TriangleFan"}(d||(d={})),function(t){t[t.Undefined=0]="Undefined",t[t.Uniform=1]="Uniform",t[t.Vertex=2]="Vertex",t[t.Index=3]="Index",t[t.Readback=4]="Readback"}(p||(p={})),function(t){t[t.Undefined=0]="Undefined",t[t.UniformBuffer=1]="UniformBuffer",t[t.Texture=2]="Texture"}(m||(m={})),function(t){t[t.None=0]="None",t[t.Static=1]="Static",t[t.Dynamic=2]="Dynamic"}(g||(g={})),function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Front=2]="Front"}(y||(y={})),function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Source=2]="Source",t[t.OneMinusSource=3]="OneMinusSource"}(v||(v={})),function(t){t[t.Vertex=0]="Vertex",t[t.Instance=1]="Instance"}(b||(b={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return s}));var r={};n.r(r),n.d(r,"create",(function(){return h})),n.d(r,"clone",(function(){return l})),n.d(r,"copy",(function(){return f})),n.d(r,"fromValues",(function(){return d})),n.d(r,"set",(function(){return p})),n.d(r,"identity",(function(){return m})),n.d(r,"transpose",(function(){return g})),n.d(r,"invert",(function(){return y})),n.d(r,"adjoint",(function(){return v})),n.d(r,"determinant",(function(){return b})),n.d(r,"multiply",(function(){return w})),n.d(r,"translate",(function(){return x})),n.d(r,"scale",(function(){return _})),n.d(r,"rotate",(function(){return C})),n.d(r,"rotateX",(function(){return M})),n.d(r,"rotateY",(function(){return k})),n.d(r,"rotateZ",(function(){return A})),n.d(r,"fromTranslation",(function(){return F})),n.d(r,"fromScaling",(function(){return O})),n.d(r,"fromRotation",(function(){return S})),n.d(r,"fromXRotation",(function(){return T})),n.d(r,"fromYRotation",(function(){return E})),n.d(r,"fromZRotation",(function(){return j})),n.d(r,"fromRotationTranslation",(function(){return I})),n.d(r,"fromQuat2",(function(){return B})),n.d(r,"getTranslation",(function(){return R})),n.d(r,"getScaling",(function(){return D})),n.d(r,"getRotation",(function(){return P})),n.d(r,"fromRotationTranslationScale",(function(){return U})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return z})),n.d(r,"fromQuat",(function(){return N})),n.d(r,"frustum",(function(){return L})),n.d(r,"perspective",(function(){return q})),n.d(r,"perspectiveFromFieldOfView",(function(){return V})),n.d(r,"ortho",(function(){return W})),n.d(r,"lookAt",(function(){return H})),n.d(r,"targetTo",(function(){return Y})),n.d(r,"str",(function(){return X})),n.d(r,"frob",(function(){return K})),n.d(r,"add",(function(){return $})),n.d(r,"subtract",(function(){return J})),n.d(r,"multiplyScalar",(function(){return Z})),n.d(r,"multiplyScalarAndAdd",(function(){return G})),n.d(r,"exactEquals",(function(){return Q})),n.d(r,"equals",(function(){return tt})),n.d(r,"mul",(function(){return et})),n.d(r,"sub",(function(){return nt}));var i={};n.r(i),n.d(i,"create",(function(){return rt})),n.d(i,"clone",(function(){return it})),n.d(i,"length",(function(){return st})),n.d(i,"fromValues",(function(){return ot})),n.d(i,"copy",(function(){return at})),n.d(i,"set",(function(){return ct})),n.d(i,"add",(function(){return ut})),n.d(i,"subtract",(function(){return ht})),n.d(i,"multiply",(function(){return lt})),n.d(i,"divide",(function(){return ft})),n.d(i,"ceil",(function(){return dt})),n.d(i,"floor",(function(){return pt})),n.d(i,"min",(function(){return mt})),n.d(i,"max",(function(){return gt})),n.d(i,"round",(function(){return yt})),n.d(i,"scale",(function(){return vt})),n.d(i,"scaleAndAdd",(function(){return bt})),n.d(i,"distance",(function(){return wt})),n.d(i,"squaredDistance",(function(){return xt})),n.d(i,"squaredLength",(function(){return _t})),n.d(i,"negate",(function(){return Ct})),n.d(i,"inverse",(function(){return Mt})),n.d(i,"normalize",(function(){return kt})),n.d(i,"dot",(function(){return At})),n.d(i,"cross",(function(){return Ft})),n.d(i,"lerp",(function(){return Ot})),n.d(i,"hermite",(function(){return St})),n.d(i,"bezier",(function(){return Tt})),n.d(i,"random",(function(){return Et})),n.d(i,"transformMat4",(function(){return jt})),n.d(i,"transformMat3",(function(){return It})),n.d(i,"transformQuat",(function(){return Bt})),n.d(i,"rotateX",(function(){return Rt})),n.d(i,"rotateY",(function(){return Dt})),n.d(i,"rotateZ",(function(){return Pt})),n.d(i,"angle",(function(){return Ut})),n.d(i,"zero",(function(){return zt})),n.d(i,"str",(function(){return Nt})),n.d(i,"exactEquals",(function(){return Lt})),n.d(i,"equals",(function(){return qt})),n.d(i,"sub",(function(){return Wt})),n.d(i,"mul",(function(){return Ht})),n.d(i,"div",(function(){return Yt})),n.d(i,"dist",(function(){return Xt})),n.d(i,"sqrDist",(function(){return Kt})),n.d(i,"len",(function(){return $t})),n.d(i,"sqrLen",(function(){return Jt})),n.d(i,"forEach",(function(){return Zt}));var s={};n.r(s),n.d(s,"create",(function(){return Gt})),n.d(s,"clone",(function(){return Qt})),n.d(s,"fromValues",(function(){return te})),n.d(s,"copy",(function(){return ee})),n.d(s,"set",(function(){return ne})),n.d(s,"add",(function(){return re})),n.d(s,"subtract",(function(){return ie})),n.d(s,"multiply",(function(){return se})),n.d(s,"divide",(function(){return oe})),n.d(s,"ceil",(function(){return ae})),n.d(s,"floor",(function(){return ce})),n.d(s,"min",(function(){return ue})),n.d(s,"max",(function(){return he})),n.d(s,"round",(function(){return le})),n.d(s,"scale",(function(){return fe})),n.d(s,"scaleAndAdd",(function(){return de})),n.d(s,"distance",(function(){return pe})),n.d(s,"squaredDistance",(function(){return me})),n.d(s,"length",(function(){return ge})),n.d(s,"squaredLength",(function(){return ye})),n.d(s,"negate",(function(){return ve})),n.d(s,"inverse",(function(){return be})),n.d(s,"normalize",(function(){return we})),n.d(s,"dot",(function(){return xe})),n.d(s,"cross",(function(){return _e})),n.d(s,"lerp",(function(){return Ce})),n.d(s,"random",(function(){return Me})),n.d(s,"transformMat4",(function(){return ke})),n.d(s,"transformQuat",(function(){return Ae})),n.d(s,"zero",(function(){return Fe})),n.d(s,"str",(function(){return Oe})),n.d(s,"exactEquals",(function(){return Se})),n.d(s,"equals",(function(){return Te})),n.d(s,"sub",(function(){return Ee})),n.d(s,"mul",(function(){return je})),n.d(s,"div",(function(){return Ie})),n.d(s,"dist",(function(){return Be})),n.d(s,"sqrDist",(function(){return Re})),n.d(s,"len",(function(){return De})),n.d(s,"sqrLen",(function(){return Pe})),n.d(s,"forEach",(function(){return Ue}));var o={};n.r(o),n.d(o,"create",(function(){return ze})),n.d(o,"identity",(function(){return Ne})),n.d(o,"setAxisAngle",(function(){return Le})),n.d(o,"getAxisAngle",(function(){return qe})),n.d(o,"getAngle",(function(){return Ve})),n.d(o,"multiply",(function(){return We})),n.d(o,"rotateX",(function(){return He})),n.d(o,"rotateY",(function(){return Ye})),n.d(o,"rotateZ",(function(){return Xe})),n.d(o,"calculateW",(function(){return Ke})),n.d(o,"exp",(function(){return $e})),n.d(o,"ln",(function(){return Je})),n.d(o,"pow",(function(){return Ze})),n.d(o,"slerp",(function(){return Ge})),n.d(o,"random",(function(){return Qe})),n.d(o,"invert",(function(){return tn})),n.d(o,"conjugate",(function(){return en})),n.d(o,"fromMat3",(function(){return nn})),n.d(o,"fromEuler",(function(){return rn})),n.d(o,"str",(function(){return sn})),n.d(o,"clone",(function(){return dn})),n.d(o,"fromValues",(function(){return pn})),n.d(o,"copy",(function(){return mn})),n.d(o,"set",(function(){return gn})),n.d(o,"add",(function(){return yn})),n.d(o,"mul",(function(){return vn})),n.d(o,"scale",(function(){return bn})),n.d(o,"dot",(function(){return wn})),n.d(o,"lerp",(function(){return xn})),n.d(o,"length",(function(){return _n})),n.d(o,"len",(function(){return Cn})),n.d(o,"squaredLength",(function(){return Mn})),n.d(o,"sqrLen",(function(){return kn})),n.d(o,"normalize",(function(){return An})),n.d(o,"exactEquals",(function(){return Fn})),n.d(o,"equals",(function(){return On})),n.d(o,"rotationTo",(function(){return Sn})),n.d(o,"sqlerp",(function(){return Tn})),n.d(o,"setAxes",(function(){return En}));var a=1e-6,c="undefined"!=typeof Float32Array?Float32Array:Array,u=Math.random;Math.PI;function h(){var t=new c(16);return c!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function l(t){var e=new c(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function f(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function d(t,e,n,r,i,s,o,a,u,h,l,f,d,p,m,g){var y=new c(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=s,y[6]=o,y[7]=a,y[8]=u,y[9]=h,y[10]=l,y[11]=f,y[12]=d,y[13]=p,y[14]=m,y[15]=g,y}function p(t,e,n,r,i,s,o,a,c,u,h,l,f,d,p,m,g){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=c,t[8]=u,t[9]=h,t[10]=l,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=g,t}function m(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function y(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],h=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14],y=e[15],v=n*a-r*o,b=n*c-i*o,w=n*u-s*o,x=r*c-i*a,_=r*u-s*a,C=i*u-s*c,M=h*m-l*p,k=h*g-f*p,A=h*y-d*p,F=l*g-f*m,O=l*y-d*m,S=f*y-d*g,T=v*S-b*O+w*F+x*A-_*k+C*M;return T?(T=1/T,t[0]=(a*S-c*O+u*F)*T,t[1]=(i*O-r*S-s*F)*T,t[2]=(m*C-g*_+y*x)*T,t[3]=(f*_-l*C-d*x)*T,t[4]=(c*A-o*S-u*k)*T,t[5]=(n*S-i*A+s*k)*T,t[6]=(g*w-p*C-y*b)*T,t[7]=(h*C-f*w+d*b)*T,t[8]=(o*O-a*A+u*M)*T,t[9]=(r*A-n*O-s*M)*T,t[10]=(p*_-m*w+y*v)*T,t[11]=(l*w-h*_-d*v)*T,t[12]=(a*k-o*F-c*M)*T,t[13]=(n*F-r*k+i*M)*T,t[14]=(m*b-p*x-g*v)*T,t[15]=(h*x-l*b+f*v)*T,t):null}function v(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],h=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14],y=e[15];return t[0]=a*(f*y-d*g)-l*(c*y-u*g)+m*(c*d-u*f),t[1]=-(r*(f*y-d*g)-l*(i*y-s*g)+m*(i*d-s*f)),t[2]=r*(c*y-u*g)-a*(i*y-s*g)+m*(i*u-s*c),t[3]=-(r*(c*d-u*f)-a*(i*d-s*f)+l*(i*u-s*c)),t[4]=-(o*(f*y-d*g)-h*(c*y-u*g)+p*(c*d-u*f)),t[5]=n*(f*y-d*g)-h*(i*y-s*g)+p*(i*d-s*f),t[6]=-(n*(c*y-u*g)-o*(i*y-s*g)+p*(i*u-s*c)),t[7]=n*(c*d-u*f)-o*(i*d-s*f)+h*(i*u-s*c),t[8]=o*(l*y-d*m)-h*(a*y-u*m)+p*(a*d-u*l),t[9]=-(n*(l*y-d*m)-h*(r*y-s*m)+p*(r*d-s*l)),t[10]=n*(a*y-u*m)-o*(r*y-s*m)+p*(r*u-s*a),t[11]=-(n*(a*d-u*l)-o*(r*d-s*l)+h*(r*u-s*a)),t[12]=-(o*(l*g-f*m)-h*(a*g-c*m)+p*(a*f-c*l)),t[13]=n*(l*g-f*m)-h*(r*g-i*m)+p*(r*f-i*l),t[14]=-(n*(a*g-c*m)-o*(r*g-i*m)+p*(r*c-i*a)),t[15]=n*(a*f-c*l)-o*(r*f-i*l)+h*(r*c-i*a),t}function b(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],c=t[7],u=t[8],h=t[9],l=t[10],f=t[11],d=t[12],p=t[13],m=t[14],g=t[15];return(e*o-n*s)*(l*g-f*m)-(e*a-r*s)*(h*g-f*p)+(e*c-i*s)*(h*m-l*p)+(n*a-r*o)*(u*g-f*d)-(n*c-i*o)*(u*m-l*d)+(r*c-i*a)*(u*p-h*d)}function w(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],h=e[7],l=e[8],f=e[9],d=e[10],p=e[11],m=e[12],g=e[13],y=e[14],v=e[15],b=n[0],w=n[1],x=n[2],_=n[3];return t[0]=b*r+w*a+x*l+_*m,t[1]=b*i+w*c+x*f+_*g,t[2]=b*s+w*u+x*d+_*y,t[3]=b*o+w*h+x*p+_*v,b=n[4],w=n[5],x=n[6],_=n[7],t[4]=b*r+w*a+x*l+_*m,t[5]=b*i+w*c+x*f+_*g,t[6]=b*s+w*u+x*d+_*y,t[7]=b*o+w*h+x*p+_*v,b=n[8],w=n[9],x=n[10],_=n[11],t[8]=b*r+w*a+x*l+_*m,t[9]=b*i+w*c+x*f+_*g,t[10]=b*s+w*u+x*d+_*y,t[11]=b*o+w*h+x*p+_*v,b=n[12],w=n[13],x=n[14],_=n[15],t[12]=b*r+w*a+x*l+_*m,t[13]=b*i+w*c+x*f+_*g,t[14]=b*s+w*u+x*d+_*y,t[15]=b*o+w*h+x*p+_*v,t}function x(t,e,n){var r,i,s,o,a,c,u,h,l,f,d,p,m=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],h=e[7],l=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=c,t[6]=u,t[7]=h,t[8]=l,t[9]=f,t[10]=d,t[11]=p,t[12]=r*m+a*g+l*y+e[12],t[13]=i*m+c*g+f*y+e[13],t[14]=s*m+u*g+d*y+e[14],t[15]=o*m+h*g+p*y+e[15]),t}function _(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function C(t,e,n,r){var i,s,o,c,u,h,l,f,d,p,m,g,y,v,b,w,x,_,C,M,k,A,F,O,S=r[0],T=r[1],E=r[2],j=Math.hypot(S,T,E);return j<a?null:(S*=j=1/j,T*=j,E*=j,i=Math.sin(n),o=1-(s=Math.cos(n)),c=e[0],u=e[1],h=e[2],l=e[3],f=e[4],d=e[5],p=e[6],m=e[7],g=e[8],y=e[9],v=e[10],b=e[11],w=S*S*o+s,x=T*S*o+E*i,_=E*S*o-T*i,C=S*T*o-E*i,M=T*T*o+s,k=E*T*o+S*i,A=S*E*o+T*i,F=T*E*o-S*i,O=E*E*o+s,t[0]=c*w+f*x+g*_,t[1]=u*w+d*x+y*_,t[2]=h*w+p*x+v*_,t[3]=l*w+m*x+b*_,t[4]=c*C+f*M+g*k,t[5]=u*C+d*M+y*k,t[6]=h*C+p*M+v*k,t[7]=l*C+m*M+b*k,t[8]=c*A+f*F+g*O,t[9]=u*A+d*F+y*O,t[10]=h*A+p*F+v*O,t[11]=l*A+m*F+b*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function M(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],c=e[7],u=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*r,t[5]=o*i+h*r,t[6]=a*i+l*r,t[7]=c*i+f*r,t[8]=u*i-s*r,t[9]=h*i-o*r,t[10]=l*i-a*r,t[11]=f*i-c*r,t}function k(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],u=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*r,t[1]=o*i-h*r,t[2]=a*i-l*r,t[3]=c*i-f*r,t[8]=s*r+u*i,t[9]=o*r+h*i,t[10]=a*r+l*i,t[11]=c*r+f*i,t}function A(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],h=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*r,t[1]=o*i+h*r,t[2]=a*i+l*r,t[3]=c*i+f*r,t[4]=u*i-s*r,t[5]=h*i-o*r,t[6]=l*i-a*r,t[7]=f*i-c*r,t}function F(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function O(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e,n){var r,i,s,o=n[0],c=n[1],u=n[2],h=Math.hypot(o,c,u);return h<a?null:(o*=h=1/h,c*=h,u*=h,r=Math.sin(e),s=1-(i=Math.cos(e)),t[0]=o*o*s+i,t[1]=c*o*s+u*r,t[2]=u*o*s-c*r,t[3]=0,t[4]=o*c*s-u*r,t[5]=c*c*s+i,t[6]=u*c*s+o*r,t[7]=0,t[8]=o*u*s+c*r,t[9]=c*u*s-o*r,t[10]=u*u*s+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function T(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function j(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=r+r,c=i+i,u=s+s,h=r*a,l=r*c,f=r*u,d=i*c,p=i*u,m=s*u,g=o*a,y=o*c,v=o*u;return t[0]=1-(d+m),t[1]=l+v,t[2]=f-y,t[3]=0,t[4]=l-v,t[5]=1-(h+m),t[6]=p+g,t[7]=0,t[8]=f+y,t[9]=p-g,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function B(t,e){var n=new c(3),r=-e[0],i=-e[1],s=-e[2],o=e[3],a=e[4],u=e[5],h=e[6],l=e[7],f=r*r+i*i+s*s+o*o;return f>0?(n[0]=2*(a*o+l*r+u*s-h*i)/f,n[1]=2*(u*o+l*i+h*r-a*s)/f,n[2]=2*(h*o+l*s+a*i-u*r)/f):(n[0]=2*(a*o+l*r+u*s-h*i),n[1]=2*(u*o+l*i+h*r-a*s),n[2]=2*(h*o+l*s+a*i-u*r)),I(t,e,n),t}function R(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function D(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],c=e[8],u=e[9],h=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(c,u,h),t}function P(t,e){var n=new c(3);D(n,e);var r=1/n[0],i=1/n[1],s=1/n[2],o=e[0]*r,a=e[1]*i,u=e[2]*s,h=e[4]*r,l=e[5]*i,f=e[6]*s,d=e[8]*r,p=e[9]*i,m=e[10]*s,g=o+l+m,y=0;return g>0?(y=2*Math.sqrt(g+1),t[3]=.25*y,t[0]=(f-p)/y,t[1]=(d-u)/y,t[2]=(a-h)/y):o>l&&o>m?(y=2*Math.sqrt(1+o-l-m),t[3]=(f-p)/y,t[0]=.25*y,t[1]=(a+h)/y,t[2]=(d+u)/y):l>m?(y=2*Math.sqrt(1+l-o-m),t[3]=(d-u)/y,t[0]=(a+h)/y,t[1]=.25*y,t[2]=(f+p)/y):(y=2*Math.sqrt(1+m-o-l),t[3]=(a-h)/y,t[0]=(d+u)/y,t[1]=(f+p)/y,t[2]=.25*y),t}function U(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3],c=i+i,u=s+s,h=o+o,l=i*c,f=i*u,d=i*h,p=s*u,m=s*h,g=o*h,y=a*c,v=a*u,b=a*h,w=r[0],x=r[1],_=r[2];return t[0]=(1-(p+g))*w,t[1]=(f+b)*w,t[2]=(d-v)*w,t[3]=0,t[4]=(f-b)*x,t[5]=(1-(l+g))*x,t[6]=(m+y)*x,t[7]=0,t[8]=(d+v)*_,t[9]=(m-y)*_,t[10]=(1-(l+p))*_,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function z(t,e,n,r,i){var s=e[0],o=e[1],a=e[2],c=e[3],u=s+s,h=o+o,l=a+a,f=s*u,d=s*h,p=s*l,m=o*h,g=o*l,y=a*l,v=c*u,b=c*h,w=c*l,x=r[0],_=r[1],C=r[2],M=i[0],k=i[1],A=i[2],F=(1-(m+y))*x,O=(d+w)*x,S=(p-b)*x,T=(d-w)*_,E=(1-(f+y))*_,j=(g+v)*_,I=(p+b)*C,B=(g-v)*C,R=(1-(f+m))*C;return t[0]=F,t[1]=O,t[2]=S,t[3]=0,t[4]=T,t[5]=E,t[6]=j,t[7]=0,t[8]=I,t[9]=B,t[10]=R,t[11]=0,t[12]=n[0]+M-(F*M+T*k+I*A),t[13]=n[1]+k-(O*M+E*k+B*A),t[14]=n[2]+A-(S*M+j*k+R*A),t[15]=1,t}function N(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,c=i+i,u=n*o,h=r*o,l=r*a,f=i*o,d=i*a,p=i*c,m=s*o,g=s*a,y=s*c;return t[0]=1-l-p,t[1]=h+y,t[2]=f-g,t[3]=0,t[4]=h-y,t[5]=1-u-p,t[6]=d+m,t[7]=0,t[8]=f+g,t[9]=d-m,t[10]=1-u-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,e,n,r,i,s,o){var a=1/(n-e),c=1/(i-r),u=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*c,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t}function q(t,e,n,r,i){var s,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(r-i),t[10]=(i+r)*s,t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t}function V(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),c=2/(o+a),u=2/(i+s);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*c*.5,t[9]=(i-s)*u*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function W(t,e,n,r,i,s,o){var a=1/(e-n),c=1/(r-i),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*c,t[14]=(o+s)*u,t[15]=1,t}function H(t,e,n,r){var i,s,o,c,u,h,l,f,d,p,g=e[0],y=e[1],v=e[2],b=r[0],w=r[1],x=r[2],_=n[0],C=n[1],M=n[2];return Math.abs(g-_)<a&&Math.abs(y-C)<a&&Math.abs(v-M)<a?m(t):(l=g-_,f=y-C,d=v-M,i=w*(d*=p=1/Math.hypot(l,f,d))-x*(f*=p),s=x*(l*=p)-b*d,o=b*f-w*l,(p=Math.hypot(i,s,o))?(i*=p=1/p,s*=p,o*=p):(i=0,s=0,o=0),c=f*o-d*s,u=d*i-l*o,h=l*s-f*i,(p=Math.hypot(c,u,h))?(c*=p=1/p,u*=p,h*=p):(c=0,u=0,h=0),t[0]=i,t[1]=c,t[2]=l,t[3]=0,t[4]=s,t[5]=u,t[6]=f,t[7]=0,t[8]=o,t[9]=h,t[10]=d,t[11]=0,t[12]=-(i*g+s*y+o*v),t[13]=-(c*g+u*y+h*v),t[14]=-(l*g+f*y+d*v),t[15]=1,t)}function Y(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=r[0],c=r[1],u=r[2],h=i-n[0],l=s-n[1],f=o-n[2],d=h*h+l*l+f*f;d>0&&(h*=d=1/Math.sqrt(d),l*=d,f*=d);var p=c*f-u*l,m=u*h-a*f,g=a*l-c*h;return(d=p*p+m*m+g*g)>0&&(p*=d=1/Math.sqrt(d),m*=d,g*=d),t[0]=p,t[1]=m,t[2]=g,t[3]=0,t[4]=l*g-f*m,t[5]=f*p-h*g,t[6]=h*m-l*p,t[7]=0,t[8]=h,t[9]=l,t[10]=f,t[11]=0,t[12]=i,t[13]=s,t[14]=o,t[15]=1,t}function X(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function K(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function $(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function J(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Z(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function G(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function Q(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function tt(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],c=t[5],u=t[6],h=t[7],l=t[8],f=t[9],d=t[10],p=t[11],m=t[12],g=t[13],y=t[14],v=t[15],b=e[0],w=e[1],x=e[2],_=e[3],C=e[4],M=e[5],k=e[6],A=e[7],F=e[8],O=e[9],S=e[10],T=e[11],E=e[12],j=e[13],I=e[14],B=e[15];return Math.abs(n-b)<=a*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-w)<=a*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(i-x)<=a*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(s-_)<=a*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(o-C)<=a*Math.max(1,Math.abs(o),Math.abs(C))&&Math.abs(c-M)<=a*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-k)<=a*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-A)<=a*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(l-F)<=a*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(f-O)<=a*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(d-S)<=a*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-T)<=a*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(m-E)<=a*Math.max(1,Math.abs(m),Math.abs(E))&&Math.abs(g-j)<=a*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(y-I)<=a*Math.max(1,Math.abs(y),Math.abs(I))&&Math.abs(v-B)<=a*Math.max(1,Math.abs(v),Math.abs(B))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var et=w,nt=J;function rt(){var t=new c(3);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function it(t){var e=new c(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function st(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function ot(t,e,n){var r=new c(3);return r[0]=t,r[1]=e,r[2]=n,r}function at(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ct(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function lt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function ft(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function dt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function pt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function mt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function gt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function yt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function vt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function bt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function wt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function xt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function _t(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Ct(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Mt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function kt(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function At(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ft(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],c=n[2];return t[0]=i*c-s*a,t[1]=s*o-r*c,t[2]=r*a-i*o,t}function Ot(t,e,n,r){var i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function St(t,e,n,r,i,s){var o=s*s,a=o*(2*s-3)+1,c=o*(s-2)+s,u=o*(s-1),h=o*(3-2*s);return t[0]=e[0]*a+n[0]*c+r[0]*u+i[0]*h,t[1]=e[1]*a+n[1]*c+r[1]*u+i[1]*h,t[2]=e[2]*a+n[2]*c+r[2]*u+i[2]*h,t}function Tt(t,e,n,r,i,s){var o=1-s,a=o*o,c=s*s,u=a*o,h=3*s*a,l=3*c*o,f=c*s;return t[0]=e[0]*u+n[0]*h+r[0]*l+i[0]*f,t[1]=e[1]*u+n[1]*h+r[1]*l+i[1]*f,t[2]=e[2]*u+n[2]*h+r[2]*l+i[2]*f,t}function Et(t,e){e=e||1;var n=2*u()*Math.PI,r=2*u()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function jt(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function It(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function Bt(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],c=e[1],u=e[2],h=i*u-s*c,l=s*a-r*u,f=r*c-i*a,d=i*f-s*l,p=s*h-r*f,m=r*l-i*h,g=2*o;return h*=g,l*=g,f*=g,d*=2,p*=2,m*=2,t[0]=a+h+d,t[1]=c+l+p,t[2]=u+f+m,t}function Rt(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Dt(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Pt(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Ut(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],c=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(s*s+o*o+a*a),u=c&&At(t,e)/c;return Math.acos(Math.min(Math.max(u,-1),1))}function zt(t){return t[0]=0,t[1]=0,t[2]=0,t}function Nt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Lt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function qt(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],c=e[2];return Math.abs(n-s)<=a*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=a*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-c)<=a*Math.max(1,Math.abs(i),Math.abs(c))}var Vt,Wt=ht,Ht=lt,Yt=ft,Xt=wt,Kt=xt,$t=st,Jt=_t,Zt=(Vt=rt(),function(t,e,n,r,i,s){var o,a;for(e||(e=3),n||(n=0),a=r?Math.min(r*e+n,t.length):t.length,o=n;o<a;o+=e)Vt[0]=t[o],Vt[1]=t[o+1],Vt[2]=t[o+2],i(Vt,Vt,s),t[o]=Vt[0],t[o+1]=Vt[1],t[o+2]=Vt[2];return t});function Gt(){var t=new c(4);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Qt(t){var e=new c(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function te(t,e,n,r){var i=new c(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function ee(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function ne(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function re(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function ie(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function se(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function oe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function ae(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function ce(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function ue(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function he(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function le(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function fe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function de(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function pe(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return Math.hypot(n,r,i,s)}function me(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],s=e[3]-t[3];return n*n+r*r+i*i+s*s}function ge(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function ye(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ve(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function be(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function we(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}function xe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function _e(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],s=n[0]*r[2]-n[2]*r[0],o=n[0]*r[3]-n[3]*r[0],a=n[1]*r[2]-n[2]*r[1],c=n[1]*r[3]-n[3]*r[1],u=n[2]*r[3]-n[3]*r[2],h=e[0],l=e[1],f=e[2],d=e[3];return t[0]=l*u-f*c+d*a,t[1]=-h*u+f*o-d*s,t[2]=h*c-l*o+d*i,t[3]=-h*a+l*s-f*i,t}function Ce(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function Me(t,e){var n,r,i,s,o,a;e=e||1;do{o=(n=2*u()-1)*n+(r=2*u()-1)*r}while(o>=1);do{a=(i=2*u()-1)*i+(s=2*u()-1)*s}while(a>=1);var c=Math.sqrt((1-o)/a);return t[0]=e*n,t[1]=e*r,t[2]=e*i*c,t[3]=e*s*c,t}function ke(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}function Ae(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],c=n[2],u=n[3],h=u*r+a*s-c*i,l=u*i+c*r-o*s,f=u*s+o*i-a*r,d=-o*r-a*i-c*s;return t[0]=h*u+d*-o+l*-c-f*-a,t[1]=l*u+d*-a+f*-o-h*-c,t[2]=f*u+d*-c+h*-a-l*-o,t[3]=e[3],t}function Fe(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Oe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Se(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Te(t,e){var n=t[0],r=t[1],i=t[2],s=t[3],o=e[0],c=e[1],u=e[2],h=e[3];return Math.abs(n-o)<=a*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-c)<=a*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=a*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-h)<=a*Math.max(1,Math.abs(s),Math.abs(h))}var Ee=ie,je=se,Ie=oe,Be=pe,Re=me,De=ge,Pe=ye,Ue=function(){var t=Gt();return function(e,n,r,i,s,o){var a,c;for(n||(n=4),r||(r=0),c=i?Math.min(i*n+r,e.length):e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();function ze(){var t=new c(4);return c!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ne(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Le(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function qe(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>a?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Ve(t,e){var n=wn(t,e);return Math.acos(2*n*n-1)}function We(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],c=n[1],u=n[2],h=n[3];return t[0]=r*h+o*a+i*u-s*c,t[1]=i*h+o*c+s*a-r*u,t[2]=s*h+o*u+r*c-i*a,t[3]=o*h-r*a-i*c-s*u,t}function He(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*a,t[1]=i*c+s*a,t[2]=s*c-i*a,t[3]=o*c-r*a,t}function Ye(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c-s*a,t[1]=i*c+o*a,t[2]=s*c+r*a,t[3]=o*c-i*a,t}function Xe(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*a,t[1]=i*c-r*a,t[2]=s*c+o*a,t[3]=o*c-s*a,t}function Ke(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function $e(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i),a=Math.exp(s),c=o>0?a*Math.sin(o)/o:0;return t[0]=n*c,t[1]=r*c,t[2]=i*c,t[3]=a*Math.cos(o),t}function Je(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i),a=o>0?Math.atan2(o,s)/o:0;return t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=.5*Math.log(n*n+r*r+i*i+s*s),t}function Ze(t,e,n){return Je(t,e),bn(t,t,n),$e(t,t),t}function Ge(t,e,n,r){var i,s,o,c,u,h=e[0],l=e[1],f=e[2],d=e[3],p=n[0],m=n[1],g=n[2],y=n[3];return(s=h*p+l*m+f*g+d*y)<0&&(s=-s,p=-p,m=-m,g=-g,y=-y),1-s>a?(i=Math.acos(s),o=Math.sin(i),c=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(c=1-r,u=r),t[0]=c*h+u*p,t[1]=c*l+u*m,t[2]=c*f+u*g,t[3]=c*d+u*y,t}function Qe(t){var e=u(),n=u(),r=u(),i=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*r),t[3]=s*Math.cos(2*Math.PI*r),t}function tn(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a,t}function en(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function nn(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*s+o]-e[3*o+s])*n,t[s]=(e[3*s+i]+e[3*i+s])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}function rn(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var s=Math.sin(e),o=Math.cos(e),a=Math.sin(n),c=Math.cos(n),u=Math.sin(r),h=Math.cos(r);return t[0]=s*c*h-o*a*u,t[1]=o*a*h+s*c*u,t[2]=o*c*u-s*a*h,t[3]=o*c*h+s*a*u,t}function sn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var on,an,cn,un,hn,ln,fn,dn=Qt,pn=te,mn=ee,gn=ne,yn=re,vn=We,bn=fe,wn=xe,xn=Ce,_n=ge,Cn=_n,Mn=ye,kn=Mn,An=we,Fn=Se,On=Te,Sn=(on=rt(),an=ot(1,0,0),cn=ot(0,1,0),function(t,e,n){var r=At(e,n);return r<-.999999?(Ft(on,an,e),$t(on)<1e-6&&Ft(on,cn,e),kt(on,on),Le(t,on,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ft(on,e,n),t[0]=on[0],t[1]=on[1],t[2]=on[2],t[3]=1+r,An(t,t))}),Tn=(un=ze(),hn=ze(),function(t,e,n,r,i,s){return Ge(un,e,i,s),Ge(hn,n,r,s),Ge(t,un,hn,2*s*(1-s)),t}),En=(ln=new c(9),c!=Float32Array&&(ln[1]=0,ln[2]=0,ln[3]=0,ln[5]=0,ln[6]=0,ln[7]=0),ln[0]=1,ln[4]=1,ln[8]=1,fn=ln,function(t,e,n,r){return fn[0]=n[0],fn[3]=n[1],fn[6]=n[2],fn[1]=r[0],fn[4]=r[1],fn[7]=r[2],fn[2]=-e[0],fn[5]=-e[1],fn[8]=-e[2],An(t,nn(t,fn))})},function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return h}));var r=n(0);const i=8,s=1024;class o{constructor(){this.header={sequence:-1,ack:-1,ackBitfield:0}}get acknowledged(){return Object(r.e)(this.ackTime)}fromBuffer(t,e){return this.header.sequence=e.getUint16(0,!0),this.header.ack=e.getUint16(2,!0),this.header.ackBitfield=e.getUint32(4,!0),this.size=t.byteLength,this.rcvdTime=performance.now(),i}toBuffer(t,e,n){return e.setUint16(0,this.header.sequence,!0),e.setUint16(2,this.header.ack,!0),e.setUint32(4,this.header.ackBitfield,!0),t.set(n,i),this.sendTime=performance.now(),this.ackTime=void 0,this.size=n.byteLength+i,this.size}acknowledge(){return this.ackTime=performance.now(),{tag:this.tag,ackTime:this.ackTime,sentTime:this.sendTime,rttTime:this.ackTime-this.sendTime}}}function a(t,e){return t>e&&t-e<=32768||t<e&&e-t>32768}function c(t){return(t%65536+65536)%65536}var u,h;!function(t){function e(t){return t.offset=0,t.overflowed=!1,t}t.create=function(t,e=!1){return{data:t,offset:0,allowOverflow:e,overflowed:!1,dataView:new DataView(t.buffer,t.byteOffset,t.byteLength)}},t.alloc=function(t,n){const r=t.offset;if(t.offset+n>t.data.byteLength){if(!t.allowOverflow)throw new Error(`MsgBuf.alloc: Overflow without allowflow set (${t.data.byteLength})`);if(n>t.data.byteLength)throw new Error(`MsgBuf.alloc: ${n} > full buffer size`);console.warn("MsgBuf.alloc: Overflow"),e(t),t.overflowed=!0}return t.offset+=n,r},t.clear=e}(u||(u={})),function(t){function e(t,e){if(!Number.isInteger(e))throw new Error("Msg.writeInt: type error");if(e<-32768||e>32767)throw new Error("Msg.writeInt: range error");const n=u.alloc(t,2);t.data[n+0]=e>>0&255,t.data[n+1]=e>>8&255}function n(t){const e=u.alloc(t,2),n=t.data[e]+(t.data[e+1]<<8);return n>>15?4294901760|n:n}t.writeChar=function(t,e){if(!Number.isInteger(e))throw new Error("Msg.writeInt: type error");if(e<-128||e>127)throw new Error("Msg.writeChar: range error");const n=u.alloc(t,1);t.data[n]=e},t.writeByte=function(t,e){if(!Number.isInteger(e))throw new Error("Msg.writeInt: type error");if(e<0||e>255)throw new Error("Msg.writeChar: range error");const n=u.alloc(t,1);t.data[n]=e},t.writeShort=e,t.writeInt=function(t,e){if(!Number.isInteger(e))throw new Error("Msg.writeInt: type error");if(e<-(2**31)||e>2**31-1)throw new Error("Msg.writeInt: range error");const n=u.alloc(t,4);t.data[n+0]=e>>0&255,t.data[n+1]=e>>8&255,t.data[n+2]=e>>16&255,t.data[n+3]=e>>24&255},t.writeAngle16=function(t,n){e(t,Math.round(65536*n/(2*Math.PI)))},t.writeFloat=function(t,e){const n=u.alloc(t,4);t.dataView.setFloat32(n,e,!0)},t.writeString=function(e,n){Object(r.b)(n.length<256),t.writeByte(e,n.length);for(let r=0;r<n.length;r++)t.writeByte(e,n.charCodeAt(r))},t.skip=function(t,e){u.alloc(t,e)},t.readChar=function(t){const e=u.alloc(t,1),n=t.data[e];return n>>7?4294967040|n:n},t.readByte=function(t){const e=u.alloc(t,1);return t.data[e]},t.readShort=n,t.readInt=function(t){const e=u.alloc(t,4);return t.data[e+0]+(t.data[e+1]<<8)+(t.data[e+2]<<16)+(t.data[e+3]<<24)},t.readAngle16=function(t){return n(t)*(2*Math.PI)/65536},t.readFloat=function(t){const e=u.alloc(t,4);return t.dataView.getFloat32(e,!0)},t.readString=function(e){const n=t.readByte(e),r=String.fromCharCode.apply(null,e.data.subarray(e.offset,e.offset+n));return t.skip(e,n),r}}(h||(h={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(12),i=n(8),s=new a,o=new i.a;function a(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(a.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(o.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(o.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,s=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*s,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,o=t.z,a=t.w,c=a*e+s*r-o*n,u=a*n+o*e-i*r,h=a*r+i*n-s*e,l=-i*e-s*n-o*r;return this.x=c*a+l*-i+u*-o-h*-s,this.y=u*a+l*-s+h*-i-c*-o,this.z=h*a+l*-o+c*-s-u*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,s=e.x,o=e.y,a=e.z;return this.x=r*a-i*o,this.y=i*s-n*a,this.z=n*o-r*s,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return s.copy(this).projectOnVector(t),this.sub(s)},reflect:function(t){return this.sub(s.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(r.a.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return c}));var r=n(2);r.a.create();const i=r.c.create();function s(t,e,n){return(n-t)/(e-t)}function o(t,e,n){return Math.max(Math.min(t,n),e)}function a(t){return o(t,0,1)}function c(t,e,n=6.283){return function(t,e,n=1){const r=(e-t)%n;return 2*r%n-r}(t,e,n)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);class i{on(t,e){return Object(r.e)(this.callbacks)||(this.callbacks={}),Object(r.e)(this.callbacks[t])||(this.callbacks[t]=[]),Object(r.b)(-1===this.callbacks[t].indexOf(e),"Attempted to add the same callback twice"),this.callbacks[t].push(e),this}once(t,e){const n=(...r)=>{e(...r),this.off(t,n)};return this.on(t,n),this}off(t,e){return Object(r.a)(Object(r.c)(this.callbacks)[t],e),this}fire(t,...e){if(!this.hasHandlers(t))return this;for(const n of this.callbacks[t])n(...e);return this}hasHandlers(t){return Object(r.e)(this.callbacks)&&Object(r.e)(this.callbacks[t])&&this.callbacks[t].length>0}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(4),i=new r.a,s=new l,o=new r.a(0,0,0),a=new r.a(1,1,1),c=new r.a,u=new r.a,h=new r.a;function l(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(l.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,s,o,a,c,u,h,l,f,d,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=s,g[9]=o,g[13]=a,g[2]=c,g[6]=u,g[10]=h,g[14]=l,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new l).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/i.setFromMatrixColumn(t,0).length(),s=1/i.setFromMatrixColumn(t,1).length(),o=1/i.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*s,e[5]=n[5]*s,e[6]=n[6]*s,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(r),c=Math.sin(r),u=Math.cos(i),h=Math.sin(i);if("XYZ"===t.order){var l=s*u,f=s*h,d=o*u,p=o*h;e[0]=a*u,e[4]=-a*h,e[8]=c,e[1]=f+d*c,e[5]=l-p*c,e[9]=-o*a,e[2]=p-l*c,e[6]=d+f*c,e[10]=s*a}else if("YXZ"===t.order){var m=a*u,g=a*h,y=c*u,v=c*h;e[0]=m+v*o,e[4]=y*o-g,e[8]=s*c,e[1]=s*h,e[5]=s*u,e[9]=-o,e[2]=g*o-y,e[6]=v+m*o,e[10]=s*a}else if("ZXY"===t.order){m=a*u,g=a*h,y=c*u,v=c*h;e[0]=m-v*o,e[4]=-s*h,e[8]=y+g*o,e[1]=g+y*o,e[5]=s*u,e[9]=v-m*o,e[2]=-s*c,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){l=s*u,f=s*h,d=o*u,p=o*h;e[0]=a*u,e[4]=d*c-f,e[8]=l*c+p,e[1]=a*h,e[5]=p*c+l,e[9]=f*c-d,e[2]=-c,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){var b=s*a,w=s*c,x=o*a,_=o*c;e[0]=a*u,e[4]=_-b*h,e[8]=x*h+w,e[1]=h,e[5]=s*u,e[9]=-o*u,e[2]=-c*u,e[6]=w*h+x,e[10]=b-_*h}else if("XZY"===t.order){b=s*a,w=s*c,x=o*a,_=o*c;e[0]=a*u,e[4]=-h,e[8]=c*u,e[1]=b*h+_,e[5]=s*u,e[9]=w*h-x,e[2]=x*h-w,e[6]=o*u,e[10]=_*h+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(o,t,a)},lookAt:function(t,e,n){var r=this.elements;return h.subVectors(t,e),0===h.lengthSq()&&(h.z=1),h.normalize(),c.crossVectors(n,h),0===c.lengthSq()&&(1===Math.abs(n.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),c.crossVectors(n,h)),c.normalize(),u.crossVectors(h,c),r[0]=c.x,r[4]=u.x,r[8]=h.x,r[1]=c.y,r[5]=u.y,r[9]=h.y,r[2]=c.z,r[6]=u.z,r[10]=h.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[4],a=n[8],c=n[12],u=n[1],h=n[5],l=n[9],f=n[13],d=n[2],p=n[6],m=n[10],g=n[14],y=n[3],v=n[7],b=n[11],w=n[15],x=r[0],_=r[4],C=r[8],M=r[12],k=r[1],A=r[5],F=r[9],O=r[13],S=r[2],T=r[6],E=r[10],j=r[14],I=r[3],B=r[7],R=r[11],D=r[15];return i[0]=s*x+o*k+a*S+c*I,i[4]=s*_+o*A+a*T+c*B,i[8]=s*C+o*F+a*E+c*R,i[12]=s*M+o*O+a*j+c*D,i[1]=u*x+h*k+l*S+f*I,i[5]=u*_+h*A+l*T+f*B,i[9]=u*C+h*F+l*E+f*R,i[13]=u*M+h*O+l*j+f*D,i[2]=d*x+p*k+m*S+g*I,i[6]=d*_+p*A+m*T+g*B,i[10]=d*C+p*F+m*E+g*R,i[14]=d*M+p*O+m*j+g*D,i[3]=y*x+v*k+b*S+w*I,i[7]=y*_+v*A+b*T+w*B,i[11]=y*C+v*F+b*E+w*R,i[15]=y*M+v*O+b*j+w*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],s=t[1],o=t[5],a=t[9],c=t[13],u=t[2],h=t[6],l=t[10],f=t[14];return t[3]*(+i*a*h-r*c*h-i*o*l+n*c*l+r*o*f-n*a*f)+t[7]*(+e*a*f-e*c*l+i*s*l-r*s*f+r*c*u-i*a*u)+t[11]*(+e*c*h-e*o*f-i*s*h+n*s*f+i*o*u-n*c*u)+t[15]*(-r*o*u-e*a*h+e*o*l+r*s*h-n*s*l+n*a*u)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],s=r[1],o=r[2],a=r[3],c=r[4],u=r[5],h=r[6],l=r[7],f=r[8],d=r[9],p=r[10],m=r[11],g=r[12],y=r[13],v=r[14],b=r[15],w=d*v*l-y*p*l+y*h*m-u*v*m-d*h*b+u*p*b,x=g*p*l-f*v*l-g*h*m+c*v*m+f*h*b-c*p*b,_=f*y*l-g*d*l+g*u*m-c*y*m-f*u*b+c*d*b,C=g*d*h-f*y*h-g*u*p+c*y*p+f*u*v-c*d*v,M=i*w+s*x+o*_+a*C;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var k=1/M;return n[0]=w*k,n[1]=(y*p*a-d*v*a-y*o*m+s*v*m+d*o*b-s*p*b)*k,n[2]=(u*v*a-y*h*a+y*o*l-s*v*l-u*o*b+s*h*b)*k,n[3]=(d*h*a-u*p*a-d*o*l+s*p*l+u*o*m-s*h*m)*k,n[4]=x*k,n[5]=(f*v*a-g*p*a+g*o*m-i*v*m-f*o*b+i*p*b)*k,n[6]=(g*h*a-c*v*a-g*o*l+i*v*l+c*o*b-i*h*b)*k,n[7]=(c*p*a-f*h*a+f*o*l-i*p*l-c*o*m+i*h*m)*k,n[8]=_*k,n[9]=(g*d*a-f*y*a-g*s*m+i*y*m+f*s*b-i*d*b)*k,n[10]=(c*y*a-g*u*a+g*s*l-i*y*l-c*s*b+i*u*b)*k,n[11]=(f*u*a-c*d*a-f*s*l+i*d*l+c*s*m-i*u*m)*k,n[12]=C*k,n[13]=(f*y*o-g*d*o+g*s*p-i*y*p-f*s*v+i*d*v)*k,n[14]=(g*u*o-c*y*o-g*s*h+i*y*h+c*s*v-i*u*v)*k,n[15]=(c*d*o-f*u*o+f*s*h-i*d*h-c*s*p+i*u*p)*k,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,s=t.x,o=t.y,a=t.z,c=i*s,u=i*o;return this.set(c*s+n,c*o-r*a,c*a+r*o,0,c*o+r*a,u*o+n,u*a-r*s,0,c*a-r*o,u*a+r*s,i*a*a+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,s=e._y,o=e._z,a=e._w,c=i+i,u=s+s,h=o+o,l=i*c,f=i*u,d=i*h,p=s*u,m=s*h,g=o*h,y=a*c,v=a*u,b=a*h,w=n.x,x=n.y,_=n.z;return r[0]=(1-(p+g))*w,r[1]=(f+b)*w,r[2]=(d-v)*w,r[3]=0,r[4]=(f-b)*x,r[5]=(1-(l+g))*x,r[6]=(m+y)*x,r[7]=0,r[8]=(d+v)*_,r[9]=(m-y)*_,r[10]=(1-(l+p))*_,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,o=i.set(r[0],r[1],r[2]).length(),a=i.set(r[4],r[5],r[6]).length(),c=i.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),t.x=r[12],t.y=r[13],t.z=r[14],s.copy(this);var u=1/o,h=1/a,l=1/c;return s.elements[0]*=u,s.elements[1]*=u,s.elements[2]*=u,s.elements[4]*=h,s.elements[5]*=h,s.elements[6]*=h,s.elements[8]*=l,s.elements[9]*=l,s.elements[10]*=l,e.setFromRotationMatrix(s),n.x=o,n.y=a,n.z=c,this},makePerspective:function(t,e,n,r,i,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,a=2*i/(e-t),c=2*i/(n-r),u=(e+t)/(e-t),h=(n+r)/(n-r),l=-(s+i)/(s-i),f=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=c,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=l,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,n,r,i,s){var o=this.elements,a=1/(e-t),c=1/(n-r),u=1/(s-i),h=(e+t)*a,l=(n+r)*c,f=(s+i)*u;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-l,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(12);function i(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}Object.assign(i,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,s,o){var a=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3],l=i[s+0],f=i[s+1],d=i[s+2],p=i[s+3];if(h!==p||a!==l||c!==f||u!==d){var m=1-o,g=a*l+c*f+u*d+h*p,y=g>=0?1:-1,v=1-g*g;if(v>Number.EPSILON){var b=Math.sqrt(v),w=Math.atan2(b,g*y);m=Math.sin(m*w)/b,o=Math.sin(o*w)/b}var x=o*y;if(a=a*m+l*x,c=c*m+f*x,u=u*m+d*x,h=h*m+p*x,m===1-o){var _=1/Math.sqrt(a*a+c*c+u*u+h*h);a*=_,c*=_,u*=_,h*=_}}t[e]=a,t[e+1]=c,t[e+2]=u,t[e+3]=h}}),Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(i.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,s=t.order,o=Math.cos,a=Math.sin,c=o(n/2),u=o(r/2),h=o(i/2),l=a(n/2),f=a(r/2),d=a(i/2);return"XYZ"===s?(this._x=l*u*h+c*f*d,this._y=c*f*h-l*u*d,this._z=c*u*d+l*f*h,this._w=c*u*h-l*f*d):"YXZ"===s?(this._x=l*u*h+c*f*d,this._y=c*f*h-l*u*d,this._z=c*u*d-l*f*h,this._w=c*u*h+l*f*d):"ZXY"===s?(this._x=l*u*h-c*f*d,this._y=c*f*h+l*u*d,this._z=c*u*d+l*f*h,this._w=c*u*h-l*f*d):"ZYX"===s?(this._x=l*u*h-c*f*d,this._y=c*f*h+l*u*d,this._z=c*u*d-l*f*h,this._w=c*u*h+l*f*d):"YZX"===s?(this._x=l*u*h+c*f*d,this._y=c*f*h+l*u*d,this._z=c*u*d-l*f*h,this._w=c*u*h-l*f*d):"XZY"===s&&(this._x=l*u*h-c*f*d,this._y=c*f*h-l*u*d,this._z=c*u*d+l*f*h,this._w=c*u*h+l*f*d),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],s=n[8],o=n[1],a=n[5],c=n[9],u=n[2],h=n[6],l=n[10],f=r+a+l;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(h-c)*e,this._y=(s-u)*e,this._z=(o-i)*e):r>a&&r>l?(e=2*Math.sqrt(1+r-a-l),this._w=(h-c)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(s+u)/e):a>l?(e=2*Math.sqrt(1+a-r-l),this._w=(s-u)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(c+h)/e):(e=2*Math.sqrt(1+l-r-a),this._w=(o-i)/e,this._x=(s+u)/e,this._y=(c+h)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(r.a.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,s=t._w,o=e._x,a=e._y,c=e._z,u=e._w;return this._x=n*u+s*o+r*c-i*a,this._y=r*u+s*a+i*o-n*c,this._z=i*u+s*c+n*a-r*o,this._w=s*u-n*o-r*a-i*c,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,s=this._w,o=s*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=r,this._z=i,this;var a=1-o*o;if(a<=Number.EPSILON){var c=1-e;return this._w=c*s+e*this._w,this._x=c*n+e*this._x,this._y=c*r+e*this._y,this._z=c*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(a),h=Math.atan2(u,o),l=Math.sin((1-e)*h)/u,f=Math.sin(e*h)/u;return this._w=s*l+this._w*f,this._x=n*l+this._x*f,this._y=r*l+this._y*f,this._z=i*l+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var r=n(14),i=n(0),s=n(5),o=n(3);new TextEncoder,new TextDecoder;class a{constructor(){this.avatars=[];for(let t=0;t<a.kAvatarCount;t++)this.avatars[t]=new r.b}static lerp(t,e,n,i){for(let s=0;s<a.kAvatarCount;s++)r.b.lerp(t.avatars[s],e.avatars[s],n.avatars[s],i);return t}static copy(t,e){for(let n=0;n<a.kAvatarCount;n++)r.b.copy(t.avatars[n],e.avatars[n]);return t}static serialize(t,e){o.a.writeInt(t,e.frame);for(let n=0;n<this.kAvatarCount;n++)r.b.serialize(t,e.avatars[n])}static deserialize(t,e){e.frame=o.a.readInt(t);for(let n=0;n<this.kAvatarCount;n++)r.b.deserialize(t,e.avatars[n])}}a.kAvatarCount=6;class c{constructor(){this.buffer=[],this.latestFrame=-1,this.bufferFrameCount=64}setSnapshot(t){Object(i.b)(t.frame>this.latestFrame-this.bufferFrameCount),this.buffer[t.frame%this.bufferFrameCount]=t,this.latestFrame=Math.max(this.latestFrame,t.frame)}getSnapshot(t=this.latestFrame){return Object(i.b)(t>this.latestFrame-this.bufferFrameCount),this.buffer[t%this.bufferFrameCount]}hasSnapshot(t=this.latestFrame){const e=this.buffer[t%this.bufferFrameCount];return Object(i.e)(e)&&e.frame===t}lerpSnapshot(t,e){var n,r;const i=Math.max(0,this.latestFrame-this.bufferFrameCount-1);if(t<i)return console.warn("Requested snapshot older than buffer length"),!1;let o=Math.floor(t);for(;o>=i&&(null===(n=this.buffer[o%this.bufferFrameCount])||void 0===n?void 0:n.frame)!==o;)o-=1;let c=Math.ceil(t);for(;c<=this.latestFrame&&(null===(r=this.buffer[c%this.bufferFrameCount])||void 0===r?void 0:r.frame)!==c;)c+=1;const u=o>=i,h=c<=this.latestFrame,l=this.buffer[o%this.bufferFrameCount],f=this.buffer[c%this.bufferFrameCount];if(u&&!h)return console.warn("Extrapolation not yet implemented"),!1;if(!u&&h)return console.warn("Extrapolation not yet implemented"),!1;if(u||h){if(l===f)return a.copy(e,l),!0;const n=Object(s.d)(o,c,t);return a.lerp(e,l,f,n),!0}return console.warn("No valid snapshot for this frame"),!1}createSnapshot({clock:t,avatar:e}){const n=this.buffer[this.latestFrame%this.bufferFrameCount],r=new a;return n&&a.copy(r,n),r.frame=t.simFrame,r.avatars=e.getSnapshot(),r}}},function(t,e,n){"use strict";n.d(e,"f",(function(){return d})),n.d(e,"g",(function(){return p})),n.d(e,"e",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return R}));var r=2300,i=2301;function s(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function o(t,e,n,r){s.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function a(t,e,n,r){s.call(this,t,e,n,r)}function c(t,e,n,r){s.call(this,t,e,n,r)}Object.assign(s.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var s;n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}s=e.length;break n}if(t>=i)break t;var a=e[1];t<a&&(n=2,i=a);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}s=n,n=0}for(;n<s;){var c=n+s>>>1;t<e[c]?s=c:n=c+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,s=0;s!==r;++s)e[s]=n[i+s];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(s.prototype,{beforeStart_:s.prototype.copySampleValue_,afterEnd_:s.prototype.copySampleValue_}),o.prototype=Object.assign(Object.create(s.prototype),{constructor:o,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,s=t+1,o=r[i],a=r[s];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=t,o=2*e-n;break;case 2402:o=e+r[i=r.length-2]-r[i+1];break;default:i=t,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:s=t,a=2*n-e;break;case 2402:s=1,a=n+r[1]-r[0];break;default:s=t-1,a=e}var c=.5*(n-e),u=this.valueSize;this._weightPrev=c/(e-o),this._weightNext=c/(a-n),this._offsetPrev=i*u,this._offsetNext=s*u},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,c=a-o,u=this._offsetPrev,h=this._offsetNext,l=this._weightPrev,f=this._weightNext,d=(n-e)/(r-e),p=d*d,m=p*d,g=-l*m+2*l*p-l*d,y=(1+l)*m+(-1.5-2*l)*p+(-.5+l)*d+1,v=(-1-f)*m+(1.5+f)*p+.5*d,b=f*m-f*p,w=0;w!==o;++w)i[w]=g*s[u+w]+y*s[c+w]+v*s[a+w]+b*s[h+w];return i}}),a.prototype=Object.assign(Object.create(s.prototype),{constructor:a,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,c=a-o,u=(n-e)/(r-e),h=1-u,l=0;l!==o;++l)i[l]=s[c+l]*h+s[a+l]*u;return i}}),c.prototype=Object.assign(Object.create(s.prototype),{constructor:c,interpolate_:function(t){return this.copySampleValue_(t-1)}});var u={arraySlice:function(t,e,n){return u.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),s=0,o=0;o!==r;++s)for(var a=n[s]*e,c=0;c!==e;++c)i[o++]=t[a+c];return i},flattenJSON:function(t,e,n,r){for(var i=1,s=t[0];void 0!==s&&void 0===s[r];)s=t[i++];if(void 0!==s){var o=s[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=s[r])&&(e.push(s.time),n.push.apply(n,o)),s=t[i++]}while(void 0!==s);else if(void 0!==o.toArray)do{void 0!==(o=s[r])&&(e.push(s.time),o.toArray(n,n.length)),s=t[i++]}while(void 0!==s);else do{void 0!==(o=s[r])&&(e.push(s.time),n.push(o)),s=t[i++]}while(void 0!==s)}},subclip:function(t,e,n,r,i){i=i||30;var s=t.clone();s.name=e;for(var o=[],a=0;a<s.tracks.length;++a){for(var c=s.tracks[a],h=c.getValueSize(),l=[],f=[],d=0;d<c.times.length;++d){var p=c.times[d]*i;if(!(p<n||p>=r)){l.push(c.times[d]);for(var m=0;m<h;++m)f.push(c.values[d*h+m])}}0!==l.length&&(c.times=u.convertArray(l,c.times.constructor),c.values=u.convertArray(f,c.values.constructor),o.push(c))}s.tracks=o;var g=1/0;for(a=0;a<s.tracks.length;++a)g>s.tracks[a].times[0]&&(g=s.tracks[a].times[0]);for(a=0;a<s.tracks.length;++a)s.tracks[a].shift(-1*g);return s.resetDuration(),s}};function h(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=u.convertArray(e,this.TimeBufferType),this.values=u.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}Object.assign(h,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:u.convertArray(t.times,Array),values:u.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(h.prototype,{constructor:h,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:i,InterpolantFactoryMethodDiscrete:function(t){return new c(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new a(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new o(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case r:e=this.InterpolantFactoryMethodDiscrete;break;case i:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return r;case this.InterpolantFactoryMethodLinear:return i;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,s=r-1;i!==r&&n[i]<t;)++i;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==i||s!==r){i>=s&&(i=(s=Math.max(s,1))-1);var o=this.getValueSize();this.times=u.arraySlice(n,i,s),this.values=u.arraySlice(this.values,i*o,s*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var s=null,o=0;o!==i;o++){var a=n[o];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(null!==s&&s>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,s),t=!1;break}s=a}if(void 0!==r&&u.isTypedArray(r)){o=0;for(var c=r.length;o!==c;++o){var h=r[o];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,h),t=!1;break}}}return t},optimize:function(){for(var t=u.arraySlice(this.times),e=u.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,s=t.length-1,o=1;o<s;++o){var a=!1,c=t[o];if(c!==t[o+1]&&(1!==o||c!==c[0]))if(r)a=!0;else for(var h=o*n,l=h-n,f=h+n,d=0;d!==n;++d){var p=e[h+d];if(p!==e[l+d]||p!==e[f+d]){a=!0;break}}if(a){if(o!==i){t[i]=t[o];var m=o*n,g=i*n;for(d=0;d!==n;++d)e[g+d]=e[m+d]}++i}}if(s>0){t[i]=t[s];for(m=s*n,g=i*n,d=0;d!==n;++d)e[g+d]=e[m+d];++i}return i!==t.length?(this.times=u.arraySlice(t,0,i),this.values=u.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=u.arraySlice(this.times,0),e=u.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}});var l=n(8);function f(t,e,n,r){s.call(this,t,e,n,r)}function d(t,e,n,r){h.call(this,t,e,n,r)}function p(t,e,n,r){h.call(this,t,e,n,r)}function m(t,e,n){h.call(this,t,e,n)}function g(t,e,n,r){h.call(this,t,e,n,r)}function y(t,e,n,r){h.call(this,t,e,n,r)}function v(t,e,n,r){h.call(this,t,e,n,r)}f.prototype=Object.assign(Object.create(s.prototype),{constructor:f,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,c=(n-e)/(r-e),u=a+o;a!==u;a+=4)l.a.slerpFlat(i,0,s,a-o,s,a,c);return i}}),d.prototype=Object.assign(Object.create(h.prototype),{constructor:d,ValueTypeName:"quaternion",DefaultInterpolation:i,InterpolantFactoryMethodLinear:function(t){return new f(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),p.prototype=Object.assign(Object.create(h.prototype),{constructor:p,ValueTypeName:"vector"}),m.prototype=Object.assign(Object.create(h.prototype),{constructor:m,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:r,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),g.prototype=Object.assign(Object.create(h.prototype),{constructor:g,ValueTypeName:"color"}),y.prototype=Object.assign(Object.create(h.prototype),{constructor:y,ValueTypeName:"number"}),v.prototype=Object.assign(Object.create(h.prototype),{constructor:v,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:r,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});var b=n(12);function w(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=b.a.generateUUID(),this.duration<0&&this.resetDuration()}function x(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return y;case"vector":case"vector2":case"vector3":case"vector4":return p;case"color":return g;case"quaternion":return d;case"bool":case"boolean":return m;case"string":return v}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];u.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function _(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,s=new Array(i),o={endingStart:2400,endingEnd:2400},a=0;a!==i;++a){var c=r[a].createInterpolant(null);s[a]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(w,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,s=n.length;i!==s;++i)e.push(x(n[i]).scale(r));return new w(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,s=n.length;i!==s;++i)e.push(h.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,s=[],o=0;o<i;o++){var a=[],c=[];a.push((o+i-1)%i,o,(o+1)%i),c.push(0,1,0);var h=u.getKeyframeOrder(a);a=u.sortedArray(a,1,h),c=u.sortedArray(c,1,h),r||0!==a[0]||(a.push(i),c.push(c[0])),s.push(new y(".morphTargetInfluences["+e[o].name+"]",a,c).scale(1/n))}return new w(t,-1,s)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,s=0,o=t.length;s<o;s++){var a=t[s],c=a.name.match(i);if(c&&c.length>1){var u=r[l=c[1]];u||(r[l]=u=[]),u.push(a)}}var h=[];for(var l in r)h.push(w.CreateFromMorphTargetSequence(l,r[l],e,n));return h},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var s=[],o=[];u.flattenJSON(n,s,o,r),0!==s.length&&i.push(new t(e,s,o))}},r=[],i=t.name||"default",s=t.length||-1,o=t.fps||30,a=t.hierarchy||[],c=0;c<a.length;c++){var h=a[c].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var l={},f=0;f<h.length;f++)if(h[f].morphTargets)for(var m=0;m<h[f].morphTargets.length;m++)l[h[f].morphTargets[m]]=-1;for(var g in l){var v=[],b=[];for(m=0;m!==h[f].morphTargets.length;++m){var x=h[f];v.push(x.time),b.push(x.morphTarget===g?1:0)}r.push(new y(".morphTargetInfluence["+g+"]",v,b))}s=l.length*(o||1)}else{var _=".bones["+e[c].name+"]";n(p,_+".position",h,"pos",r),n(d,_+".quaternion",h,"rot",r),n(p,_+".scale",h,"scl",r)}}return 0===r.length?null:new w(i,s,r)}}),Object.assign(w.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new w(this.name,this.duration,t)}}),Object.assign(_.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,s=i/r,o=r/i;t.warp(1,s,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,s=this._timeScaleInterpolant,o=this.timeScale;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);var a=s.parameterPositions,c=s.sampleValues;return a[0]=i,a[1]=i+n,c[0]=t/o,c[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var s=(t-i)*n;if(s<0||0===n)return;this._startTime=null,e=n*s}e*=this._updateTimeScale(t);var o=this._updateTime(e),a=this._updateWeight(t);if(a>0)for(var c=this._interpolants,u=this._propertyBindings,h=0,l=c.length;h!==l;++h)c[h].evaluate(o),u[h].accumulate(r,a)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,s=2202===r;if(0===t)return-1===i?e:s&&1==(1&i)?n-e:e;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),e>=n||e<0){var o=Math.floor(e/n);e-=n*o,i+=Math.abs(o);var a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){var c=t<0;this._setEndings(c,!c,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=e;if(s&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,s=this._weightInterpolant;null===s&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);var o=s.parameterPositions,a=s.sampleValues;return o[0]=i,a[0]=e,o[1]=i+t,a[1]=n,this}});var C=n(31),M=new RegExp("[\\[\\]\\.:\\/]","g"),k="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",A=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),F=/(WCOD+)?/.source.replace("WCOD",k),O=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),S=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),T=new RegExp("^"+A+F+O+S+"$"),E=["material","materials","bones"];function j(t,e,n){var r=n||I.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function I(t,e,n){this.path=e,this.parsedPath=n||I.parseTrackName(e),this.node=I.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function B(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function R(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Object.assign(j.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(I,{Composite:j,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new I.Composite(t,e,n):new I(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(M,"")},parseTrackName:function(t){var e=T.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==E.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var s=r(i.children);if(s)return s}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(I.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=I.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var s=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===s){s=o;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==s){if(void 0===t[s])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[s]}}var a=t[r];if(void 0!==a){var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var h=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(I.prototype,{_getValue_unbound:I.prototype.getValue,_setValue_unbound:I.prototype.setValue}),Object.assign(B.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,s=this.cumulativeWeight;if(0===s){for(var o=0;o!==r;++o)n[i+o]=n[o];s=e}else{var a=e/(s+=e);this._mixBufferRegion(n,i,0,a,r)}this.cumulativeWeight=s},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,s=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*e;this._mixBufferRegion(n,r,o,1-i,e)}for(var a=e,c=e+e;a!==c;++a)if(n[a]!==n[a+e]){s.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,s=r;i!==s;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var s=0;s!==i;++s)t[e+s]=t[n+s]},_slerp:function(t,e,n,r){l.a.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var s=1-r,o=0;o!==i;++o){var a=e+o;t[a]=t[a]*s+t[n+o]*r}}}),R.prototype=Object.assign(Object.create(C.a.prototype),{constructor:R,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,s=t._propertyBindings,o=t._interpolants,a=n.uuid,c=this._bindingsByRootAndName,u=c[a];void 0===u&&(u={},c[a]=u);for(var h=0;h!==i;++h){var l=r[h],f=l.name,d=u[f];if(void 0!==d)s[h]=d;else{if(void 0!==(d=s[h])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,a,f));continue}var p=e&&e._propertyBindings[h].binding.parsedPath;++(d=new B(I.create(n,f,p),l.ValueTypeName,l.getValueSize())).referenceCount,this._addInactiveBinding(d,a,f),s[h]=d}o[h].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,s=0,o=i.length;s!==o;++s){var a=i[s];0==a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,s=i[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=s;else{var o=s.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=r.length,r.push(t),s.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,s=this._actionsByClip,o=s[i],a=o.knownActions,c=a[a.length-1],u=t._byClipCacheIndex;c._byClipCacheIndex=u,a[u]=c,a.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete s[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],s=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=s.length,s.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,s=this._bindingsByRootAndName,o=s[r],a=e[e.length-1],c=t._cacheIndex;a._cacheIndex=c,e[c]=a,e.pop(),delete o[i],0===Object.keys(o).length&&delete s[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new a(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?w.findByName(n,t):t,s=null!==i?i.uuid:t,o=this._actionsByClip[s],a=null;if(void 0!==o){var c=o.actionByRoot[r];if(void 0!==c)return c;a=o.knownActions[0],null===i&&(i=a._clip)}if(null===i)return null;var u=new _(this,i,e);return this._bindAction(u,a),this._addInactiveAction(u,s,r),u},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?w.findByName(n,t):t,s=i?i.uuid:t,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),s=this._accuIndex^=1,o=0;o!==n;++o){e[o]._update(r,t,i,s)}var a=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)a[o].apply(s);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var s=i.knownActions,o=0,a=s.length;o!==a;++o){var c=s[o];this._deactivateAction(c);var u=c._cacheIndex,h=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,e[u]=h,e.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var s=this._bindingsByRootAndName[e];if(void 0!==s)for(var o in s){var a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}})},function(t,e,n){"use strict";n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return y}));var r,i=n(16),s=n(3),o=n(6),a=n(0);!function(t){t.Receive="receive"}(r||(r={}));const c=new Uint8Array(s.e+s.d),u=new DataView(c.buffer);class h{constructor(){this.averageRtt=0,this.packetLoss=0,this.inKbps=0,this.outKbps=0}}class l extends o.a{constructor(){super(...arguments),this.stats=new h,this.remoteSequence=-1,this.localSequence=0,this.localHistory=[],this.remoteHistory=[],this.latestAck={}}get isOpen(){return this.socket.isOpen}get ping(){return this.stats.averageRtt>0?this.stats.averageRtt:void 0}initialize(t){this.socket=t,this.socket.on(i.a.Message,this.onMessage.bind(this));for(let t=0;t<512;t++)this.localHistory[t]=new s.c,this.remoteHistory[t]=new s.c}computeStats(){const t=performance.now();let e=0,n=0,r=0,i=0,s=0,o=0,c=1/0,u=1/0;for(let s=0;s<Math.min(this.localSequence,512);s++){const u=this.localSequence-s,h=this.localHistory[u%512];h.header.sequence===u&&(t-h.sendTime>1e3&&(h.acknowledged?e+=1:n+=1),Object(a.e)(h.ackTime)&&(r+=h.ackTime-h.sendTime,i+=1),o+=h.size,c=Math.min(c,h.sendTime))}for(let t=0;t<Math.min(this.remoteSequence,512);t++){const e=this.remoteSequence-t,n=this.remoteHistory[e%512];n.header.sequence!==e||(s+=n.size,u=Math.min(u,n.rcvdTime))}return this.stats.packetLoss=n+e>0?n/(n+e):0,this.stats.averageRtt=i>0?r/i:0,this.stats.outKbps=o/(t-c)*8,this.stats.inKbps=s/(t-u)*8,this.stats}send(t,e){if(t.length>s.e)return void console.warn("NetChannel: Attempted to send packet that was too large for buffer. Ignoring.");const n=this.localHistory[this.localSequence%512];n.header.sequence=this.localSequence,n.header.ack=this.remoteSequence,n.header.ackBitfield=this.writeAckBitfield(this.remoteHistory),n.tag=Object(a.d)(e,this.localSequence);const r=n.toBuffer(c,u,t);this.socket.send(c.subarray(0,r)),this.localSequence=Object(s.g)(this.localSequence+1)}receive(t){const e=new DataView(t),n=e.getUint16(0,!0);if(Object(s.f)(n,this.remoteSequence)){this.remoteSequence=n;const i=this.remoteHistory[n%512],o=i.fromBuffer(t,e),c=new Uint8Array(t,o);if(!Object(a.e)(i))return void console.warn("NetChannel: Received packet that was too large for buffer. Ignoring.");const u=i.header.ackBitfield;for(let t=0;t<32;t++)if(u&1<<t){const e=Object(s.g)(i.header.ack-t),n=this.localHistory[e%512];n.header.sequence!==e||n.acknowledged||this.acknowledge(n)}this.fire(r.Receive,c,this.latestAck.info)}else console.debug("NetChannel: Ignoring stale packet with sequence number",n)}onMessage(t){const e=t.data;e instanceof ArrayBuffer?this.receive(e):console.log("received:",e)}acknowledge(t){const e=t.acknowledge();Object(a.e)(this.latestAck.sequence)&&!Object(s.f)(t.header.sequence,this.latestAck.sequence)||(this.latestAck.info=e,this.latestAck.sequence=t.header.sequence)}writeAckBitfield(t){let e=0;for(const n of t)if(-1!==n.header.sequence){const t=Object(s.g)(this.remoteSequence-n.header.sequence);t<32&&(e|=1<<t)}return e}}var f,d,p=n(19),m=n(9),g=n(15);!function(t){t[t.Free=0]="Free",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected"}(f||(f={})),function(t){t.Connected="connected",t.Disconnected="disconnected",t.Message="message"}(d||(d={}));class y extends o.a{constructor(){super(...arguments),this.state=f.Free,this.ping=-1,this.lastRequestedFrame=-1,this.lastReceivedFrame=-1,this.lastTransmittedFrame=-1,this.lastAcknowledgedFrame=-1,this.snapshot=new m.b,this.userCommands=new p.b,this.msgBuf=s.b.create(new Uint8Array(s.e))}initialize(t){Object(a.b)(this.state===f.Free),console.debug(`NetClient: ${this.id} is attempting to connect`),t.on(i.a.Open,()=>{console.debug(`NetClient: ${this.id} connected`),this.state=f.Connected,this.fire(d.Connected)}),t.on(i.a.Close,()=>{console.debug(`NetClient: ${this.id} disconnected`),this.state=f.Disconnected,this.fire(d.Disconnected)}),this.channel=new l,this.channel.on(r.Receive,this.onMessage.bind(this)),this.channel.initialize(t)}async connect(t){const e=new i.b;await e.connect(t),this.id=e.clientId,this.initialize(e)}accept(t){this.id=t.peerId,this.initialize(t)}setNetGraphPanel(t){this.graphPanel=t}transmitClientFrame(t,e){Object(a.b)(t===e.frame),this.userCommands.setUserCommand(e);const n=s.b.clear(this.msgBuf);s.a.writeChar(n,1),s.a.writeInt(n,t);const r=Math.max(this.lastAcknowledgedFrame,t-5,0);for(let e=t;e>=r;e--){const t=this.userCommands.getUserCommand(e);if(!Object(a.e)(t))break;Object(a.b)(t.frame===e),p.a.serialize(n,t)}this.channel.send(n.data.subarray(0,n.offset),t),this.lastTransmittedFrame=t,this.channel.computeStats()}receiveClientFrame(t){if(t.byteLength<=5)return;const e=s.b.create(t);s.a.skip(e,1);const n=s.a.readInt(e);for(let t=0;e.offset<e.data.byteLength;t++){const r={};if(p.a.deserialize(r,e),r.frame=n-t,this.userCommands.setUserCommand(r)&&this.graphPanel){const t=n===r.frame?g.b.Received:g.b.Filled,e=n<=this.lastRequestedFrame?g.b.Late:t;this.graphPanel.setPacketStatus(r.frame,e)}}this.lastReceivedFrame=n}transmitServerFrame(t){this.snapshot.setSnapshot(t);const e=s.b.clear(this.msgBuf);s.a.writeByte(e,0),m.a.serialize(e,t),this.channel.send(e.data.subarray(0,e.offset),t.frame),this.lastTransmittedFrame=t.frame,this.channel.computeStats()}receiveServerFrame(t){if(t.byteLength>1){const e=s.b.create(t);s.a.skip(e,1);const n=new m.a;if(m.a.deserialize(e,n),this.snapshot.setSnapshot(n),this.lastReceivedFrame=n.frame,this.graphPanel){for(let t=this.lastRequestedFrame+1;t<n.frame;t++)this.snapshot.hasSnapshot(t)||this.graphPanel.setPacketStatus(t,g.b.Filled);const t=n.frame<=this.lastRequestedFrame?g.b.Late:g.b.Received;this.graphPanel.setPacketStatus(n.frame,t)}}}getSnapshot(t,e){return this.lastRequestedFrame=Math.ceil(t),this.snapshot.lerpSnapshot(t,e)}getUserCommand(t){this.lastRequestedFrame=t;let e=this.userCommands.getUserCommand(t);return Object(a.e)(e)||(console.warn(`Client ${this.id} missing input for frame ${t}`),e=this.userCommands.getUserCommand()),Object(a.c)(e)}onMessage(t,e){this.ping=this.channel.ping,Object(a.e)(e)&&(this.lastAcknowledgedFrame=e.tag),0===t[0]?this.receiveServerFrame(t):this.receiveClientFrame(t),this.fire(d.Message,t,e)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));for(var r=[],i=0;i<256;i++)r[i]=(i<16?"0":"")+i.toString(16);var s={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&e]+r[e>>8&255]+"-"+r[e>>16&15|64]+r[e>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*s.DEG2RAD},radToDeg:function(t){return t*s.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var s=Math.cos,o=Math.sin,a=s(n/2),c=o(n/2),u=s((e+r)/2),h=o((e+r)/2),l=s((e-r)/2),f=o((e-r)/2),d=s((r-e)/2),p=o((r-e)/2);"XYX"===i?t.set(a*h,c*l,c*f,a*u):"YZY"===i?t.set(c*f,a*h,c*l,a*u):"ZXZ"===i?t.set(c*l,c*f,a*h,a*u):"XZX"===i?t.set(a*h,c*p,c*d,a*u):"YXY"===i?t.set(c*d,a*h,c*p,a*u):"ZYZ"===i?t.set(c*p,c*d,a*h,a*u):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o}));var r=n(4),i=n(7);n.d(e,"a",(function(){return i.a}));var s=n(24);n.d(e,"b",(function(){return s.a}));class o extends r.a{constructor(t){super(),this.buffer=t}setBuffer(t){return this.buffer=t,this}set x(t){this.buffer&&(this.buffer[0]=t)}set y(t){this.buffer&&(this.buffer[1]=t)}set z(t){this.buffer&&(this.buffer[2]=t)}get x(){return this.buffer[0]}get y(){return this.buffer[1]}get z(){return this.buffer[2]}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return B})),n.d(e,"c",(function(){return R})),n.d(e,"d",(function(){return D}));var r=n(2),i=n(39),s=n(5);const o=r.c.create(),a=r.c.create();class c{constructor(){this.orientationTarget=r.c.create()}update(t,e,n){const o=this.getCameraRelativeMovementDirection(n,a),c=r.c.length(o)>.1,u=n.actions&i.a.Walk;let h=r.c.clone(t.orientation),l=!!(t.flags&S.IsUTurning),f=r.c.length(t.velocity);const d=u?600:3e3,p=u?150:600,m=(c?d:-d)*e,g=Object(s.c)(f+m,0,p);f+=Object(s.c)(g-f,-d*e,d*e);const y=r.c.scale(r.c.create(),t.orientation,f),v=r.c.scaleAndAdd(r.c.create(),t.pos,y,e);let b=c,w=3.75*Math.PI,x=1.875*Math.PI;Math.PI;l?r.c.dot(h,this.orientationTarget)>.99&&(l=!1):r.c.dot(o,this.orientationTarget)<-.99&&(l=!0,r.c.copy(this.orientationTarget,o));let _=f>0?x:w;if(l?(b=!0,_*=2,this.orientationTarget=this.orientationTarget):c&&r.c.copy(this.orientationTarget,o),b){const n=Math.atan2(t.orientation[0],t.orientation[2]),i=Math.atan2(this.orientationTarget[0],this.orientationTarget[2]);let o=Object(s.b)(n,i);const a=_*e,c=Object(s.c)(o,-a,a);r.c.rotateY(h,t.orientation,s.a,c)}let C=t.flags&~(S.IsWalking|S.IsUTurning);return u&&(C|=S.IsWalking),l&&(C|=S.IsUTurning),Object.assign(Object.assign({},t),{pos:v,velocity:y,orientation:h,flags:C})}getWorldRelativeMovementDirection(t,e){const n=t.horizontalAxis,i=t.verticalAxis;return r.c.normalize(e,r.c.set(e,n,0,i))}getCameraRelativeMovementDirection(t,e){const n=this.getWorldRelativeMovementDirection(t,e),i=r.c.normalize(o,r.c.set(o,t.headingX,0,t.headingZ));return r.c.set(e,n[0]*-i[2]+n[2]*i[0],0,n[0]*i[0]+n[2]*i[2])}}var u=n(1),h=n(0),l=n(13);class f{constructor(t,e,n,r){this.shader=n,this.name=e,this.layout=r,this.resources=t.createResourceTable(this.layout),this.bindings={}}destroy(t){t.removeResourceTable(this.resources)}assertReady(){for(const t of Object.keys(this.layout))Object(h.c)(this.bindings[t],`Material expects a binding for ${t}`)}getUniformBuffer(t){const e=this.bindings[t];return Object(h.c)(e,`Uniform buffer "${t}" is not bound to material "${this.name}"`),e}setUniformBuffer(t,e,n){const r=Object(h.c)(this.layout[e],"Invalid resource name");Object(h.b)(r.type===u.a.UniformBuffer,"Mismatching resource type"),this.bindings[e]=n,t.setBuffer(this.resources,r.index,n.getBufferView())}setTexture(t,e,n){const r=Object(h.c)(this.layout[e],"Invalid resource name");Object(h.b)(r.type===u.a.Texture,"Mismatching resource type"),Object(h.b)(!Object(h.e)(r.count),"Use Material.setTextureArray"),this.bindings[e]=n,t.setTexture(this.resources,r.index,n)}setTextureArray(t,e,n){const r=Object(h.c)(this.layout[e],"Invalid resource name");Object(h.b)(r.type===u.a.Texture,"Mismatching resource type"),Object(h.b)(Object(h.e)(r.count),"Use Material.setTextureArray"),this.bindings[e]=n,t.setTextures(this.resources,r.index,n)}}class d extends l.b{constructor(t,e,n,r){super(),this.renderList=e,this.mesh=n,this.material=r,this.pipeline=t.createRenderPipeline(r.shader,e.renderFormat,n.vertexLayout,r.layout),this.vertexTable=t.createVertexTable(this.pipeline),n.vertexBuffers.forEach((e,n)=>{t.setVertexBuffer(this.vertexTable,n,e)}),this._primitive={renderPipeline:this.pipeline,resourceTable:this.material.resources,vertexTable:this.vertexTable,elementCount:this.mesh.elementCount,type:this.mesh.primitiveType,indexBuffer:this.mesh.indexBuffer,indexType:this.mesh.indexType}}get primitive(){return this.material.assertReady(),this._primitive}destroy(t){t.removeVertexTable(this.vertexTable),t.removeRenderPipeline(this.pipeline)}}class p extends d{constructor(t,e,n,r){super(t,e,n,r)}bindSkeleton(t){this.skeleton=t}}var m=n(17),g=n(23);class y{constructor(){this.data=[]}initialize(t){this.avatars=t;for(let e=0;e<t.length;e++)this.data[e]={models:[],skinnedModels:[]}}onResourcesLoaded(t,e){for(let n=0;n<this.avatars.length;n++){const r=this.avatars[n];for(let i=0;i<r.nodes.length;i++){const s=r.nodes[i];if(Object(h.e)(s.skinId)){const i=Object(h.c)(s.meshId);Object(h.b)(0===s.skinId),this.loadSkinnedModel(e,t,s,i,r.skeleton,n)}else Object(h.e)(s.meshId)&&this.loadModel(e,t,s,s.meshId,n)}}}createMaterial(t,e,n){const i=n.materials[e.materialIndex],s=Object(h.c)(i.technique),o=s.shaderId,a=function(t){const e={},n=[];for(const r of Object.keys(t.uniforms)){const i=t.uniforms[r];i.type===u.m.Texture2D?n.push(r):e[r]=i}const r=Object(g.b)(e),i={uniforms:{index:0,type:u.a.UniformBuffer,layout:r}};for(let t=0;t<n.length;t++){i[n[t]]={index:t,type:u.a.Texture}}return i}(s),c=new f(t,i.name,o,a),l=a.uniforms.layout,d=new g.a(i.name,t,l);if(c.setUniformBuffer(t,"uniforms",d),s){const e=Object(h.c)(i.values);for(const r of Object.keys(s.uniforms)){const i=s.uniforms[r],o=Object(h.d)(e[r],i.value);if(Object(h.e)(o))if(i.type===u.m.Texture2D){const e=n.textures[o.index].id;c.setTexture(t,r,e)}else d.setFloats(r,o)}d.setVec4("u_Color0",r.d.fromValues(.4266,.4171,.5057,1))}else d.setVec4("u_color",r.d.fromValues(0,1,0,1));return c}loadSkinnedModel(t,e,n,r,i,s){const o=e.meshes[r];for(let r of o.primitives){const o=this.createMaterial(t,r,e),a=new p(t,m.a.opaque,r.mesh,o);a.bindSkeleton(i),this.data[s].skinnedModels.push(a),n.add(a)}}loadModel(t,e,n,r,i){const s=e.meshes[r];for(let r of s.primitives){const s=this.createMaterial(t,r,e),o=new d(t,m.a.opaque,r.mesh,s);this.data[i].models.push(o),n.add(o)}}render(t,e){for(let n=0;n<this.avatars.length;n++){if(!this.avatars[n].active)continue;const i=this.data[n];for(let n=0;n<i.skinnedModels.length;n++){const s=i.skinnedModels[n],o=s.material.getUniformBuffer("uniforms");o.getFloatArray("u_joints").set(s.skeleton.boneMatrices);const a=new Float32Array(s.matrixWorld.elements);Object(h.e)(o.getBufferLayout().u_modelViewProjection)&&o.setMat4("u_modelViewProjection",r.a.multiply(r.a.create(),e.viewProjMatrix,a)),Object(h.e)(o.getBufferLayout().u_modelViewProjection)&&o.setMat4("u_model",a),o.write(t),s.renderList.push(s.primitive)}for(let n=0;n<i.models.length;n++){const s=i.models[n],o=new Float32Array(s.matrixWorld.elements),a=s.material.getUniformBuffer("uniforms");a.setMat4("u_modelViewProjection",r.a.multiply(r.a.create(),e.viewProjMatrix,o)),a.write(t),s.renderList.push(s.primitive)}}}}var v=n(10),b=n(24);function w(){b.a.call(this),this.type="Bone"}w.prototype=Object.assign(Object.create(b.a.prototype),{constructor:w,isBone:!0});var x=n(7),_=new x.a,C=new x.a;function M(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new x.a)}}Object.assign(M.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new x.a;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,s=t.length;i<s;i++){var o=t[i]?t[i].matrixWorld:C;_.multiplyMatrices(o,e[i]),_.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new M(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});const k=[.25,.75],A=[.15,.65];class F{constructor(t){this.targetAvatar=t}onResourcesLoaded(t,e){this.debugMenu=e.addFolder("Animation"),this.debugAnimationMixer=new v.b(this.targetAvatar);const n={that:this,togglePaused:()=>{this.debugAnimation&&(this.debugAnimation.paused=!this.debugAnimation.paused)},stop:()=>{this.debugAnimation&&(this.debugAnimation.stop(),this.debugAnimation=void 0)},get time(){if(Object(h.e)(this.that.debugAnimation)){return this.that.debugAnimation.time/this.that.debugAnimation.getClip().duration}return 0},set time(t){Object(h.e)(this.that.debugAnimation)&&(this.that.debugAnimation.paused=!0,this.that.debugAnimation.time=t*this.that.debugAnimation.getClip().duration)}};this.debugMenu.add(n,"togglePaused"),this.debugMenu.add(n,"stop"),this.debugMenu.add(n,"time",0,1,.01);const r={};for(const e of t)r[e.name]=()=>{this.debugAnimationMixer.stopAllAction(),this.debugAnimation=this.debugAnimationMixer.clipAction(e).reset().play()},this.debugMenu.add(r,e.name)}update(t){return this.debugAnimation&&this.debugAnimationMixer.update(t),this.targetAvatar.updateMatrixWorld(),this.targetAvatar.skeleton.update(),this.debugAnimation}}class O{constructor(){this.data=[],this.ready=!1}initialize(t){this.avatars=t,this.debugMenu=new F(this.avatars[0])}onResourcesLoaded(t,e){const n=Object(h.c)(t.animations.find(t=>"await1"===t.name)),r=Object(h.c)(t.animations.find(t=>"awalk1"===t.name)),i=Object(h.c)(t.animations.find(t=>"brun1"===t.name));for(let t=0;t<this.avatars.length;t++){const e=this.avatars[t];this.data[t]={aIdle:e.animationMixer.clipAction(n),aWalk:e.animationMixer.clipAction(r),aRun:e.animationMixer.clipAction(i),startingFoot:0};const s=this.data[t];s.aIdle.play().setEffectiveWeight(1),s.aWalk.play().setEffectiveWeight(0),s.aRun.play().setEffectiveWeight(0),s.aIdle.time=t*(s.aIdle.getClip().duration/(this.avatars.length+1)),s.aWalk.time=k[s.startingFoot]*s.aWalk.getClip().duration,s.aRun.time=A[s.startingFoot]*s.aRun.getClip().duration}this.debugMenu.onResourcesLoaded(t.animations,e),this.ready=!0}update(t,e){if(this.ready)for(let n=0;n<t.length;n++){const i=this.data[n],o=this.avatars[n],a=t[n];if(!o.active)continue;if(o.local){if(this.debugMenu.update(e))continue}const c=r.c.length(a.velocity),u=a.flags&S.IsWalking;a.flags,S.IsUTurning;i.aIdle.weight=Object(s.e)(1-c/150),i.aRun.weight=Object(s.e)(Object(s.d)(u?150:0,600,c)),i.aRun.timeScale=i.aRun.weight,i.aWalk.weight=Object(s.e)(Object(s.d)(0,150,c))-i.aRun.weight,i.aWalk.timeScale=i.aWalk.weight,c<=0&&(i.aWalk.time=k[i.startingFoot]*i.aWalk.getClip().duration,i.aRun.time=A[i.startingFoot]*i.aRun.getClip().duration,i.startingFoot=(i.startingFoot+1)%2),o.animationMixer.update(e),o.updateMatrixWorld(),o.skeleton.update()}}}var S,T=n(9),E=n(11),j=n(3);class I extends l.b{constructor(){super(...arguments),this.active=!1,this.local=!1}}!function(t){t[t.IsActive=1]="IsActive",t[t.IsWalking=2]="IsWalking",t[t.IsUTurning=4]="IsUTurning"}(S||(S={}));class B{constructor(t=!1){this.pos=r.c.create(),this.velocity=r.c.create(),this.orientation=r.c.fromValues(0,0,1),this.flags=0,this.flags=t?S.IsActive:0}static lerp(t,e,n,i){t.clientId=n.clientId,r.c.lerp(t.pos,e.pos,n.pos,i),r.c.lerp(t.velocity,e.velocity,n.velocity,i),r.c.lerp(t.orientation,e.orientation,n.orientation,i),t.flags=e.flags&n.flags}static copy(t,e){t.clientId=e.clientId,r.c.copy(t.pos,e.pos),r.c.copy(t.velocity,e.velocity),r.c.copy(t.orientation,e.orientation),t.flags=e.flags}static serialize(t,e){j.a.writeString(t,e.clientId||""),j.a.writeFloat(t,e.pos[0]),j.a.writeFloat(t,e.pos[1]),j.a.writeFloat(t,e.pos[2]),j.a.writeFloat(t,e.velocity[0]),j.a.writeFloat(t,e.velocity[1]),j.a.writeFloat(t,e.velocity[2]),j.a.writeFloat(t,e.orientation[0]),j.a.writeFloat(t,e.orientation[1]),j.a.writeFloat(t,e.orientation[2]),j.a.writeByte(t,e.flags)}static deserialize(t,e){const n=j.a.readString(t);e.clientId=""===n?void 0:n,e.pos[0]=j.a.readFloat(t),e.pos[1]=j.a.readFloat(t),e.pos[2]=j.a.readFloat(t),e.velocity[0]=j.a.readFloat(t),e.velocity[1]=j.a.readFloat(t),e.velocity[2]=j.a.readFloat(t),e.orientation[0]=j.a.readFloat(t),e.orientation[1]=j.a.readFloat(t),e.orientation[2]=j.a.readFloat(t),e.flags=j.a.readByte(t)}}class R{constructor(){this.avatars=[],this.controllers=[],this.animation=new O,this.renderer=new y;for(let t=0;t<T.a.kAvatarCount;t++)this.avatars[t]=new I,this.controllers[t]=new c;this.localAvatar=this.avatars[0]}initialize(t){t.resources.load("data/Tn.glb","gltf",(e,n)=>{if(e)return console.error("Failed to load resource",e);this.gltf=n,this.onResourcesLoaded(t)}),this.animation.initialize(this.avatars),this.renderer.initialize(this.avatars)}onResourcesLoaded(t){var e;for(const t of this.avatars){t.nodes=this.gltf.nodes.map(t=>t.clone(!1));for(let e=0;e<t.nodes.length;e++){const n=this.gltf.nodes[e],r=t.nodes[e];for(const e of n.children){const n=this.gltf.nodes.indexOf(e);r.add(t.nodes[n])}}for(const e of this.gltf.rootNodeIds.slice(0,1))t.add(t.nodes[e]);const n=Object(h.c)(this.gltf.skins[0]),r=n.joints.map(e=>t.nodes[e]),i=null===(e=n.inverseBindMatrices)||void 0===e?void 0:e.map(t=>(new l.a).fromArray(t));t.skeleton=new M(r,i),t.animationMixer=new v.b(t)}this.animation.onResourcesLoaded(this.gltf,t.debugMenu),this.renderer.onResourcesLoaded(this.gltf,t.gfxDevice)}update(t){const e=t.displaySnapshot.avatars;for(let t=0;t<T.a.kAvatarCount;t++){const n=this.avatars[t],r=e[t];window.client.net.client.state===E.c.Connected&&r.clientId===window.client.net.client.id&&(this.localAvatar=n),n.active=!!(r.flags&S.IsActive);const i=new l.c(r.pos);n.position.copy(i),n.lookAt(r.pos[0]+r.orientation[0],r.pos[1]+r.orientation[1],r.pos[2]+r.orientation[2]),n.updateMatrix(),n.updateMatrixWorld()}this.animation.update(e,t.clock.renderDt/1e3)}updateFixed(t){}render(t){this.renderer.render(t.gfxDevice,t.camera)}}class D{constructor(){this.states=[],this.avatars=[],this.controllers=[],this.animation=new O;for(let t=0;t<T.a.kAvatarCount;t++)this.states[t]=new B,this.avatars[t]=new I,this.controllers[t]=new c}initialize(t){t.resources.load("data/Tn.glb","gltf",(e,n)=>{if(e)return console.error("Failed to load resource",e);this.gltf=n,this.onResourcesLoaded(t)}),this.animation.initialize(this.avatars)}onResourcesLoaded(t){var e;for(const t of this.avatars){t.nodes=this.gltf.nodes.map(t=>t.clone(!1));for(let e=0;e<t.nodes.length;e++){const n=this.gltf.nodes[e],r=t.nodes[e];for(const e of n.children){const n=this.gltf.nodes.indexOf(e);r.add(t.nodes[n])}}for(const e of this.gltf.rootNodeIds.slice(0,1))t.add(t.nodes[e]);const n=Object(h.c)(this.gltf.skins[0]),r=n.joints.map(e=>t.nodes[e]),i=null===(e=n.inverseBindMatrices)||void 0===e?void 0:e.map(t=>(new l.a).fromArray(t));t.skeleton=new M(r,i),t.animationMixer=new v.b(t)}this.animation.onResourcesLoaded(this.gltf,t.debugMenu)}update(t){}updateFixed(t){for(let e=0;e<T.a.kAvatarCount;e++){const n=this.states[e];this.avatars[e];if(!(n.flags&S.IsActive))continue;const r=t.net.clients.find(t=>t.id===n.clientId);if(r){const i=r.getUserCommand(t.clock.simFrame),s=t.clock.simDt/1e3;this.states[e]=this.controllers[e].update(n,s,i)}}}addAvatar(t){const e=Object(h.c)(this.states.find(t=>!(t.flags&S.IsActive)),"Out of avatars");e.flags|=S.IsActive,e.clientId=t}getSnapshot(){return this.states}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}));var r,i=n(0);!function(t){t[t.Missing=0]="Missing",t[t.Received=1]="Received",t[t.Filled=2]="Filled",t[t.Late=3]="Late"}(r||(r={}));class s{constructor(){const t=document.createElement("div");t.style.cssText="position:fixed;top:0;left:0;opacity:0.9;z-index:10000;pointer-events:none",this.dom=t}removePanel(t){this.dom.removeChild(t.dom)}addPanel(t){const e=Math.round(window.devicePixelRatio||1),n=10*e,s=3*e,o=15*e,a=3*e,c=2*e,u=10*e,h=1*e,l=64*n,f=30*e,d=2*s+l,p=48*e,m=document.createElement("canvas");m.height=p,m.width=d,m.style.cssText=`height:${Math.round(p/e)}px;width:${Math.round(d/e)}px`;const g=Object(i.c)(m.getContext("2d"));g.font="bold "+9*e+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle="#222",g.fillRect(0,0,d,p),g.fillStyle="#EEE",g.fillText(t,a,c);const y=a+g.measureText(t).width;this.dom.appendChild(m);let v=0,b=void 0;return{dom:m,setPacketStatus(t,e){if(t<v-32||t>=v+32)return;const i=s+(t-v+32)*n;switch(e){case r.Missing:g.fillStyle="blue";break;case r.Received:g.fillStyle="green";break;case r.Filled:g.fillStyle="yellow";break;case r.Late:g.fillStyle="purple";break;default:g.fillStyle="red"}g.fillRect(i,o,n,f),g.strokeStyle="white",g.strokeRect(i,o,n,f)},update(t,e,p,w){const x=Math.floor(e/16),_=Object(i.e)(p)?p/16:void 0,C=Object(i.e)(w)?w/16:void 0,M=x-v,k=M*n;if(g.drawImage(m,s+k,o,l-k,f,s,o,l-k,f),g.fillStyle="#222",g.fillRect(y,c,d-y,u),Object(i.e)(t)){const e=t.toFixed(1).padStart(5);g.fillStyle="#EEE",g.textAlign="right",g.fillText(`Ping: ${e}`,d-a,c)}g.fillStyle="red";const A=s+32*n;if(g.fillRect(A,c,h,u),Object(i.e)(_)){g.fillStyle="purple";const t=s+(_-x+32)*n;g.fillRect(t,c,h,u)}if(Object(i.e)(C)){g.fillStyle="yellow";const t=s+(C-x+32)*n;g.fillRect(t,c,h,u)}v=x,b=_,g.fillStyle="blue";for(let t=0;t<M;t++)this.setPacketStatus(x+32-1-t,r.Missing)}}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return c}));var r,i=n(6),s=n(25),o=n(0);!function(t){t.Open="open",t.Close="close",t.Message="message"}(r||(r={}));class a extends i.a{constructor(t){super(),this.signalSocket=t}async listen(t){this.signalSocket.on(s.b.Message,this.onMessage.bind(this,t)),this.iceServers=await this.signalSocket.requestIceServers()}async onMessage(t,e,n){console.debug("WebUDP: Received message",e),Object(o.c)(e.offer,"Expected an offer");const r=new c;r.accept(this.signalSocket,e,n),t(r)}}class c extends i.a{constructor(){super(...arguments),this.isOpen=!1,this.unloadCallback=()=>this.close()}connect(t){Object(o.b)(!Object(o.e)(this.peer),"WebUdpSocket.connect/listen() may only be called once"),this.peerId=t;const e=new s.a,n=e.connect().then(()=>{this.clientId=e.clientId});return n.then(async()=>{const t=await e.requestIceServers();this.createPeer(t),this.peer.onconnectionstatechange=()=>{switch(this.peer.connectionState){case"connected":case"disconnected":break;case"failed":case"closed":this.close()}};const n=this.getIceCandidates(),r=this.peer.createDataChannel("webudp",{ordered:!1,maxRetransmits:0});this.setDataChannel(r);const i=await this.peer.createOffer();await this.peer.setLocalDescription(i);const a={offer:i,iceCandidates:await n};e.send(this.peerId,a),e.once(s.b.Message,(t,n)=>{Object(o.c)(t.answer,'Expected "answer" message from remote peer');console.debug("WebUDP: Received answer",t.answer),this.peer.setRemoteDescription(t.answer);for(const e of t.iceCandidates)this.peer.addIceCandidate(e);e.close()})}),n}async accept(t,e,n){Object(o.b)(!Object(o.e)(this.peer),"WebUdpSocket.connect/listen() may only be called once"),this.peerId=n,this.clientId=t.clientId;const r=await t.requestIceServers();this.createPeer(r);const i=this.getIceCandidates();await this.peer.setRemoteDescription(e.offer);const s=await this.peer.createAnswer();this.peer.setLocalDescription(s);for(const t of e.iceCandidates)this.peer.addIceCandidate(t);const a=await i;t.send(this.peerId,{answer:s,iceCandidates:a}),this.peer.ondatachannel=t=>{this.setDataChannel(t.channel)}}send(t){return!!this.isOpen&&(this.channel.send(t),!0)}close(){Object(o.e)(this.peer)&&(this.fire(r.Close),this.isOpen=!1,this.channel&&this.channel.close(),this.peer.close(),window.removeEventListener("beforeunload",this.unloadCallback),delete this.peer)}createPeer(t){this.peer=new RTCPeerConnection(t),window.addEventListener("beforeunload",this.unloadCallback)}onDataChannelOpen(){console.debug("WebUDP: DataChannel open"),this.isOpen=!0,this.fire(r.Open)}onDataChannelClosed(){console.debug("WebUDP: DataChannel closed"),this.close()}onDataChannelError(t){console.error("WebUdpPeer: Data channel error",t)}setDataChannel(t){t.binaryType="arraybuffer",t.onopen=this.onDataChannelOpen.bind(this),t.onclose=this.onDataChannelClosed.bind(this),t.onerror=this.onDataChannelError.bind(this),t.onmessage=t=>{this.fire(r.Message,t)},this.channel=t}getIceCandidates(){return new Promise(t=>{const e=[];this.peer.onicecandidate=n=>{n.candidate?(console.debug("WebUDP: Received ICE candidate",n.candidate),e.push(n.candidate)):(console.debug("WebUDP: Received all ICE candidates"),t(e))}})}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));const r={opaque:new class{constructor(t,e,n){this.defaultCullMode=t,this.defaultDepthState=e,this.renderFormat=n,this.primitives=[]}push(t){this.primitives.push(t)}}(n(1).e.Back,{depthWriteEnabled:!0,depthTestEnabled:!0},{blendingEnabled:!1})}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));const r="c126c7a9d13fe86ee210341626e2e27428b662dd",i=(r.slice(0,8),`https://github.com/themikelester/MoonDuel/tree/${r}`),s=!1},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a}));var r=n(0),i=n(3);class s{static serialize(t,e){const n=Math.atan2(e.headingZ,e.headingX);i.a.writeAngle16(t,n);let r=0;return r|=3&Math.sign(e.verticalAxis)+1<<0,r|=12&Math.sign(e.horizontalAxis)+1<<2,r|=240&Math.sign(e.actions)<<4,i.a.writeByte(t,r),3}static deserialize(t,e){const n=i.a.readAngle16(e);t.headingX=Math.cos(n),t.headingZ=Math.sin(n);let r=i.a.readByte(e);return t.verticalAxis=((3&r)>>0)-1,t.horizontalAxis=((12&r)>>2)-1,t.actions=(240&r)>>4,3}}const o={frame:-1,headingX:0,headingZ:1,verticalAxis:0,horizontalAxis:0,actions:0};new TextEncoder,new TextDecoder;class a{constructor(){this.buffer=[],this.bufferSize=64,this.lastFrame=-1}setUserCommand(t){Object(r.b)(Number.isInteger(t.frame));const e=this.buffer[t.frame%this.bufferSize];return(!Object(r.e)(e)||e.frame!==t.frame)&&(this.buffer[t.frame%this.bufferSize]=t,this.lastFrame=t.frame,!0)}getUserCommand(t=this.lastFrame){if(Object(r.b)(Number.isInteger(t)),-1===t)return Object.assign(Object.assign({},o),{frame:t});const e=this.buffer[t%this.bufferSize];return Object(r.e)(e)&&e.frame===t?e:void 0}}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e);return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,n){var r,i=n(75),s=n(48),o=n(77),a=n(78),c=n(79);"undefined"!=typeof ArrayBuffer&&(r=n(80));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),h="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||h;e.protocol=3;var f=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=i(f),p={type:"error",data:"parser error"},m=n(81);function g(t,e,n){for(var r=new Array(t.length),i=a(t.length,n),s=function(t,n,i){e(n,(function(e,n){r[t]=n,i(e,r)}))},o=0;o<t.length;o++)s(o,t[o],i)}e.encodePacket=function(t,n,r,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof r&&(i=r,r=null);var s=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=t.data,s=new Uint8Array(i),o=new Uint8Array(1+i.byteLength);o[0]=f[t.type];for(var a=0;a<s.length;a++)o[a+1]=s[a];return r(o.buffer)}(t,n,i);if(void 0!==m&&s instanceof m)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);if(l)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=new FileReader;return i.onload=function(){e.encodePacket({type:t.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(t.data)}(t,n,r);var i=new Uint8Array(1);i[0]=f[t.type];var s=new m([i.buffer,t.data]);return r(s)}(t,n,i);if(s&&s.base64)return function(t,n){var r="b"+e.packets[t.type]+t.data.data;return n(r)}(t,i);var o=f[t.type];return void 0!==t.data&&(o+=r?c.encode(String(t.data),{strict:!1}):String(t.data)),i(""+o)},e.encodeBase64Packet=function(t,n){var r,i="b"+e.packets[t.type];if(void 0!==m&&t.data instanceof m){var s=new FileReader;return s.onload=function(){var t=s.result.split(",")[1];n(i+t)},s.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var o=new Uint8Array(t.data),a=new Array(o.length),c=0;c<o.length;c++)a[c]=o[c];r=String.fromCharCode.apply(null,a)}return i+=btoa(r),n(i)},e.decodePacket=function(t,n,r){if(void 0===t)return p;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),n);if(r&&!1===(t=function(t){try{t=c.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return p;var i=t.charAt(0);return Number(i)==i&&d[i]?t.length>1?{type:d[i],data:t.substring(1)}:{type:d[i]}:p}i=new Uint8Array(t)[0];var s=o(t,1);return m&&"blob"===n&&(s=new m([s])),{type:d[i],data:s}},e.decodeBase64Packet=function(t,e){var n=d[t.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:t.substr(1)}};var i=r.decode(t.substr(1));return"blob"===e&&m&&(i=new m([i])),{type:n,data:i}},e.encodePayload=function(t,n,r){"function"==typeof n&&(r=n,n=null);var i=s(t);if(n&&i)return m&&!l?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r);if(!t.length)return r("0:");g(t,(function(t,r){e.encodePacket(t,!!i&&n,!1,(function(t){r(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return r(e.join(""))}))},e.decodePayload=function(t,n,r){if("string"!=typeof t)return e.decodePayloadAsBinary(t,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===t)return r(p,0,1);for(var s,o,a="",c=0,u=t.length;c<u;c++){var h=t.charAt(c);if(":"===h){if(""===a||a!=(s=Number(a)))return r(p,0,1);if(a!=(o=t.substr(c+1,s)).length)return r(p,0,1);if(o.length){if(i=e.decodePacket(o,n,!1),p.type===i.type&&p.data===i.data)return r(p,0,1);if(!1===r(i,c+s,u))return}c+=s,a=""}else a+=h}return""!==a?r(p,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,n){if(!t.length)return n(new ArrayBuffer(0));g(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){return n(null,t)}))}),(function(t,e){var r=e.reduce((function(t,e){var n;return t+(n="string"==typeof e?e.length:e.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),s=0;return e.forEach((function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);n=r.buffer}i[s++]=e?0:1;var a=n.byteLength.toString();for(o=0;o<a.length;o++)i[s++]=parseInt(a[o]);i[s++]=255;for(r=new Uint8Array(n),o=0;o<r.length;o++)i[s++]=r[o]})),n(i.buffer)}))},e.encodePayloadAsBlob=function(t,n){g(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);t=r.buffer,e[0]=0}var s=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),o=new Uint8Array(s.length+1);for(i=0;i<s.length;i++)o[i]=parseInt(s[i]);if(o[s.length]=255,m){var a=new m([e.buffer,o.buffer,t]);n(null,a)}}))}),(function(t,e){return n(new m(e))}))},e.decodePayloadAsBinary=function(t,n,r){"function"==typeof n&&(r=n,n=null);for(var i=t,s=[];i.byteLength>0;){for(var a=new Uint8Array(i),c=0===a[0],u="",h=1;255!==a[h];h++){if(u.length>310)return r(p,0,1);u+=a[h]}i=o(i,2+u.length),u=parseInt(u);var l=o(i,0,u);if(c)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(t){var f=new Uint8Array(l);l="";for(h=0;h<f.length;h++)l+=String.fromCharCode(f[h])}s.push(l),i=o(i,u)}var d=s.length;s.forEach((function(t,i){r(e.decodePacket(t,n,!0),i,d)}))}},function(t,e,n){
/*!
* screenfull
* v5.0.2 - 2020-02-13
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var e="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=t.exports,r=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,s={};r<i;r++)if((t=n[r])&&t[1]in e){for(r=0;r<t.length;r++)s[n[0][r]]=t[r];return s}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},s={request:function(t){return new Promise(function(n,i){var s=function(){this.off("change",s),n()}.bind(this);this.on("change",s);var o=(t=t||e.documentElement)[r.requestFullscreen]();o instanceof Promise&&o.then(s).catch(i)}.bind(this))},exit:function(){return new Promise(function(t,n){if(this.isFullscreen){var i=function(){this.off("change",i),t()}.bind(this);this.on("change",i);var s=e[r.exitFullscreen]();s instanceof Promise&&s.then(i).catch(n)}else t()}.bind(this))},toggle:function(t){return this.isFullscreen?this.exit():this.request(t)},onchange:function(t){this.on("change",t)},onerror:function(t){this.on("error",t)},on:function(t,n){var r=i[t];r&&e.addEventListener(r,n,!1)},off:function(t,n){var r=i[t];r&&e.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(e[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(e[r.fullscreenEnabled])}}}),n?t.exports=s:window.screenfull=s):n?t.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return o}));var r=n(1),i=n(0);function s(t){const e={};let n=0;const s=Object.keys(t);for(let o=0;o<s.length;o++){const a=t[s[o]];e[s[o]]=Object.assign(Object.assign({},a),{offset:n}),n+=r.l(a.type)*Object(i.d)(a.count,1)}return e}class o{constructor(t,e,n){this.bufferSize=0,this.bufferLayout=n;const i=Object.keys(this.bufferLayout);let s=this.bufferLayout[i[0]];for(let t=1;t<i.length;t++){const e=this.bufferLayout[i[t]];e.offset>s.offset&&(s=e)}this.bufferSize=s.offset+a(s),this.bufferData=new ArrayBuffer(this.bufferSize),this.bufferBytes=new Uint8Array(this.bufferData),this.bufferFloats=new Float32Array(this.bufferData),this.buffer=e.createBuffer(t,r.c.Uniform,r.n.Dynamic,this.bufferSize)}getBufferView(){return{buffer:this.buffer,byteOffset:0}}getBufferLayout(){return this.bufferLayout}setFloat(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);this.bufferFloats[n.offset/4]=e}setVec2(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);this.bufferFloats.set(e,n.offset/4)}setVec3(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);this.bufferFloats.set(e,n.offset/4)}setVec4(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);this.bufferFloats.set(e,n.offset/4)}setMat4(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);this.bufferFloats.set(e,n.offset/4)}setBytes(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);if(e.length!==a(n))throw new Error("Invalid size");this.bufferBytes.set(e,n.offset)}setFloats(t,e){const n=Object(i.c)(this.bufferLayout[t],`Attempted to set unknown uniform ${t}`);if(e.length!==a(n)/4)throw new Error("Invalid size");this.bufferFloats.set(e,n.offset/4)}getFloatArray(t){const e=this.bufferLayout[t];if(!e)throw new Error(`Attempted to set unknown uniform ${t}`);return new Float32Array(this.bufferData,e.offset,a(e)/4)}write(t){t.writeBufferData(this.buffer,0,this.bufferBytes)}terminate(t){t.removeBuffer(this.buffer)}}function a(t){return r.l(t.type)*Object(i.d)(t.count,1)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return A}));var r=n(8),i=n(4),s=n(7),o=n(31),a=n(12),c=new s.a,u=new r.a;function h(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||h.DefaultOrder}function l(){this.mask=1}function f(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}h.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],h.DefaultOrder="XYZ",Object.defineProperties(h.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(h.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=a.a.clamp,i=t.elements,s=i[0],o=i[4],c=i[8],u=i[1],h=i[5],l=i[9],f=i[2],d=i[6],p=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-f,s),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(u,s))):"ZYX"===e?(this._y=Math.asin(-r(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-o,h))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(c,p))):"XZY"===e?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,h),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-l,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return c.makeRotationFromQuaternion(t),this.setFromRotationMatrix(c,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return u.setFromEuler(this),this.setFromQuaternion(u,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new i.a(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(l.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(f.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,s,o,a,c){var u=this.elements;return u[0]=t,u[1]=r,u[2]=o,u[3]=e,u[4]=i,u[5]=a,u[6]=n,u[7]=s,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[3],a=n[6],c=n[1],u=n[4],h=n[7],l=n[2],f=n[5],d=n[8],p=r[0],m=r[3],g=r[6],y=r[1],v=r[4],b=r[7],w=r[2],x=r[5],_=r[8];return i[0]=s*p+o*y+a*w,i[3]=s*m+o*v+a*x,i[6]=s*g+o*b+a*_,i[1]=c*p+u*y+h*w,i[4]=c*m+u*v+h*x,i[7]=c*g+u*b+h*_,i[2]=l*p+f*y+d*w,i[5]=l*m+f*v+d*x,i[8]=l*g+f*b+d*_,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],c=t[7],u=t[8];return e*s*u-e*o*c-n*i*u+n*o*a+r*i*c-r*s*a},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],s=n[1],o=n[2],a=n[3],c=n[4],u=n[5],h=n[6],l=n[7],f=n[8],d=f*c-u*l,p=u*h-f*a,m=l*a-c*h,g=i*d+s*p+o*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);var y=1/g;return r[0]=d*y,r[1]=(o*l-f*s)*y,r[2]=(u*s-o*c)*y,r[3]=p*y,r[4]=(f*i-o*h)*y,r[5]=(o*a-u*i)*y,r[6]=m*y,r[7]=(s*h-l*i)*y,r[8]=(c*i-s*a)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,s,o){var a=Math.cos(i),c=Math.sin(i);this.set(n*a,n*c,-n*(a*s+c*o)+s+t,-r*c,r*a,-r*(-c*s+a*o)+o+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],s=r[3],o=r[6],a=r[1],c=r[4],u=r[7];return r[0]=e*i+n*a,r[3]=e*s+n*c,r[6]=e*o+n*u,r[1]=-n*i+e*a,r[4]=-n*s+e*c,r[7]=-n*o+e*u,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var d=0,p=new i.a,m=new r.a,g=new s.a,y=new i.a,v=new i.a,b=new i.a,w=new r.a,x=new i.a(1,0,0),_=new i.a(0,1,0),C=new i.a(0,0,1),M={type:"added"},k={type:"removed"};function A(){Object.defineProperty(this,"id",{value:d++}),this.uuid=a.a.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=A.DefaultUp.clone();var t=new i.a,e=new h,n=new r.a,o=new i.a(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new s.a},normalMatrix:{value:new f}}),this.matrix=new s.a,this.matrixWorld=new s.a,this.matrixAutoUpdate=A.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new l,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}A.DefaultUp=new i.a(0,1,0),A.DefaultMatrixAutoUpdate=!0,A.prototype=Object.assign(Object.create(o.a.prototype),{constructor:A,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return m.setFromAxisAngle(t,e),this.quaternion.multiply(m),this},rotateOnWorldAxis:function(t,e){return m.setFromAxisAngle(t,e),this.quaternion.premultiply(m),this},rotateX:function(t){return this.rotateOnAxis(x,t)},rotateY:function(t){return this.rotateOnAxis(_,t)},rotateZ:function(t){return this.rotateOnAxis(C,t)},translateOnAxis:function(t,e){return p.copy(t).applyQuaternion(this.quaternion),this.position.add(p.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(x,t)},translateY:function(t){return this.translateOnAxis(_,t)},translateZ:function(t){return this.translateOnAxis(C,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(g.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?y.copy(t):y.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),v.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?g.lookAt(v,y,this.up):g.lookAt(y,v,this.up),this.quaternion.setFromRotationMatrix(g),r&&(g.extractRotation(r.matrixWorld),m.setFromRotationMatrix(g),this.quaternion.premultiply(m.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(M)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(k)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),g.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),g.multiply(t.parent.matrixWorld)),t.applyMatrix4(g),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new i.a),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new r.a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(v,t,b),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new i.a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(v,w,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new i.a),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes){var o=s.shapes;if(Array.isArray(o))for(var a=0,c=o.length;a<c;a++){var u=o[a];i(t.shapes,u)}else i(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var h=[];for(a=0,c=this.material.length;a<c;a++)h.push(i(t.materials,this.material[a]));r.material=h}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(t).object)}if(e){var l=m(t.geometries),f=m(t.materials),d=m(t.textures),p=m(t.images);o=m(t.shapes);l.length>0&&(n.geometries=l),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}})},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));var r,i=n(54),s=n(6),o=n(0);!function(t){t.JoinedRoom="joined",t.ClientJoined="clientjoin",t.Message="message",t.RoomMessage="roomMessage"}(r||(r={}));class a extends s.a{constructor(){super(...arguments),this.connected=!1}connect(t=window.config.kSignalServerAddress){return Object(o.b)(!this.connected),new Promise(e=>{this.socket=i.connect(t),this.socket.on("connect",()=>{this.connected=!0,console.debug("SignalSocket: Connected to MoonBeacon with ID:",this.socket.id)}),this.socket.on("roomJoined",t=>{console.debug("SignalSocket: Joined room:",t),this.room=t,e()}),this.socket.on("clientJoined",t=>{console.debug("SignalSocket: Client joined:",t),this.room.clients[t.id]=t,this.fire(r.ClientJoined,t.id)}),this.socket.on("clientLeaving",(t,e)=>{console.debug("SignalSocket: Client left:",t),delete this.room.clients[t]}),this.socket.on("message",t=>{console.debug("SignalSocket: Message received",t),this.fire(r.Message,t.data,t.from)}),this.socket.on("messageRoom",t=>{this.fire(r.RoomMessage,t.data,t.from)})})}send(t,e){const n={from:this.clientId,to:t,data:e};console.debug("SignalSocket: Sending message",n),this.socket.emit("message",n)}broadcast(t){const e={from:this.clientId,data:t};this.socket.emit("messageRoom",e)}requestIceServers(){return new Promise((t,e)=>{this.socket.emit("iceServers",e=>{t({iceServers:e})})})}close(){this.socket.close()}get clients(){return Object.keys(this.room.clients)}get serverId(){return this.room.server}get clientId(){return this.socket.id}}},function(t,e,n){(function(r){e.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(i=r))}),e.splice(i,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(62)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(32))},function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var s=n[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}},function(t,e){t.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(r){e.log=function(...t){return"object"==typeof console&&console.log&&console.log(...t)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(r++,"%c"===t&&(i=r))}),e.splice(i,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(82)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(32))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);class i{constructor(){this._add=[],this._addOnChange=[],this._folders={}}add(t,e,n,r,i){const s={args:arguments};return this._add.push(s),{onChange:t=>{s.onChange=t}}}addFolder(t){return this._folders[t]=new i,this._folders[t]}async show(){var t;if(void 0===this._gui){const t=await n.e(2).then(n.bind(null,91));this._gui=new t.GUI({load:this._saveObject})}(null===(t=this._saveObject)||void 0===t?void 0:t.closed)&&this._gui.close();for(const t of this._add){this._gui.getRoot().remember(t.args[0]);const e=this._gui.add.apply(this._gui,t.args);t.onChange&&e.onChange(t.onChange)}for(const t in this._folders)this._folders[t]._gui=this._gui.addFolder(t),this._folders[t].show();this.add=this._gui.add.bind(this._gui),this.addFolder=this._gui.addFolder.bind(this._gui),this.show=this._gui.show.bind(this._gui),this.hide=this._gui.hide.bind(this._gui)}hide(){}update(){if(this._gui&&!this._gui.closed){for(var t in this._gui.__controllers)this._gui.__controllers[t].updateDisplay();for(const t in this._gui.__folders){const e=this._gui.__folders[t];for(const t of e.__controllers)t.updateDisplay()}}}toJSON(){return this._gui?this._gui.getSaveObject():void 0}fromJSON(t){Object(r.b)(!Object(r.e)(this._gui),"State must be loaded before the DebugMenu is shown"),this._saveObject=t}}},function(t,e,n){"use strict";function r(){}n.d(e,"a",(function(){return r})),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}})},function(t,e){var n,r,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var c,u=[],h=!1,l=-1;function f(){h&&c&&(h=!1,c.length?u=c.concat(u):l=-1,u.length&&d())}function d(){if(!h){var t=a(f);h=!0;for(var e=u.length;e;){for(c=u,u=[];++l<e;)c&&c[l].run();l=-1,e=u.length}c=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new p(t,e)),1!==u.length||h||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var r=n(64)("socket.io-parser"),i=n(20),s=n(67),o=n(42),a=n(43);function c(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=c,e.Decoder=l;var u=e.ERROR+'"encode error"';function h(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var i=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===i)return u;n+=i}return r("encoded %j as %s",t,n),n}function l(){this.reconstructor=null}function f(t){this.reconPack=t,this.buffers=[]}function d(t){return{type:e.ERROR,data:"parser error: "+t}}c.prototype.encode=function(t,n){(r("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){s.removeBlobs(t,(function(t){var n=s.deconstructPacket(t),r=h(n.packet),i=n.buffers;i.unshift(r),e(i)}))}(t,n):n([h(t)])},i(l.prototype),l.prototype.add=function(t){var n;if("string"==typeof t)n=function(t){var n=0,i={type:Number(t.charAt(0))};if(null==e.types[i.type])return d("unknown packet type "+i.type);if(e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type){for(var s="";"-"!==t.charAt(++n)&&(s+=t.charAt(n),n!=t.length););if(s!=Number(s)||"-"!==t.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(s)}if("/"===t.charAt(n+1))for(i.nsp="";++n;){if(","===(c=t.charAt(n)))break;if(i.nsp+=c,n===t.length)break}else i.nsp="/";var a=t.charAt(n+1);if(""!==a&&Number(a)==a){for(i.id="";++n;){var c;if(null==(c=t.charAt(n))||Number(c)!=c){--n;break}if(i.id+=t.charAt(n),n===t.length)break}i.id=Number(i.id)}if(t.charAt(++n)){var u=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(n));if(!(!1!==u&&(i.type===e.ERROR||o(u))))return d("invalid payload");i.data=u}return r("decoded %s as %j",t,i),i}(t),e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type?(this.reconstructor=new f(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(68),i=n(69),s=n(70);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|d(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):f(t,e);if("Buffer"===e.type&&s(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(h(e),t=a(t,e<0?0:0|d(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(t).length;default:if(r)return N(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return S(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return F(this,e,n);case"latin1":case"binary":return O(this,e,n);case"base64":return k(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var s,o=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var h=-1;for(s=n;s<a;s++)if(u(t,s)===u(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===c)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var l=!0,f=0;f<c;f++)if(u(t,s+f)!==u(e,f)){l=!1;break}if(l)return s}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function w(t,e,n,r){return q(N(e,t.length-n),t,n,r)}function x(t,e,n,r){return q(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function _(t,e,n,r){return x(t,e,n,r)}function C(t,e,n,r){return q(L(e),t,n,r)}function M(t,e,n,r){return q(function(t,e){for(var n,r,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(e,t.length-n),t,n,r)}function k(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function A(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var s,o,a,c,u=t[i],h=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=n)switch(l){case 1:u<128&&(h=u);break;case 2:128==(192&(s=t[i+1]))&&(c=(31&u)<<6|63&s)>127&&(h=c);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(c=(15&u)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(h=c);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(h=c)}null===h?(h=65533,l=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=l}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return l(null,t)},c.allocUnsafeSlow=function(t){return l(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,s=Math.min(n,r);i<s;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):m.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(r,i),h=t.slice(e,n),l=0;l<a;++l)if(u[l]!==h[l]){s=u[l],o=h[l];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return x(this,t,e,n);case"latin1":case"binary":return _(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function F(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function S(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=e;s<n;++s)i+=z(t[s]);return i}function T(t,e,n){for(var r=t.slice(e,n),i="",s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function E(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function j(t,e,n,r,i,s){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function I(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-n,2);i<s;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function B(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-n,4);i<s;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function R(t,e,n,r,i,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(t,e,n,r,s){return s||R(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function P(t,e,n,r,s){return s||R(t,0,n,8),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||E(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||E(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||E(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||E(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||E(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var r=this[t],i=1,s=0;++s<e&&(i*=256);)r+=this[t+s]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||E(t,e,this.length);for(var r=e,i=1,s=this[t+--r];r>0&&(i*=256);)s+=this[t+--r]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},c.prototype.readInt8=function(t,e){return e||E(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||E(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||E(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||E(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||E(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||E(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||E(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||E(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||E(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,s=0;for(this[e]=255&t;++s<n&&(i*=256);)this[e+s]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);j(this,t,e,n,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);j(this,t,e,n,i-1,-i)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||j(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return D(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return D(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return P(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return P(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=c.isBuffer(t)?t:N(new c(t,r).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,e){var n;e=e||1/0;for(var r=t.length,i=null,s=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function L(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(44))},function(t,e,n){var r=n(73);t.exports=function(t){var e=t.xdomain,n=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(t){}if(!e)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},function(t,e,n){var r=n(21),i=n(20);function s(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=s,i(s.prototype),s.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},s.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},s.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},s.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},s.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},s.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},s.prototype.onPacket=function(t){this.emit("packet",t)},s.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);class i{constructor(){this.renderTime=0,this.serverTime=0,this.clientTime=0,this.simFrame=0,this.realDt=0,this.renderDt=0,this._simDt=16,this.simAccum=0,this.paused=!1,this.speed=1,this.platformTime=0,this.stepDt=0,this.clientDelay=0,this.renderDelay=0}initialize({debugMenu:t}){t.add(this,"paused"),t.add(this,"speed",.05,2,.05),t.add(this,"simDt",8,512,8),t.add(this,"step"),this.zero()}zero(){this.serverTime=0,this.clientTime=0,this.renderTime=0,this.simFrame=0}syncToServerTime(t){this.serverTime=t,this.clientTime=t-this.clientDelay,this.renderTime=t-this.renderDelay,this.simFrame=Math.floor(this.clientTime/this.simDt)}setClientDelay(t){Object(r.b)(t<=0,"ClientDelay is expected to be negative"),this.clientDelay=t,this.clientTime=this.serverTime-t,this.simFrame=Math.floor(this.clientTime/this.simDt)}setRenderDelay(t){Object(r.b)(t>=0,"RenderDelay is expected to be positive"),this.renderDelay=t,this.renderTime=this.serverTime-t}tick(t){const e=t-this.platformTime;this.platformTime=t,this.realDt=e,this.serverTime+=this.realDt,this.clientTime+=this.realDt,this.renderDt=this.paused?this.stepDt:this.realDt*this.speed,this.renderTime+=this.renderDt,this.simAccum+=e,this.stepDt=0}updateFixed(){this.simAccum-=this.simDt,this.simFrame+=1}set simDt(t){this.zero(),this._simDt=t}get simDt(){return this._simDt}step(t=1e3/60){this.paused=!0,this.stepDt=t*this.speed}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var r=n(16),i=n(11),s=n(0),o=n(15);class a{constructor(){this.client=new i.a,this.synced=!1,this.graph=new o.a,this.clientAhead=0,this.renderDelay=0}initialize(t){this.context=t;const e=this.context.clock,n=this.context.debugMenu.addFolder("Net");n.add(this,"clientAhead",0,1e3,16).onChange(()=>e.setClientDelay(-this.clientAhead)),n.add(this,"renderDelay",0,1e3,16).onChange(()=>e.setRenderDelay(this.renderDelay)),this.context.toplevel.appendChild(this.graph.dom)}onConnect(t){this.client.on(i.b.Message,this.onMessage.bind(this)),this.client.connect(t),this.client.on(i.b.Connected,()=>{this.graph&&this.client.setNetGraphPanel(this.graph.addPanel(`Client: ${this.client.id}`))})}onMessage(t,e){if(Object(s.e)(e)&&(!this.fastestAck||e.rttTime<this.fastestAck.rttTime)){this.fastestAck=e;const t=this.client.lastReceivedFrame*this.context.clock.simDt+.5*e.rttTime;this.context.clock.syncToServerTime(t)}!this.synced&&Object(s.e)(this.client.ping)&&(this.clientAhead=.5*this.client.ping+1*this.context.clock.simDt,this.renderDelay=.5*this.client.ping+3*this.context.clock.simDt,this.context.clock.setClientDelay(-this.clientAhead),this.context.clock.setRenderDelay(this.renderDelay),this.synced=!0)}update({}){this.updateNetGraph()}updateNetGraph(){var t;const e=this.context.clock;null===(t=this.client.graphPanel)||void 0===t||t.update(this.client.ping,e.serverTime,e.renderTime,e.clientTime),window.server&&window.server.net.updateNetGraph()}}class c{constructor(){this.clients=[]}initialize(t){var e;this.context=t,this.graph=null===(e=window.client)||void 0===e?void 0:e.net.graph}async onConnect(t){this.signalSocket=t;const e=new r.c(t);await e.listen(async t=>{const e=new i.a;e.on(i.b.Connected,this.onClientConnected.bind(this,e)),e.on(i.b.Disconnected,this.onClientDisconnected.bind(this,e)),e.on(i.b.Message,this.onClientMessage.bind(this,e)),e.accept(t),this.clients.push(e)})}onClientConnected(t){console.log("Client connected:",t),this.context.avatar.addAvatar(t.id),this.graph&&t.setNetGraphPanel(this.graph.addPanel(`Server: ${t.id}`))}onClientDisconnected(t){var e;console.log("Client disconnected:",t),t.graphPanel&&(null===(e=this.graph)||void 0===e||e.removePanel(t.graphPanel))}onClientMessage(t,e){}transmitToClients(t){for(const e of this.clients)e.transmitServerFrame(t)}updateNetGraph(){var t;if(this.graph)for(const e of this.clients){const n=window.client.clock.serverTime;null===(t=e.graphPanel)||void 0===t||t.update(e.ping,n,void 0,this.context.clock.serverTime)}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return x})),n.d(e,"b",(function(){return C}));var r=n(0),i=n(6);const s={passive:!1,capture:!1};class o{constructor(t){var e=this.getTouchTargetCoords(t);this.x=e.x,this.y=e.y,this.id=t.identifier,this.target=t.target,this.touch=t}getTouchTargetCoords(t){for(var e=0,n=0,i=t.target;!(i instanceof HTMLElement);)i=Object(r.c)(i.parentNode);var s=i;do{e+=s.offsetLeft-s.scrollLeft,n+=s.offsetTop-s.scrollTop,s=s.offsetParent}while(s);return{x:t.pageX-e,y:t.pageY-n}}}class a{constructor(t,e){if(this.element=e.target,this.event=e,this.touches=[],this.changedTouches=[],e){var n,r=e.touches.length;for(n=0;n<r;n++)this.touches.push(new o(e.touches[n]));for(r=e.changedTouches.length,n=0;n<r;n++)this.changedTouches.push(new o(e.changedTouches[n]))}}getTouchById(t,e){var n,r=e.length;for(n=0;n<r;n++)if(e[n].id===t)return e[n];return null}}class c extends i.a{constructor(t){super(),this.element=void 0,this.onStart=t=>{t.preventDefault(),this.fire("touchstart",new a(this,t))},this.onEnd=t=>{t.preventDefault(),this.fire("touchend",new a(this,t))},this.onCancel=t=>{this.fire("touchcancel",new a(this,t))},this.onMove=t=>{t.preventDefault(),this.fire("touchmove",new a(this,t))},this.attach(t)}attach(t){this.element&&this.detach(),this.element=t,this.element.addEventListener("touchstart",this.onStart,s),this.element.addEventListener("touchend",this.onEnd,s),this.element.addEventListener("touchmove",this.onMove,s),this.element.addEventListener("touchcancel",this.onCancel,s)}detach(){this.element&&(this.element.removeEventListener("touchstart",this.onStart,s),this.element.removeEventListener("touchend",this.onEnd,s),this.element.removeEventListener("touchmove",this.onMove,s),this.element.removeEventListener("touchcancel",this.onCancel,s)),this.element=void 0}registerAxis(t){let e,n,i;const s={value:0,options:t},o=t.source===v.TouchDragX?"x":"y";return this.on("touchstart",a=>{if(a.touches.length-1===Object(r.d)(t.index,0)){const t=a.changedTouches[0];e=t.id,n=performance.now(),i=t[o],s.value=0}}),this.on("touchend",t=>{const a=t.changedTouches.find(t=>t.id===e);if(Object(r.e)(a)){const r=t.changedTouches[0];e=r.id,n=performance.now(),i=r[o],s.value=0}}),this.on("touchmove",t=>{const a=t.changedTouches.find(t=>t.id===e);if(Object(r.e)(a)){const t=a[o],e=performance.now(),r=t-i;s.value=r,n=e}}),s}}class u extends i.a{constructor(t,e={}){super(),this.keysDown=new Map,this.handleKeyDown=this.onKeyDown.bind(this),this.handleKeyUp=this.onKeyUp.bind(this),this.attach(t),this.preventDefault=Object(r.d)(e.preventDefault,!1),this.stopPropagation=Object(r.d)(e.stopPropagation,!1)}attach(t){this.element&&this.detach(),this.element=t,this.element.addEventListener("keydown",this.handleKeyDown,!1),this.element.addEventListener("keyup",this.handleKeyUp,!1)}detach(){this.element&&(this.element.removeEventListener("keydown",this.handleKeyDown),this.element.removeEventListener("keyup",this.handleKeyUp),this.element=void 0)}onKeyDown(t){var e=t.code;t.repeat||void 0!==e&&(this.keysDown.set(e,!0),this.fire("keydown",t),this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation())}onKeyUp(t){var e=t.code;void 0!==e&&(this.keysDown.delete(e),this.fire("keyup",t),this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation())}update(){this.keysDown.forEach((t,e)=>{this.keysDown.set(e,!1)})}isPressed(t){return this.keysDown.has(t)}wasPressed(t){return!!this.keysDown.get(t)}clear(){this.fire("clear",event),this.keysDown.clear()}}var h,l,f=n(22),d=n.n(f);!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(h||(h={})),function(t){t.MouseUp="mouseup",t.MouseDown="mousedown",t.MouseMove="mousemove",t.MouseWheel="mousewheel"}(l||(l={}));const p={passive:!1,capture:!1};class m{constructor(t,e){Object(r.c)(e),Object(r.b)(e instanceof MouseEvent,"Expected MouseEvent");const n=t._getTargetCoords(e);if(n)this.x=n.x,this.y=n.y;else{if(!g.isPointerLocked())return;this.x=0,this.y=0}if(this.wheelDelta=0,"wheel"===e.type){const t=e;t.deltaY>0?this.wheelDelta=1:t.deltaY<0&&(this.wheelDelta=-1)}g.isPointerLocked()?(this.dx=e.movementX||0,this.dy=e.movementY||0):(this.dx=this.x-t._lastX,this.dy=this.y-t._lastY),"mousedown"!==e.type&&"mouseup"!==e.type||(this.button=e.button),this.buttons=t._buttons.slice(0),this.element=e.target,this.ctrlKey=e.ctrlKey||!1,this.altKey=e.altKey||!1,this.shiftKey=e.shiftKey||!1,this.metaKey=e.metaKey||!1,this.event=e}}class g extends i.a{constructor(t){super(),this.attached=!1,this._lastX=0,this._lastY=0,this._buttons=[!1,!1,!1],this._lastButtons=[!1,!1,!1],this.onUp=this.handleUp.bind(this),this.onDown=this.handleDown.bind(this),this.onMove=this.handleMove.bind(this),this.onWheel=this.handleWheel.bind(this),this.onContextMenu=t=>{t.preventDefault()},this.attach(t)}static isPointerLocked(){return!!document.pointerLockElement}attach(t){this.target=t,this.attached||(this.attached=!0,window.addEventListener("mouseup",this.onUp,p),window.addEventListener("mousedown",this.onDown,p),window.addEventListener("mousemove",this.onMove,p),window.addEventListener("wheel",this.onWheel,p))}detach(){this.attached&&(this.attached=!1,this.target=null,window.removeEventListener("mouseup",this.onUp,p),window.removeEventListener("mousedown",this.onDown,p),window.removeEventListener("mousemove",this.onMove,p),window.removeEventListener("wheel",this.onWheel,p))}disableContextMenu(){this.target&&this.target.addEventListener("contextmenu",this.onContextMenu)}enableContextMenu(){this.target&&this.target.removeEventListener("contextmenu",this.onContextMenu)}enablePointerLock(t,e){if(document.body.requestPointerLock){if(t){const e=function(){t(),document.removeEventListener("pointerlockchange",e)};document.addEventListener("pointerlockchange",e,!1)}if(e){const t=function(){e(),document.removeEventListener("pointerlockerror",t)};document.addEventListener("pointerlockerror",t,!1)}document.body.requestPointerLock()}else e&&e()}disablePointerLock(t){if(document.exitPointerLock){if(Object(r.e)(t)){const e=function(){t(),document.removeEventListener("pointerlockchange",e)};document.addEventListener("pointerlockchange",e,!1)}document.exitPointerLock()}}update(){this._lastButtons[0]=this._buttons[0],this._lastButtons[1]=this._buttons[1],this._lastButtons[2]=this._buttons[2]}isPressed(t){return this._buttons[t]}wasPressed(t){return this._buttons[t]&&!this._lastButtons[t]}wasReleased(t){return!this._buttons[t]&&this._lastButtons[t]}handleUp(t){this._buttons[t.button]=!1;const e=new m(this,t);e.event&&this.fire(l.MouseUp,e)}handleDown(t){this._buttons[t.button]=!0;const e=new m(this,t);e.event&&this.fire(l.MouseDown,e)}handleMove(t){const e=new m(this,t);e.event&&(this.fire(l.MouseMove,e),this._lastX=e.x,this._lastY=e.y)}handleWheel(t){const e=new m(this,t);e.event&&this.fire(l.MouseWheel,e)}_getTargetCoords(t){const e=Object(r.c)(this.target),n=e.getBoundingClientRect(),i=Math.floor(n.left),s=Math.floor(n.top);return t.clientX<i||t.clientX>=i+e.clientWidth||t.clientY<s||t.clientY>=s+e.clientHeight?null:{x:t.clientX-i,y:t.clientY-s}}}class y{constructor(t){this.name=t}}var v;!function(t){t[t.MouseDragX=0]="MouseDragX",t[t.MouseDragY=1]="MouseDragY",t[t.MouseWheel=2]="MouseWheel",t[t.TouchDragX=3]="TouchDragX",t[t.TouchDragY=4]="TouchDragY",t[t.TouchPinch=5]="TouchPinch",t[t.TouchRotate=6]="TouchRotate",t[t.TwoTouchDragX=7]="TwoTouchDragX",t[t.TwoTouchDragY=8]="TwoTouchDragY",t[t.PadLeftStickX=9]="PadLeftStickX",t[t.PadLeftStickY=10]="PadLeftStickY",t[t.PadRightStickX=11]="PadRightStickX",t[t.PadRightStickY=12]="PadRightStickY",t[t.Key=13]="Key"}(v||(v={}));class b{constructor(){this.actions={},this.axes={}}attach(t){this.element=t,Object(r.e)(this.touch)&&this.touch.attach(t),Object(r.e)(this.keyboard)&&this.keyboard.attach(t),Object(r.e)(this.mouse)&&this.mouse.attach(t),window.addEventListener("blur",()=>{this.keyboard.clear()}),d.a.isEnabled&&d.a.onchange(()=>{this.keyboard.clear()})}detach(t){Object(r.e)(this.touch)&&this.touch.detach(),Object(r.e)(this.keyboard)&&this.keyboard.detach(),Object(r.e)(this.mouse)&&this.mouse.detach(),this.element=void 0}disableContextMenu(){this.mouse||this.enableMouse(),this.mouse.disableContextMenu()}enableContextMenu(){this.mouse||this.enableMouse(),this.mouse.enableContextMenu()}updateAxes(){for(const t in this.axes)for(const e of this.axes[t])e.func&&(e.value=e.func())}afterFrame(){this.keyboard&&this.keyboard.update(),this.mouse&&this.mouse.update()}registerKeys(t,e){this.keyboard||this.enableKeyboard(),Object(r.e)(this.actions[t])||(this.actions[t]=new y(name));const n=this.actions[t];Object(r.b)(!Object(r.e)(n.keys),"Action already has key bindings"),n.keys=e}registerMouse(t,e){this.mouse||this.enableMouse(),Object(r.e)(this.actions[t])||(this.actions[t]=new y(name));const n=this.actions[t];Object(r.b)(!Object(r.e)(n.keys),"Action already has mouse bindings"),n.mouseButtons=e}registerPadButton(t,e,n){Object(r.e)(this.actions[t])||(this.actions[t]=new y(name));const i=this.actions[t];Object(r.b)(!Object(r.e)(i.keys),"Action already has mouse bindings"),i.padButtons=e,i.padIndexes=n}registerAxis(t,e){Object(r.e)(this.axes[t])||(this.axes[t]=[]);const n=this.axes[t];switch(e.source){case v.Key:n.push({value:0,options:e,func:()=>{let t=0;return Object(r.e)(e.positiveKey)&&(t+=this.keyboard.isPressed(e.positiveKey)?1:0),Object(r.e)(e.negativeKey)&&(t+=this.keyboard.isPressed(e.negativeKey)?-1:0),t}});break;case v.TouchDragX:case v.TouchDragY:{Object(r.e)(this.touch)||this.enableTouches();const t=this.touch.registerAxis(e);n.push(t)}}}isPressed(t){const e=this.actions[t];if(!Object(r.e)(e))return!1;if(e.keys)for(const t of e.keys)if(this.keyboard.isPressed(t))return!0;if(e.mouseButtons)for(const t of e.mouseButtons)if(this.mouse.isPressed(t))return!0;return!1}wasPressed(t){const e=this.actions[t];if(!Object(r.e)(e))return!1;if(e.keys)for(const t of e.keys)if(this.keyboard.wasPressed(t))return!0;if(e.mouseButtons)for(const t of e.mouseButtons)if(this.mouse.wasPressed(t))return!0;return!1}getAxis(t){const e=Object(r.c)(this.axes[t],`No axis named "${t}"`);let n=0;for(const t of e)Math.abs(t.value)>Math.abs(n)&&(n=t.options.invert?-t.value:t.value);return n}enableMouse(){const t=Object(r.c)(this.element,"Controller must be attached to an Element");this.mouse=new g(t)}enableKeyboard(){const t=Object(r.c)(this.element,"Controller must be attached to an Element");this.keyboard=new u(t)}enableTouches(){const t=Object(r.c)(this.element,"Controller must be attached to an Element");this.touch=new c(t)}}const w=d.a.isEnabled?d.a:void 0;var x;!function(t){t[t.Walk=1]="Walk",t[t.Fullscreen=2]="Fullscreen"}(x||(x={}));const _={[x.Walk]:{id:"walk",name:"Walk",desc:"Hold to walk instead of run"},[x.Fullscreen]:{id:"fullscreen",name:"Toggle Fullscreen",desc:"Toggle fullscreen mode"}};class C{constructor(){this.controller=new b}initialize({toplevel:t}){this.controller.attach(t),this.controller.enableMouse(),this.controller.enableTouches(),this.controller.keyboard=new u(window),this.controller.registerAxis("Vertical",{source:v.Key,positiveKey:"KeyW",negativeKey:"KeyS"}),this.controller.registerAxis("Horizontal",{source:v.Key,positiveKey:"KeyD",negativeKey:"KeyA"}),this.controller.registerAxis("Horizontal",{source:v.TouchDragX}),this.controller.registerAxis("Vertical",{source:v.TouchDragY,invert:!0}),this.controller.registerKeys(_[x.Walk].id,["ShiftLeft","ShiftRight"]),this.controller.registerKeys(_[x.Fullscreen].id,["Backslash"]),this.controller.disableContextMenu()}isActive(t){return this.controller.isPressed(t)}wasActive(t){return this.controller.wasPressed(t)}getAxis(t){return this.controller.getAxis(t)}update(){this.controller.updateAxes()}updateFixed({camera:t,clock:e,userCommands:n}){const r=Object.keys(_).length;let i=0;for(let t=0;t<r;t++){const e=1<<t;this.isActive(_[e].id)&&(i|=e)}const s={frame:e.simFrame,headingX:t.forward[0],headingZ:t.forward[2],horizontalAxis:this.getAxis("Horizontal"),verticalAxis:this.getAxis("Vertical"),actions:i};n.setUserCommand(s)}afterFrame(){Object(r.e)(w)&&this.wasActive("toggleFullscreen")&&w.toggle(this.controller.element),this.controller.afterFrame()}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return U}));var r,i=n(55),s=n.n(i);!function(t){t[t.LoadingAsync=0]="LoadingAsync",t[t.LoadingSync=1]="LoadingSync",t[t.Loaded=2]="Loaded",t[t.Unloaded=3]="Unloaded",t[t.Failed=4]="Failed"}(r||(r={}));var o=n(1),a=n(0);var c=n(2),u=n(10),h=n(13);const l=1313821514,f=5130562;let d=new TextDecoder;function p(t){return d.decode(t)}class m{constructor(t){const e=new DataView(t,0,12),n=new DataView(t,12),r=p(new Uint8Array(t,0,4)),i=e.getUint32(4,!0);e.getUint32(8,!0);if("glTF"!==r)throw new Error("Unsupported glTF-Binary header.");if(i<2)throw new Error("Unsupported legacy binary file detected.");let s=0;for(;s<n.byteLength;){const e=n.getUint32(s,!0);s+=4;const r=n.getUint32(s,!0);switch(s+=4,r){case l:{const n=new Uint8Array(t,12+s,e);this.json=p(n)}break;case f:{const n=12+s;this.binaryChunk=new Uint8Array(t,n,e)}break;default:console.warn("Skipping unexpected glTF-Binary chunk type:",r)}s+=e}Object(a.b)(!!this.json,"glTF-Binary: JSON content not found.")}}class g{constructor(t,e){this.gltf=t,this.bufferData=e}bufferViewData(t){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const e=this.gltf.bufferViews[t],n=Object(a.c)(this.bufferData[e.buffer],`No data for buffer ${e.buffer}`),r=e.byteLength||0,i=e.byteOffset||0,s=n.buffer,o=n.byteOffset;return new Uint8Array(s,o+i,r)}accessorData(t){if(!this.gltf.accessors)throw new Error("No accessors views found.");const e=this.gltf.accessors[t],n=M[e.type];let r;const i=C[e.componentType],s=i.BYTES_PER_ELEMENT*n*e.count;if(void 0!==e.bufferView){const t=this.bufferViewData(e.bufferView);r=new i(t.buffer,t.byteOffset+Object(a.d)(e.byteOffset,0),e.count*n)}else r=new i(s);if(e.sparse){const{count:t,indices:i,values:s}=e.sparse;let o=C[i.componentType],a=this.bufferViewData(i.bufferView);const c=new o(a.buffer,a.byteOffset+(i.byteOffset||0),t);o=C[e.componentType],a=this.bufferViewData(s.bufferView);const u=new o(this.bufferViewData(s.bufferView).buffer,a.byteOffset+(s.byteOffset||0),t*n);e.bufferView&&(r=new Uint8Array(r));const h=new C[e.componentType](r.buffer);for(let e=0;e<t;e++)for(let t=0;t<n;t++)h[n*c[e]+t]=u[n*e+t]}return r}}class y extends h.b{clone(t=!1){const e=super.clone(t);return e.morphWeight=this.morphWeight,e.meshId=this.meshId,e.skinId=this.skinId,e}}function v(t,e){let n;switch(e){case 5120:n=o.m.Char;break;case 5121:n=o.m.Uchar;break;case 5122:n=o.m.Short;break;case 5123:n=o.m.Ushort;break;case 5125:n=o.m.Uint;break;case 5126:n=o.m.Float;break;default:throw new Error("Invalid GLTF component type")}switch(t){case"SCALAR":n+=0;break;case"VEC2":n+=1;break;case"VEC3":n+=2;break;case"VEC4":n+=3;break;case"MAT2":throw new Error("2x2 Matrice not yet supported");case"MAT3":n=o.m.Float3x3;break;case"MAT4":n=o.m.Float4x4}return n}function b(t){switch(t){case 5124:return o.m.Int;case 5126:return o.m.Float;case 35664:return o.m.Float2;case 35665:return o.m.Float3;case 35666:return o.m.Float4;case 35667:return o.m.Int2;case 35668:return o.m.Int3;case 35669:return o.m.Int4;case 35675:return o.m.Float3x3;case 35676:return o.m.Float4x4;case 35678:return o.m.Texture2D;default:throw new Error("Invalid GLTF component type")}}function w(t){switch(t){case 0:return o.g.Points;case 1:return o.g.Lines;case 2:return o.g.LineLoop;case 3:return o.g.LineStrip;case 4:return o.g.Triangles;case 5:return o.g.TriangleStrip;case 6:return o.g.TriangleFan;default:throw new Error("Invalid GLTF primitive mode")}}const x={9728:o.j.Nearest,9729:o.j.Linear},_={9728:o.j.Nearest,9729:o.j.Linear},C={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={POSITION:"a_pos",NORMAL:"a_normal",TANGENT:"a_tangent",JOINTS_0:"a_joints",WEIGHTS_0:"a_weights",COLOR_0:"a_color",TEXCOORD_0:"a_uv0",TEXCOORD_1:"a_uv1",MORPH0_POSITION:"a_posMorph0"},A={NORMAL:"HAS_NORMALS 1",TANGENT:"HAS_TANGENT 1",JOINTS_0:"HAS_JOINT_SET0 1",WEIGHTS_0:"HAS_WEIGHT_SET0 1",COLOR_0:"HAS_COLOR0 1",TEXCOORD_0:"HAS_UV_SET0 1",TEXCOORD_1:"HAS_UV_SET1 1"},F={CUBICSPLINE:void 0,LINEAR:u.e,STEP:u.d},O={translation:"position",rotation:"quaternion",scale:"scale",weights:"_UNSUPPORTED"};function S(t,e,n){const r=n,i=e.gltf;let s;if(!Object(a.e)(n.material))throw new Error("Default material not yet supported");s=Object(a.c)(t.transient.materials[n.material]);const c=[];let u=void 0;const h=[];if(Object(a.e)(r.indices)){const n=Object(a.c)(i.accessors)[r.indices];u=T(t,e,Object(a.c)(n.bufferView),o.c.Index)}let l;if(Object(a.e)(s.techniqueIndex)){l={};const e=Object(a.c)(t.transient.techniques).techniques[s.techniqueIndex],n=Object.keys(e.attributes);for(const t of n){l[e.attributes[t].semantic]=t}}else l=k;const f={buffers:[]},d={};for(let n in r.attributes){const s=Object(a.c)(i.accessors)[r.attributes[n]],u=Object(a.c)(s.bufferView,"Undefined accessor buffers are not yet implemented"),p=d[u];let m;if(Object(a.e)(p))m=f.buffers[p];else{d[u]=h.length;const n=T(t,e,u,o.c.Vertex),r=Object(a.c)(i.bufferViews)[u];m={stride:Object(a.d)(r.byteStride,0),layout:{}},h.push(n),f.buffers.push(m)}const g=A[n];Object(a.e)(g)&&c.push(g);const y=Object(a.c)(l[n],`Unknown vertex attribute semantic: ${n}`);m.layout[y]={type:v(s.type,s.componentType),offset:s.byteOffset||0}}if(r.targets){c.push("HAS_MORPH0 1"),Object(a.b)(1===r.targets.length,"Only 1 morph target is currently supported");const n=r.targets[0];for(let r in n)if("POSITION"===r){const s=Object(a.c)(i.accessors)[n[r]],c=Object(a.c)(s.bufferView,"Undefined accessor buffers are not yet implemented"),u=Object(a.c)(i.bufferViews)[c];let d=f.buffers[c];const p=T(t,e,c,o.c.Vertex);Object(a.e)(d)||(h[c]=p,d=f.buffers[c]={stride:Object(a.d)(u.byteStride,0),layout:{}});const m=l[`MORPH0_${r}`];d.layout[m]={type:v(s.type,s.componentType),offset:s.byteOffset||0}}}const p=i.accessors[Object(a.c)(r.indices,"Only indexed primitives are currently supported")],m=Object(a.c)(u,"Only indexed primitives are currently supported");return{mesh:{elementCount:p.count,vertexBuffers:h,primitiveType:w(Object(a.d)(r.mode,4)),indexType:v(p.type,p.componentType),indexBuffer:m,vertexLayout:f},materialIndex:n.material}}function T(t,e,n,r){if(Object(a.e)(t.bufferViews[n]))return t.bufferViews[n];const i=Object(a.c)(e.gltf.bufferViews)[n].name||`buffer${n}`;t.bufferData[n]=new Uint8Array(e.bufferViewData(n)).buffer,Object(a.b)(!t.transferList.includes(t.bufferData[n])),t.transferList.push(t.bufferData[n]);const s={name:i,type:r,buffer:-1};return t.bufferViews[n]=s,s}function E(t,e){return Object(a.d)(e.gltf.materials,[]).map((t,e)=>{var n;const r=null===(n=t.extensions)||void 0===n?void 0:n.KHR_techniques_webgl,i=r?r.technique:void 0,s=r?r.values:void 0;return{name:Object(a.d)(t.name,`Material${e}`),renderFormat:{blendingEnabled:!1},cullMode:t.doubleSided?o.e.None:o.e.Back,techniqueIndex:i,values:s}})}function j(t,e){var n;if(!(null===(n=e.gltf.extensionsUsed)||void 0===n?void 0:n.includes("KHR_techniques_webgl")))return;const r=Object(a.c)(e.gltf.extensions.KHR_techniques_webgl);return{shaderData:r.shaders.map((n,r)=>{const i=Object(a.c)(n.bufferView,"Shader loading from URI not yet supported"),s=new Uint8Array(e.bufferViewData(i)).buffer;return Object(a.b)(!t.transferList.includes(s)),t.transferList.push(s),s}),shaders:r.programs.map(t=>({name:t.name,fsIndex:t.fragmentShader,vsIndex:t.vertexShader})),techniques:r.techniques.map((t,e)=>{const n={};for(const e in Object(a.d)(t.uniforms,{})){const r=t.uniforms[e];n[e]=Object.assign(Object.assign({},r),{type:b(r.type)})}return{shaderIndex:t.program,attributes:Object(a.d)(t.attributes,{}),uniforms:n}})}}function I(t,e){return Object(a.d)(e.gltf.nodes,[]).map(t=>{const n=Object(a.d)(t.scale,[1,1,1]),r=Object(a.d)(t.rotation,[0,0,0,1]),i=Object(a.d)(t.translation,[0,0,0]),s={name:t.name,scale:c.c.fromValues(n[0],n[1],n[2]),rotation:c.b.fromValues(r[0],r[1],r[2],r[3]),translation:c.c.fromValues(i[0],i[1],i[2]),morphWeight:Object(a.d)(t.weights,[0])[0],transform:c.a.create(),meshId:Object(a.e)(t.mesh)?t.mesh:void 0,skinId:Object(a.e)(t.skin)?t.skin:void 0,children:[]};if(Object(a.e)(t.matrix)?(s.transform.set(t.matrix),c.a.getRotation(s.rotation,s.transform),c.a.getTranslation(s.translation,s.transform),c.a.getScaling(s.scale,s.transform)):s.transform=c.a.fromRotationTranslationScale(c.a.create(),s.rotation,s.translation,s.scale),Object(a.e)(t.children))for(let n=0;n<t.children.length;n++){const r=t.children[n];Object(a.c)(e.gltf.nodes)[r];s.children.push(r)}return s})}async function B(t,e){const n=Object(a.d)(e.gltf.images,[]),r=Object(a.d)(e.gltf.textures,[]),i=Object(a.d)(e.gltf.samplers,[]),s={type:o.k.Texture2D,format:o.i.U8x4,usage:o.n.Static},c={wrapS:10497,wrapT:10497},u=n.map(n=>{const r=Object(a.c)(n.bufferView,"Image loading from a URI is not yet supported"),i=e.bufferViewData(r);let s;if(Object(a.e)(self.createImageBitmap)){const t=new Blob([i],{type:Object(a.c)(n.mimeType)});s=createImageBitmap(t)}else s=Promise.resolve(new Uint8Array(i).buffer);return s.then(e=>(Object(a.b)(!t.transferList.includes(e)),t.transferList.push(e),e))}),h=r.map(t=>{const e=Object(a.d)(i[t.sampler],c),n=Object.assign({},s);return Object(a.e)(e.magFilter)&&(n.defaultMagFilter=x[e.magFilter],Object(a.e)(n.defaultMagFilter)||console.warn(`Unsupported texture mag filter: ${e.magFilter}`)),Object(a.e)(e.minFilter)&&(n.defaultMagFilter=_[e.minFilter],Object(a.e)(n.defaultMagFilter)||console.warn(`Unsupported texture min filter: ${e.magFilter}`)),(Object(a.e)(e.wrapS)||Object(a.e)(e.wrapT))&&(Object(a.e)(n.defaultMagFilter)||console.warn(`Texture wrapping not yet supported: ${e.magFilter}`)),{name:t.name,desc:n,imageIndex:Object(a.c)(t.source)}});return{imageData:await Promise.all(u),textures:h}}function R(t,e){let n=[];for(const r of Object(a.d)(e.gltf.animations,[])){const i=r.samplers.map(n=>{Object(a.b)(5126===e.gltf.accessors[n.input].componentType,"Non-float animation time type unsupported"),Object(a.b)(5126===e.gltf.accessors[n.output].componentType,"Non-float animation values type unsupported");const r=new Float32Array(e.accessorData(n.input)),i=new Float32Array(e.accessorData(n.output));return t.transferList.push(r.buffer,i.buffer),{times:r,values:i}}),s=[];for(const t of r.channels){const e=t.target.node;if(!Object(a.e)(e))continue;const n=O[t.target.path],o=i[t.sampler],c=Object(a.d)(r.samplers[t.sampler].interpolation,"LINEAR");s.push({targetNodeId:e,targetProperty:n,times:o.times,values:o.values,interpolation:c})}n.push({name:r.name,maxTime:r.maxTime,tracks:s})}return n}class D extends u.c{copySampleValue_(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r,s=0;s!==r;s++)e[s]=n[i+s];return e}beforeStart_(t){this.copySampleValue_(t)}afterEnd_(t){this.copySampleValue_(t)}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,c=3*o,u=r-e,h=(n-e)/u,l=h*h,f=l*h,d=t*c,p=d-c,m=-2*f+3*l,g=f-l,y=1-m,v=g-l+h;for(let t=0;t!==o;t++){const e=s[p+t+o],n=s[p+t+a]*u,r=s[d+t+o],c=s[d+t]*u;i[t]=y*e+v*n+m*r+g*c}return i}}const P={texture:new class{async loadAsync(t){const e=await fetch(t.source.uri);if(200!=e.status)throw new Error("Failed to download image");const n=t.source.uri.match(/.*\/(.+?)\./);t.name=n&&n.length>1?n[1]:"Unknown",self.createImageBitmap?(t.imageBitmap=await createImageBitmap(await e.blob()),t.transferList.push(t.imageBitmap),t.status=r.LoadingSync):(t.imageBuffer=await e.arrayBuffer(),t.transferList.push(t.imageBuffer),t.status=r.LoadingSync)}loadSync(t,e){if(e.imageBitmap)e.texture=t.renderer?t.renderer.createTexture(e.name,{usage:o.n.Static,type:o.k.Texture2D,format:o.i.U8x3,maxAnistropy:16},e.imageBitmap):-1,e.imageBitmap.close(),delete e.imageBitmap,e.status=r.Loaded;else{if(e.imageBuffer){var n=new Blob([e.imageBuffer],{type:"image/jpeg"});let t=window.URL.createObjectURL(n);delete e.imageBuffer,e.imageElement=new Image,e.imageElement.src=t,e.status=r.LoadingSync}Object(a.e)(e.imageElement)&&e.imageElement.complete&&(e.texture=t.renderer?t.renderer.createTexture(e.name,{usage:o.n.Static,type:o.k.Texture2D,format:o.i.U8x3,maxAnistropy:16},e.imageElement):-1,delete e.imageElement,e.status=r.Loaded)}}unloadSync(t,e){Object(a.e)(e.texture)&&t.renderer&&t.renderer.removeTexture(e.texture),Object(a.e)(e.imageBitmap)&&e.imageBitmap.close()}},gltf:new class{async loadAsync(t){const e=await fetch(t.source.uri);if(200!=e.status)throw new Error("Failed to download GLTF");const n=await e.arrayBuffer(),i=new m(n),s=JSON.parse(i.json),o=new g(s,[i.binaryChunk]);t.nodes=[],t.meshes=[],t.materials=[],t.textures=[],t.bufferViews=[],t.animations=[],t.rootNodeIds=[],t.bufferData=[],t.transient={techniques:j(t,o),materials:E(0,o),nodes:I(0,o),animation:R(t,o),textures:await B(t,o)},function(t,e){const n=Object(a.d)(e.gltf.meshes,[]);t.meshes=[];for(let r=0;r<n.length;r++){const i=Object(a.c)(n[r]),s=[];for(let n of i.primitives)s.push(S(t,e,n));const o={name:i.name,id:r,primitives:s};t.meshes[r]=o}}(t,o),function(t,e){const n=Object(a.d)(e.gltf.skins,[]);t.skins=[];for(let r=0;r<n.length;r++){const i=n[r];let s=void 0;if(Object(a.e)(i.inverseBindMatrices)){const n=new Float32Array(e.accessorData(i.inverseBindMatrices));Object(a.b)(!t.transferList.includes(n.buffer)),t.transferList.push(n.buffer),s=[];for(let t=0;t<i.joints.length;t++)s[t]=n.subarray(16*t,16*t+16)}t.skins[r]={name:i.name,skeleton:i.skeleton,joints:i.joints,inverseBindMatrices:s}}}(t,o),function(t,e){const n=Object(a.d)(e.gltf.scene,0);if(Object(a.e)(n)){const r=Object(a.c)(e.gltf.scenes),i=Object(a.c)(r[n]);t.rootNodeIds=Object(a.d)(i.nodes,[])}}(t,o),Object(a.b)(!t.transferList.includes(n)),t.status=r.LoadingSync}loadSync(t,e){if(Object(a.e)(self.createImageBitmap))e.status=r.Loaded;else if(function(t,e){let n=!1;const i=t.transient.textures;let s=0;for(let c=0;c<i.textures.length;c++){const u=i.textures[c],h=i.imageData[u.imageIndex];if(Object(a.e)(t.textures[c]))s+=1;else{if(h instanceof ArrayBuffer){n=!0;var o=new Blob([h],{type:"image/jpeg"});let e=window.URL.createObjectURL(o);i.imageData[u.imageIndex]=new Image,i.imageData[u.imageIndex].src=e,t.status=r.LoadingSync}h.complete&&(Object(a.b)(Object(a.e)(t.textures),"This should have been defined as an empty array by loadTexturesSync()"),t.textures[c]={desc:u.desc,name:u.name,id:Object(a.e)(e.renderer)?e.renderer.createTexture(u.name,u.desc,h):-1})}}return s===i.textures.length?t.status=r.Loaded:t.status=r.LoadingSync,!n}(e,t))return;if(e.techniques=function(t,e){if(!Object(a.e)(t))return[];const n=Object(a.e)(e.renderer)?t.shaders.map(n=>{const r=t.shaderData[n.vsIndex],i=t.shaderData[n.fsIndex],s={name:n.name,vertSource:p(r),fragSource:p(i)};return e.renderer.createShader(s)}):[];return t.techniques.map(t=>({shaderId:n[t.shaderIndex],attributes:t.attributes,uniforms:t.uniforms}))}(e.transient.techniques,t),e.materials=function(t,e){return t.map(t=>({name:t.name,renderFormat:t.renderFormat,cullMode:t.cullMode,values:t.values,technique:Object(a.e)(t.techniqueIndex)?e.techniques[t.techniqueIndex]:void 0}))}(e.transient.materials,e),e.nodes=function(t){const e=t.map((t,e)=>{const n=new y;return n.name=Object(a.d)(t.name,`Node${e}`),n.position.set(t.translation[0],t.translation[1],t.translation[2]),n.quaternion.set(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]),n.scale.set(t.scale[0],t.scale[1],t.scale[2]),n.skinId=t.skinId,n.meshId=t.meshId,n.morphWeight=t.morphWeight,n});for(let n=0;n<e.length;n++){const r=t[n],i=e[n];for(const t of r.children)i.add(e[t])}return e}(e.transient.nodes),e.animations=function(t,e){const n=[];for(const r of t){const t=r.tracks.map(t=>{let n;switch(t.targetProperty){case"quaternion":n=u.f;break;case"position":case"scale":n=u.g;break;default:throw new Error("Unsupported animation target property")}const r=new n(`${e.nodes[t.targetNodeId].name}.${t.targetProperty}`,t.times,t.values,F[t.interpolation]);return"CUBICSPLINE"===t.interpolation&&(r.createInterpolant=function(t){return new D(this.times,this.values,this.getValueSize()/3,t)},r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),r});n.push(new u.a(r.name,r.maxTime,t))}return n}(e.transient.animation,e),e.textures=function(t,e){const n=[];if(Object(a.e)(self.createImageBitmap)&&Object(a.e)(e.renderer)){for(const r of t.textures){const i=t.imageData[r.imageIndex];Object(a.b)(i instanceof ImageBitmap),n.push({desc:r.desc,name:r.name,id:e.renderer.createTexture(r.name,r.desc,i)})}for(const e of t.imageData)e.close()}return n}(e.transient.textures,t),Object(a.e)(t.renderer))for(let n in e.bufferData){const r=e.bufferViews[n],i=e.bufferData[n];r.buffer=t.renderer.createBuffer(r.name,r.type,o.n.Static,i)}e.status===r.Loaded&&delete e.transient}unloadSync(t,e){}}};class U{constructor(){this.messages=[],this.pending=[],this.finished=[],this.unloaded=[],this.loadingAsync=[],this.loadingSync=[],this.cache={},this.requests={}}initialize(t){this.worker=new s.a,this.worker.onmessage=t=>this.onMessage(t),this.context={renderer:t}}onMessage(t){this.messages.push(t)}load(t,e,n){if(!Object(a.e)(P[e]))return void n("Invalid resource type",void 0);const i="string"==typeof t?t:t.uri,s="string"==typeof t?void 0:t.headers,o=i+e;if(Object(a.e)(this.cache[o]))n(void 0,this.cache[o]);else if(this.requests[o])this.requests[o].push(n);else{this.requests[o]=[n];const t={source:{uri:i,headers:s,type:e},status:r.LoadingAsync,transferList:[]};this.worker.postMessage([t])}}unload(t,e){const n=("string"==typeof t?t:t.uri)+e;if(Object(a.e)(this.cache[n])){const t=this.cache[n];P[t.source.type].unloadSync(this.context,t),delete this.cache[n]}else{if(!this.requests[n])throw new Error(`Attempted to unload a resource that was never loaded: ${n}`);delete this.requests[n]}}update(){for(let t of this.messages)Array.prototype.push.apply(this.pending,t.data);for(let t of this.pending){const e=t.source.uri+t.source.type;if(Object(a.e)(this.requests[e])||(t.status=r.Unloaded),t.status===r.LoadingSync){P[t.source.type].loadSync(this.context,t)}switch(t.status){case r.Loaded:case r.Failed:this.finished.push(t);break;case r.Unloaded:this.unloaded.push(t);break;case r.LoadingAsync:this.loadingAsync.push(t);break;case r.LoadingSync:this.loadingSync.push(t)}}this.pending.length=0;for(let t of this.finished){const e=t.source.uri+t.source.type,n=Object(a.c)(this.requests[e]).length;Object(a.b)(n>=1),this.cache[e]=t;for(let i=0;i<n;i++)t.status===r.Failed?this.requests[e][i](t.error,void 0):this.requests[e][i](void 0,t);delete this.requests[e]}const t=[];for(let e of this.loadingAsync)Array.prototype.push.apply(t,e.transferList);this.worker.postMessage(this.loadingAsync,t);for(let t of this.unloaded){P[t.source.type].unloadSync(this.context,t)}Array.prototype.push.apply(this.pending,this.loadingSync),this.finished.length=0,this.unloaded.length=0,this.loadingAsync.length=0,this.loadingSync.length=0,this.messages.length=0}}},function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,i=t.indexOf("["),s=t.indexOf("]");-1!=i&&-1!=s&&(t=t.substring(0,i)+t.substring(i,s).replace(/:/g,";")+t.substring(s,t.length));for(var o=n.exec(t||""),a={},c=14;c--;)a[r[c]]=o[c]||"";return-1!=i&&-1!=s&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(e){t.exports=function(t){return n&&e.isBuffer(t)||r&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}(t))};var n="function"==typeof e&&"function"==typeof e.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n(34).Buffer)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(71),i=n(51),s=n(20),o=n(33),a=n(52),c=n(53),u=n(26)("socket.io-client:manager"),h=n(50),l=n(88),f=Object.prototype.hasOwnProperty;function d(t,e){if(!(this instanceof d))return new d(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||o;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=d,d.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},d.prototype.updateSocketIds=function(){for(var t in this.nsps)f.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},d.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},s(d.prototype),d.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},d.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},d.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(t,e){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var s=a(n,"open",(function(){i.onopen(),t&&t()})),o=a(n,"error",(function(e){if(u("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var c=this._timeout;u("connect attempt will timeout after %d",c);var h=setTimeout((function(){u("connect attempt timed out after %d",c),s.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",c)}),c);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(s),this.subs.push(o),this},d.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",c(this,"ondata"))),this.subs.push(a(t,"ping",c(this,"onping"))),this.subs.push(a(t,"pong",c(this,"onpong"))),this.subs.push(a(t,"error",c(this,"onerror"))),this.subs.push(a(t,"close",c(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",c(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(t){this.decoder.add(t)},d.prototype.ondecoded=function(t){this.emit("packet",t)},d.prototype.onerror=function(t){u("error",t),this.emitAll("error",t)},d.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new i(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",s),n.on("connect",(function(){n.id=r.generateId(t)})),this.autoConnect&&s()}function s(){~h(r.connecting,n)||r.connecting.push(n)}return n},d.prototype.destroy=function(t){var e=h(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},d.prototype.packet=function(t){u("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()})))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},d.prototype.cleanup=function(){u("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(t){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout((function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(u("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(n)}})}},d.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,n){var r=n(35),i=n(74),s=n(84),o=n(85);e.polling=function(t){var e=!1,n=!1,o=!1!==t.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,c=location.port;c||(c=a?443:80),e=t.hostname!==location.hostname||c!==t.port,n=t.secure!==a}if(t.xdomain=e,t.xscheme=n,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!o)throw new Error("JSONP disabled");return new s(t)},e.websocket=o},function(t,e,n){var r=n(36),i=n(27),s=n(21),o=n(28),a=n(49),c=n(29)("engine.io-client:polling");t.exports=h;var u=null!=new(n(35))({xdomain:!1}).responseType;function h(t){var e=t&&t.forceBase64;u&&!e||(this.supportsBinary=!1),r.call(this,t)}o(h,r),h.prototype.name="polling",h.prototype.doOpen=function(){this.poll()},h.prototype.pause=function(t){var e=this;function n(){c("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--r||n()}))),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){c("pre-pause writing complete"),--r||n()})))}else n()},h.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},h.prototype.onData=function(t){var e=this;c("polling got data %s",t);s.decodePayload(t,this.socket.binaryType,(function(t,n,r){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},h.prototype.doClose=function(){var t=this;function e(){c("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},h.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};s.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,n)}))},h.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t}},function(t,e,n){(function(e){var r=n(76),i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.exports=function t(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,a=n.length;i<a;i++)if(t(n[i]))return!0;return!1}if("function"==typeof e&&e.isBuffer&&e.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||s&&n instanceof Blob||o&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return t(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&t(n[c]))return!0;return!1}}).call(this,n(34).Buffer)},function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={},o=0,a=0;function c(t){var e="";do{e=i[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function u(){var t=c(+new Date);return t!==r?(o=0,r=t):t+"."+c(o++)}for(;a<64;a++)s[i[a]]=a;u.encode=c,u.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=64*e+s[t.charAt(a)];return e},t.exports=u},function(t,e){var n=[].indexOf;t.exports=function(t,e){if(n)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}},function(t,e,n){var r=n(33),i=n(20),s=n(87),o=n(52),a=n(53),c=n(26)("socket.io-client:socket"),u=n(27),h=n(48);t.exports=d;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=i.prototype.emit;function d(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[o(t,"open",a(this,"onopen")),o(t,"packet",a(this,"onpacket")),o(t,"close",a(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},d.prototype.send=function(){var t=s(arguments);return t.unshift("message"),this.emit.apply(this,t),this},d.prototype.emit=function(t){if(l.hasOwnProperty(t))return f.apply(this,arguments),this;var e=s(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:h(e))?r.BINARY_EVENT:r.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},d.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},d.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},d.prototype.onclose=function(t){c("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},d.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===r.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},d.prototype.onevent=function(t){var e=t.data||[];c("emitting event %j",e),null!=t.id&&(c("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?f.apply(this,e):this.receiveBuffer.push(e)},d.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var i=s(arguments);c("sending ack %j",i),e.packet({type:h(i)?r.BINARY_ACK:r.ACK,id:t,data:i})}}},d.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(c("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):c("bad ack %s",t.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)f.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(t){return this.flags.compress=t,this},d.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}},function(t,e){var n=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}},function(t,e,n){var r=n(61),i=n(33),s=n(45),o=n(26)("socket.io-client");t.exports=e=c;var a=e.managers={};function c(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i=r(t),c=i.source,u=i.id,h=i.path,l=a[u]&&h in a[u].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||l?(o("ignoring socket cache for %s",c),n=s(c,e)):(a[u]||(o("new io instance for %s",c),a[u]=s(c,e)),n=a[u]),i.query&&!e.query&&(e.query=i.query),n.socket(i.path,e)}e.protocol=i.protocol,e.connect=c,e.Manager=n(45),e.Socket=n(51)},function(t,e,n){t.exports=function(){return new Worker(n.p+"ResourceLoading.worker.0a3a986b6d94445571d1.js")}},function(t,e,n){"use strict";n.r(e),n.d(e,"Server",(function(){return l}));var r=n(18),i=n(14),s=n(37),o=n(38),a=n(40),c=n(9),u=n(19),h=n(30);class l{constructor(){this.debugMenu=new h.a,this.avatar=new i.d,this.clock=new s.a,this.net=new o.b,this.resources=new a.a,this.snapshot=new c.b,this.userCommands=new u.b,this.init()}async init(){console.log(`Source for this build available at ${r.a}`),this.resources.initialize(),this.clock.initialize(this),this.net.initialize(this),this.avatar.initialize(this),r.b;return setInterval(this.tick.bind(this),16),0}onConnect(t){this.net.onConnect(t)}tick(){const t=performance.now();this.clock.tick(t),this.updateFixed(),this.update()}updateFixed(){for(;this.clock.simAccum>=this.clock.simDt;){this.clock.updateFixed(),this.avatar.updateFixed(this);const t=this.snapshot.createSnapshot(this);this.snapshot.setSnapshot(t),this.net.transmitToClients(t)}}update(){}}},,,,,function(t,e,n){var r=n(41),i=n(26)("socket.io-client:url");t.exports=function(t,e){var n=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),i("parse %s",t),n=r(t));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port,n.href=n.protocol+"://"+s+(e&&e.port===n.port?"":":"+n.port),n}},function(t,e,n){t.exports=function(t){function e(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){let n;function o(...t){if(!o.enabled)return;const e=o,i=Number(new Date),s=i-(n||i);e.diff=s,e.prev=n,e.curr=i,n=i,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return n;a++;const s=r.formatters[i];if("function"==typeof s){const r=t[a];n=s.call(e,r),t.splice(a,1),a--}return n}),r.formatArgs.call(e,t),(e.log||r.log).apply(e,t)}return o.namespace=t,o.enabled=r.enabled(t),o.useColors=r.useColors(),o.color=e(t),o.destroy=i,o.extend=s,"function"==typeof r.init&&r.init(o),r.instances.push(o),o}function i(){const t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function s(t,e){const n=r(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},r.disable=function(){const t=[...r.names.map(o),...r.skips.map(o).map(t=>"-"+t)].join(",");return r.enable(""),t},r.enable=function(t){let e;r.save(t),r.names=[],r.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){const t=r.instances[e];t.enabled=r.enabled(t.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=n(63),Object.keys(t).forEach(e=>{r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},function(t,e){var n=1e3,r=6e4,i=60*r,s=24*i;function o(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}t.exports=function(t,e){e=e||{};var a=typeof t;if("string"===a&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(t);if("number"===a&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=s)return o(t,e,s,"day");if(e>=i)return o(t,e,i,"hour");if(e>=r)return o(t,e,r,"minute");if(e>=n)return o(t,e,n,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=s)return Math.round(t/s)+"d";if(e>=i)return Math.round(t/i)+"h";if(e>=r)return Math.round(t/r)+"m";if(e>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(65)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(s=i))})),t.splice(s,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(32))},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,s=i-(n||i);t.diff=s,t.prev=n,t.curr=i,n=i;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=e.formatters[r];if("function"==typeof i){var s=o[c];n=i.call(t,s),o.splice(c,1),c--}return n})),e.formatArgs.call(t,o);var u=r.log||e.log||console.log.bind(console);u.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var s=e.instances[n];s.enabled=e.enabled(s.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(66),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,s=24*i;function o(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var a,c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(t);if("number"===c&&!1===isNaN(t))return e.long?o(a=t,s,"day")||o(a,i,"hour")||o(a,r,"minute")||o(a,n,"second")||a+" ms":function(t){if(t>=s)return Math.round(t/s)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){var r=n(42),i=n(43),s=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);e.deconstructPacket=function(t){var e=[],n=t.data,s=t;return s.data=function t(e,n){if(!e)return e;if(i(e)){var s={_placeholder:!0,num:n.length};return n.push(e),s}if(r(e)){for(var o=new Array(e.length),a=0;a<e.length;a++)o[a]=t(e[a],n);return o}if("object"==typeof e&&!(e instanceof Date)){o={};for(var c in e)o[c]=t(e[c],n);return o}return e}(n,e),s.attachments=e.length,{packet:s,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(r(e))for(var i=0;i<e.length;i++)e[i]=t(e[i],n);else if("object"==typeof e)for(var s in e)e[s]=t(e[s],n);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var n=0,s=t;!function t(c,u,h){if(!c)return c;if(o&&c instanceof Blob||a&&c instanceof File){n++;var l=new FileReader;l.onload=function(){h?h[u]=this.result:s=this.result,--n||e(s)},l.readAsArrayBuffer(c)}else if(r(c))for(var f=0;f<c.length;f++)t(c[f],f,c);else if("object"==typeof c&&!i(c))for(var d in c)t(c[d],d,c)}(s),n||e(s)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),o=r[0],a=r[1],c=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),h=0,l=a>0?o-4:o;for(n=0;n<l;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],c[h++]=e>>16&255,c[h++]=e>>8&255,c[h++]=255&e;2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,c[h++]=255&e);1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,c[h++]=e>>8&255,c[h++]=255&e);return c},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(h(t,o,o+16383>a?a:o+16383));1===i?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return s.join("")};for(var r=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=o.length;a<c;++a)r[a]=o[a],i[o.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){for(var i,s,o=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var s,o,a=8*i-r-1,c=(1<<a)-1,u=c>>1,h=-7,l=n?i-1:0,f=n?-1:1,d=t[e+l];for(l+=f,s=d&(1<<-h)-1,d>>=-h,h+=a;h>0;s=256*s+t[e+l],l+=f,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=r;h>0;o=256*o+t[e+l],l+=f,h-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=u}return(d?-1:1)*o*Math.pow(2,s-r)},e.write=function(t,e,n,r,i,s){var o,a,c,u=8*s-i-1,h=(1<<u)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+l>=1?f/c:f*Math.pow(2,1-l))*c>=2&&(o++,c/=2),o+l>=h?(a=0,o=h):o+l>=1?(a=(e*c-1)*Math.pow(2,i),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(72),t.exports.parser=n(21)},function(t,e,n){var r=n(46),i=n(20),s=n(29)("engine.io-client:socket"),o=n(50),a=n(21),c=n(41),u=n(27);function h(t,e){if(!(this instanceof h))return new h(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=c(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=c(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=h,h.priorWebsocketSuccess=!1,i(h.prototype),h.protocol=a.protocol,h.Socket=h,h.Transport=n(36),h.transports=n(46),h.parser=n(21),h.prototype.createTransport=function(t){s('creating transport "%s"',t);var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.query);e.EIO=a.protocol,e.transport=t;var n=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},h.prototype.open=function(){var t;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},h.prototype.setTransport=function(t){s("setting transport %s",t.name);var e=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},h.prototype.probe=function(t){s('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(s('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(s('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;h.priorWebsocketSuccess="websocket"===e.name,s('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(s("changing transport and sending upgrade packet"),f(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())}))}else{s('probe transport "%s" failed',t);var o=new Error("probe error");o.transport=e.name,r.emit("upgradeError",o)}})))}function o(){n||(n=!0,f(),e.close(),e=null)}function a(n){var i=new Error("probe error: "+n);i.transport=e.name,o(),s('probe transport "%s" failed because of error: %s',t,n),r.emit("upgradeError",i)}function c(){a("transport closed")}function u(){a("socket closed")}function l(t){e&&t.name!==e.name&&(s('"%s" works - aborting "%s"',t.name,e.name),o())}function f(){e.removeListener("open",i),e.removeListener("error",a),e.removeListener("close",c),r.removeListener("close",u),r.removeListener("upgrading",l)}h.priorWebsocketSuccess=!1,e.once("open",i),e.once("error",a),e.once("close",c),this.once("close",u),this.once("upgrading",l),e.open()},h.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",h.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},h.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else s('packet received with socket readyState "%s"',this.readyState)},h.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},h.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},h.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){s("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},h.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},h.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},h.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},h.prototype.write=h.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},h.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},h.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}function e(){t.onClose("forced close"),s("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function r(){t.once("upgrade",n),t.once("upgradeError",n)}return this},h.prototype.onError=function(t){s("socket error %j",t),h.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},h.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},h.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;n<r;n++)~o(this.transports,t[n])&&e.push(t[n]);return e}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,n){var r=n(35),i=n(47),s=n(20),o=n(28),a=n(29)("engine.io-client:polling-xhr");function c(){}function u(t){if(i.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}}function h(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(t.exports=u,t.exports.Request=h,o(u,i),u.prototype.supportsBinary=!0,u.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new h(t)},u.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),i=this;r.on("success",e),r.on("error",(function(t){i.onError("xhr post error",t)})),this.sendXhr=r},u.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},s(h.prototype),h.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new r(t),n=this;try{a("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.withCredentials),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof e.status?e.status:0)}),0))},a("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){n.onError(t)}),0)}"undefined"!=typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)},h.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},h.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},h.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},h.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete h.requests[this.index],this.xhr=null}},h.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t=("application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},h.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},h.prototype.abort=function(){this.cleanup()},h.requestsCount=0,h.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var l="onpagehide"in self?"pagehide":"unload";addEventListener(l,f,!1)}function f(){for(var t in h.requests)h.requests.hasOwnProperty(t)&&h.requests[t].abort()}},function(t,e){t.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(t),s=new Uint8Array(n-e),o=e,a=0;o<n;o++,a++)s[a]=i[o];return s.buffer}},function(t,e){function n(){}t.exports=function(t,e,r){var i=!1;return r=r||n,s.count=t,0===t?e():s;function s(t,n){if(s.count<=0)throw new Error("after called too many times");--s.count,t?(i=!0,e(t),e=r):0!==s.count||i||e(null,n)}}},function(t,e){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var n,r,i,s=String.fromCharCode;function o(t){for(var e,n,r=[],i=0,s=t.length;i<s;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<s?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function a(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(t,e){return s(t>>e&63|128)}function u(t,e){if(0==(4294967168&t))return s(t);var n="";return 0==(4294965248&t)?n=s(t>>6&31|192):0==(4294901760&t)?(a(t,e)||(t=65533),n=s(t>>12&15|224),n+=c(t,6)):0==(4292870144&t)&&(n=s(t>>18&7|240),n+=c(t,12),n+=c(t,6)),n+=s(63&t|128)}function h(){if(i>=r)throw Error("Invalid byte index");var t=255&n[i];if(i++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function l(t){var e,s;if(i>r)throw Error("Invalid byte index");if(i==r)return!1;if(e=255&n[i],i++,0==(128&e))return e;if(192==(224&e)){if((s=(31&e)<<6|h())>=128)return s;throw Error("Invalid continuation byte")}if(224==(240&e)){if((s=(15&e)<<12|h()<<6|h())>=2048)return a(s,t)?s:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(s=(7&e)<<18|h()<<12|h()<<6|h())>=65536&&s<=1114111)return s;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,e){for(var n=!1!==(e=e||{}).strict,r=o(t),i=r.length,s=-1,a="";++s<i;)a+=u(r[s],n);return a},decode:function(t,e){var a=!1!==(e=e||{}).strict;n=o(t),r=n.length,i=0;for(var c,u=[];!1!==(c=l(a));)u.push(c);return function(t){for(var e,n=t.length,r=-1,i="";++r<n;)(e=t[r])>65535&&(i+=s((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=s(e);return i}(u)}}},function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<t.length;r++)n[t.charCodeAt(r)]=r;e.encode=function(e){var n,r=new Uint8Array(e),i=r.length,s="";for(n=0;n<i;n+=3)s+=t[r[n]>>2],s+=t[(3&r[n])<<4|r[n+1]>>4],s+=t[(15&r[n+1])<<2|r[n+2]>>6],s+=t[63&r[n+2]];return i%3==2?s=s.substring(0,s.length-1)+"=":i%3==1&&(s=s.substring(0,s.length-2)+"=="),s},e.decode=function(t){var e,r,i,s,o,a=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var h=new ArrayBuffer(a),l=new Uint8Array(h);for(e=0;e<c;e+=4)r=n[t.charCodeAt(e)],i=n[t.charCodeAt(e+1)],s=n[t.charCodeAt(e+2)],o=n[t.charCodeAt(e+3)],l[u++]=r<<2|i>>4,l[u++]=(15&i)<<4|s>>2,l[u++]=(3&s)<<6|63&o;return h}}()},function(t,e){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),s=n&&n.prototype.append&&n.prototype.getBlob;function o(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=n.buffer}return e}return t}))}function a(t,e){e=e||{};var r=new n;return o(t).forEach((function(t){r.append(t)})),e.type?r.getBlob(e.type):r.getBlob()}function c(t,e){return new Blob(o(t),e||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,c.prototype=Blob.prototype),t.exports=r?i?Blob:c:s?a:void 0},function(t,e,n){t.exports=function(t){function e(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){let n;function o(...t){if(!o.enabled)return;const e=o,i=Number(new Date),s=i-(n||i);e.diff=s,e.prev=n,e.curr=i,n=i,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return n;a++;const s=r.formatters[i];if("function"==typeof s){const r=t[a];n=s.call(e,r),t.splice(a,1),a--}return n}),r.formatArgs.call(e,t),(e.log||r.log).apply(e,t)}return o.namespace=t,o.enabled=r.enabled(t),o.useColors=r.useColors(),o.color=e(t),o.destroy=i,o.extend=s,"function"==typeof r.init&&r.init(o),r.instances.push(o),o}function i(){const t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function s(t,e){const n=r(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},r.disable=function(){const t=[...r.names.map(o),...r.skips.map(o).map(t=>"-"+t)].join(",");return r.enable(""),t},r.enable=function(t){let e;r.save(t),r.names=[],r.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){const t=r.instances[e];t.enabled=r.enabled(t.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=n(83),Object.keys(t).forEach(e=>{r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},function(t,e){var n=1e3,r=6e4,i=60*r,s=24*i;function o(t,e,n,r){var i=e>=1.5*n;return Math.round(t/n)+" "+r+(i?"s":"")}t.exports=function(t,e){e=e||{};var a=typeof t;if("string"===a&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(t);if("number"===a&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=s)return o(t,e,s,"day");if(e>=i)return o(t,e,i,"hour");if(e>=r)return o(t,e,r,"minute");if(e>=n)return o(t,e,n,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=s)return Math.round(t/s)+"d";if(e>=i)return Math.round(t/i)+"h";if(e>=r)return Math.round(t/r)+"m";if(e>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(e){var r=n(47),i=n(28);t.exports=h;var s,o=/\n/g,a=/\\n/g;function c(){}function u(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{}}function h(t){if(r.call(this,t),this.query=this.query||{},!s){var e=u();s=e.___eio=e.___eio||[]}this.index=s.length;var n=this;s.push((function(t){n.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=c)}),!1)}i(h,r),h.prototype.supportsBinary=!1,h.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},h.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},h.prototype.doWrite=function(t,e){var n=this;if(!this.form){var r,i=document.createElement("form"),s=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=c,i.method="POST",i.setAttribute("accept-charset","utf-8"),s.name="d",i.appendChild(s),document.body.appendChild(i),this.form=i,this.area=s}function u(){h(),e()}function h(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(t)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),h(),t=t.replace(a,"\\\n"),this.area.value=t.replace(o,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,n(44))},function(t,e,n){(function(e){var r,i,s=n(36),o=n(21),a=n(27),c=n(28),u=n(49),h=n(29)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{i=n(86)}catch(t){}var l=r||i;function f(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=r&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(l=i),s.call(this,t)}t.exports=f,c(f,s),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new l(t,e):new l(t):new l(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},f.prototype.write=function(t){var n=this;this.writable=!1;for(var r=t.length,i=0,s=r;i<s;i++)!function(t){o.encodePacket(t,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var s={};if(t.options&&(s.compress=t.options.compress),n.perMessageDeflate)("string"==typeof i?e.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(s.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,s)}catch(t){h("websocket closed before onclose event")}--r||a()}))}(t[i]);function a(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},f.prototype.onClose=function(){s.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=u()),this.supportsBinary||(t.b64=1),(t=a.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},f.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===f.prototype.name)}}).call(this,n(34).Buffer)},function(t,e){},function(t,e){t.exports=function(t,e){for(var n=[],r=(e=e||0)||0;r<t.length;r++)n[r-e]=t[r];return n}},function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}}]);