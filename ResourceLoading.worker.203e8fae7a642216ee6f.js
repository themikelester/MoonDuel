!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}({4:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"create",(function(){return z})),n.d(r,"clone",(function(){return E})),n.d(r,"copy",(function(){return k})),n.d(r,"fromValues",(function(){return C})),n.d(r,"set",(function(){return O})),n.d(r,"identity",(function(){return F})),n.d(r,"transpose",(function(){return N})),n.d(r,"invert",(function(){return U})),n.d(r,"adjoint",(function(){return V})),n.d(r,"determinant",(function(){return B})),n.d(r,"multiply",(function(){return R})),n.d(r,"translate",(function(){return j})),n.d(r,"scale",(function(){return D})),n.d(r,"rotate",(function(){return q})),n.d(r,"rotateX",(function(){return P})),n.d(r,"rotateY",(function(){return L})),n.d(r,"rotateZ",(function(){return W})),n.d(r,"fromTranslation",(function(){return H})),n.d(r,"fromScaling",(function(){return X})),n.d(r,"fromRotation",(function(){return Z})),n.d(r,"fromXRotation",(function(){return Y})),n.d(r,"fromYRotation",(function(){return G})),n.d(r,"fromZRotation",(function(){return Q})),n.d(r,"fromRotationTranslation",(function(){return J})),n.d(r,"fromQuat2",(function(){return K})),n.d(r,"getTranslation",(function(){return $})),n.d(r,"getScaling",(function(){return tt})),n.d(r,"getRotation",(function(){return et})),n.d(r,"fromRotationTranslationScale",(function(){return nt})),n.d(r,"fromRotationTranslationScaleOrigin",(function(){return rt})),n.d(r,"fromQuat",(function(){return it})),n.d(r,"frustum",(function(){return at})),n.d(r,"perspective",(function(){return st})),n.d(r,"perspectiveFromFieldOfView",(function(){return ot})),n.d(r,"ortho",(function(){return ut})),n.d(r,"lookAt",(function(){return ht})),n.d(r,"targetTo",(function(){return ct})),n.d(r,"str",(function(){return lt})),n.d(r,"frob",(function(){return ft})),n.d(r,"add",(function(){return dt})),n.d(r,"subtract",(function(){return pt})),n.d(r,"multiplyScalar",(function(){return mt})),n.d(r,"multiplyScalarAndAdd",(function(){return yt})),n.d(r,"exactEquals",(function(){return vt})),n.d(r,"equals",(function(){return gt})),n.d(r,"mul",(function(){return _t})),n.d(r,"sub",(function(){return xt}));var i={};n.r(i),n.d(i,"create",(function(){return bt})),n.d(i,"clone",(function(){return Mt})),n.d(i,"length",(function(){return wt})),n.d(i,"fromValues",(function(){return At})),n.d(i,"copy",(function(){return St})),n.d(i,"set",(function(){return Tt})),n.d(i,"add",(function(){return It})),n.d(i,"subtract",(function(){return zt})),n.d(i,"multiply",(function(){return Et})),n.d(i,"divide",(function(){return kt})),n.d(i,"ceil",(function(){return Ct})),n.d(i,"floor",(function(){return Ot})),n.d(i,"min",(function(){return Ft})),n.d(i,"max",(function(){return Nt})),n.d(i,"round",(function(){return Ut})),n.d(i,"scale",(function(){return Vt})),n.d(i,"scaleAndAdd",(function(){return Bt})),n.d(i,"distance",(function(){return Rt})),n.d(i,"squaredDistance",(function(){return jt})),n.d(i,"squaredLength",(function(){return Dt})),n.d(i,"negate",(function(){return qt})),n.d(i,"inverse",(function(){return Pt})),n.d(i,"normalize",(function(){return Lt})),n.d(i,"dot",(function(){return Wt})),n.d(i,"cross",(function(){return Ht})),n.d(i,"lerp",(function(){return Xt})),n.d(i,"hermite",(function(){return Zt})),n.d(i,"bezier",(function(){return Yt})),n.d(i,"random",(function(){return Gt})),n.d(i,"transformMat4",(function(){return Qt})),n.d(i,"transformMat3",(function(){return Jt})),n.d(i,"transformQuat",(function(){return Kt})),n.d(i,"rotateX",(function(){return $t})),n.d(i,"rotateY",(function(){return te})),n.d(i,"rotateZ",(function(){return ee})),n.d(i,"angle",(function(){return ne})),n.d(i,"zero",(function(){return re})),n.d(i,"str",(function(){return ie})),n.d(i,"exactEquals",(function(){return ae})),n.d(i,"equals",(function(){return se})),n.d(i,"sub",(function(){return ue})),n.d(i,"mul",(function(){return he})),n.d(i,"div",(function(){return ce})),n.d(i,"dist",(function(){return le})),n.d(i,"sqrDist",(function(){return fe})),n.d(i,"len",(function(){return de})),n.d(i,"sqrLen",(function(){return pe})),n.d(i,"forEach",(function(){return me}));var a,s={};n.r(s),n.d(s,"create",(function(){return ge})),n.d(s,"identity",(function(){return _e})),n.d(s,"setAxisAngle",(function(){return xe})),n.d(s,"getAxisAngle",(function(){return be})),n.d(s,"getAngle",(function(){return Me})),n.d(s,"multiply",(function(){return we})),n.d(s,"rotateX",(function(){return Ae})),n.d(s,"rotateY",(function(){return Se})),n.d(s,"rotateZ",(function(){return Te})),n.d(s,"calculateW",(function(){return Ie})),n.d(s,"exp",(function(){return ze})),n.d(s,"ln",(function(){return Ee})),n.d(s,"pow",(function(){return ke})),n.d(s,"slerp",(function(){return Ce})),n.d(s,"random",(function(){return Oe})),n.d(s,"invert",(function(){return Fe})),n.d(s,"conjugate",(function(){return Ne})),n.d(s,"fromMat3",(function(){return Ue})),n.d(s,"fromEuler",(function(){return Ve})),n.d(s,"str",(function(){return Be})),n.d(s,"clone",(function(){return He})),n.d(s,"fromValues",(function(){return Xe})),n.d(s,"copy",(function(){return Ze})),n.d(s,"set",(function(){return Ye})),n.d(s,"add",(function(){return Ge})),n.d(s,"mul",(function(){return Qe})),n.d(s,"scale",(function(){return Je})),n.d(s,"dot",(function(){return Ke})),n.d(s,"lerp",(function(){return $e})),n.d(s,"length",(function(){return tn})),n.d(s,"len",(function(){return en})),n.d(s,"squaredLength",(function(){return nn})),n.d(s,"sqrLen",(function(){return rn})),n.d(s,"normalize",(function(){return an})),n.d(s,"exactEquals",(function(){return sn})),n.d(s,"equals",(function(){return on})),n.d(s,"rotationTo",(function(){return un})),n.d(s,"sqlerp",(function(){return hn})),n.d(s,"setAxes",(function(){return cn})),function(t){t[t.LoadingAsync=0]="LoadingAsync",t[t.LoadingSync=1]="LoadingSync",t[t.Loaded=2]="Loaded",t[t.Unloaded=3]="Unloaded",t[t.Failed=4]="Failed"}(a||(a={}));var o,u,h,c,l,f,d,p,m,y,v,g,_,x;function b(t,e=""){if(!t){const t=new Error(`Assert fail: ${e}`);throw console.error(t.stack),t}}function M(t,e){if(null!=t)return t;throw new Error(A(e,"Missing object"))}function w(t){return null!=t}function A(t,e){return null!=t?t:e}!function(t){t[t.VertexArrayObject=1]="VertexArrayObject",t[t.TextureFloat=2]="TextureFloat",t[t.TextureHalf=4]="TextureHalf",t[t.TextureFloatLinearFiltering=8]="TextureFloatLinearFiltering",t[t.TextureHalfLinearFiltering=16]="TextureHalfLinearFiltering",t[t.TextureWrite=32]="TextureWrite",t[t.ShaderDerivatives=64]="ShaderDerivatives",t[t.Instancing=128]="Instancing",t[t.AnistropicFiltering=256]="AnistropicFiltering",t[t.ShaderGlsl100=512]="ShaderGlsl100",t[t.ShaderGlsl300=1024]="ShaderGlsl300"}(o||(o={})),function(t){t[t.Undefined=0]="Undefined",t[t.Float=1]="Float",t[t.Float2=2]="Float2",t[t.Float3=3]="Float3",t[t.Float4=4]="Float4",t[t.Int=5]="Int",t[t.Int2=6]="Int2",t[t.Int3=7]="Int3",t[t.Int4=8]="Int4",t[t.Uint=9]="Uint",t[t.Uint2=10]="Uint2",t[t.Uint3=11]="Uint3",t[t.Uint4=12]="Uint4",t[t.Short=13]="Short",t[t.Short2=14]="Short2",t[t.Short3=15]="Short3",t[t.Short4=16]="Short4",t[t.Ushort=17]="Ushort",t[t.Ushort2=18]="Ushort2",t[t.Ushort3=19]="Ushort3",t[t.Ushort4=20]="Ushort4",t[t.Char=21]="Char",t[t.Char2=22]="Char2",t[t.Char3=23]="Char3",t[t.Char4=24]="Char4",t[t.Uchar=25]="Uchar",t[t.Uchar2=26]="Uchar2",t[t.Uchar3=27]="Uchar3",t[t.Uchar4=28]="Uchar4",t[t.Half=29]="Half",t[t.Half2=30]="Half2",t[t.Half3=31]="Half3",t[t.Half4=32]="Half4",t[t.Float3x3=33]="Float3x3",t[t.Float3x4=34]="Float3x4",t[t.Float4x4=35]="Float4x4",t[t.Texture2D=240]="Texture2D",t[t.Texture3D=241]="Texture3D",t[t.TextureCube=242]="TextureCube",t[t.Short_Norm=256]="Short_Norm",t[t.Short2_Norm=257]="Short2_Norm",t[t.Short3_Norm=258]="Short3_Norm",t[t.Short4_Norm=259]="Short4_Norm",t[t.Ushort_Norm=260]="Ushort_Norm",t[t.Ushort2_Norm=261]="Ushort2_Norm",t[t.Ushort3_Norm=262]="Ushort3_Norm",t[t.Ushort4_Norm=263]="Ushort4_Norm",t[t.Char_Norm=264]="Char_Norm",t[t.Char2_Norm=265]="Char2_Norm",t[t.Char3_Norm=266]="Char3_Norm",t[t.Char4_Norm=267]="Char4_Norm",t[t.Uchar_Norm=268]="Uchar_Norm",t[t.Uchar2_Norm=269]="Uchar2_Norm",t[t.Uchar3_Norm=270]="Uchar3_Norm",t[t.Uchar4_Norm=271]="Uchar4_Norm"}(u||(u={})),function(t){t[t.Texture2D=240]="Texture2D",t[t.Texture3D=241]="Texture3D",t[t.TextureCube=242]="TextureCube"}(h||(h={})),function(t){t[t.Undefined=0]="Undefined",t[t.U565=1]="U565",t[t.U8=2]="U8",t[t.U8_sRGB=3]="U8_sRGB",t[t.U8x2=4]="U8x2",t[t.U8x2_sRGB=5]="U8x2_sRGB",t[t.U8x3=6]="U8x3",t[t.U8x3_sRGB=7]="U8x3_sRGB",t[t.U8x4=8]="U8x4",t[t.U8x4_sRGB=9]="U8x4_sRGB",t[t.U10_10_10_2=10]="U10_10_10_2",t[t.F11_11_10=11]="F11_11_10",t[t.F16=12]="F16",t[t.F16x2=13]="F16x2",t[t.F16x3=14]="F16x3",t[t.F16x4=15]="F16x4",t[t.F32x2=16]="F32x2",t[t.F32x3=17]="F32x3",t[t.F32x4=18]="F32x4",t[t.Depth32=19]="Depth32",t[t.Depth24Stencil8=20]="Depth24Stencil8"}(c||(c={})),function(t){t[t.Nearest=0]="Nearest",t[t.Linear=1]="Linear"}(l||(l={})),function(t){t[t.Clamp=0]="Clamp",t[t.Repeat=1]="Repeat"}(f||(f={})),function(t){t[t.Never=0]="Never",t[t.Less=1]="Less",t[t.Equal=2]="Equal",t[t.LessEqual=3]="LessEqual",t[t.Greater=4]="Greater",t[t.NotEqual=5]="NotEqual",t[t.GreaterEqual=6]="GreaterEqual",t[t.Always=7]="Always"}(d||(d={})),function(t){t[t.Points=0]="Points",t[t.Lines=1]="Lines",t[t.LineLoop=2]="LineLoop",t[t.LineStrip=3]="LineStrip",t[t.Triangles=4]="Triangles",t[t.TriangleStrip=5]="TriangleStrip",t[t.TriangleFan=6]="TriangleFan"}(p||(p={})),function(t){t[t.Undefined=0]="Undefined",t[t.Uniform=1]="Uniform",t[t.Vertex=2]="Vertex",t[t.Index=3]="Index",t[t.Readback=4]="Readback"}(m||(m={})),function(t){t[t.Undefined=0]="Undefined",t[t.UniformBuffer=1]="UniformBuffer",t[t.Texture=2]="Texture"}(y||(y={})),function(t){t[t.None=0]="None",t[t.Static=1]="Static",t[t.Dynamic=2]="Dynamic"}(v||(v={})),function(t){t[t.None=0]="None",t[t.Back=1]="Back",t[t.Front=2]="Front"}(g||(g={})),function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Source=2]="Source",t[t.OneMinusSource=3]="OneMinusSource"}(_||(_={})),function(t){t[t.Vertex=0]="Vertex",t[t.Instance=1]="Instance"}(x||(x={}));var S=1e-6,T="undefined"!=typeof Float32Array?Float32Array:Array,I=Math.random;Math.PI;function z(){var t=new T(16);return T!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function E(t){var e=new T(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function k(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function C(t,e,n,r,i,a,s,o,u,h,c,l,f,d,p,m){var y=new T(16);return y[0]=t,y[1]=e,y[2]=n,y[3]=r,y[4]=i,y[5]=a,y[6]=s,y[7]=o,y[8]=u,y[9]=h,y[10]=c,y[11]=l,y[12]=f,y[13]=d,y[14]=p,y[15]=m,y}function O(t,e,n,r,i,a,s,o,u,h,c,l,f,d,p,m,y){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t[8]=h,t[9]=c,t[10]=l,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=y,t}function F(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function U(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],v=e[15],g=n*o-r*s,_=n*u-i*s,x=n*h-a*s,b=r*u-i*o,M=r*h-a*o,w=i*h-a*u,A=c*m-l*p,S=c*y-f*p,T=c*v-d*p,I=l*y-f*m,z=l*v-d*m,E=f*v-d*y,k=g*E-_*z+x*I+b*T-M*S+w*A;return k?(k=1/k,t[0]=(o*E-u*z+h*I)*k,t[1]=(i*z-r*E-a*I)*k,t[2]=(m*w-y*M+v*b)*k,t[3]=(f*M-l*w-d*b)*k,t[4]=(u*T-s*E-h*S)*k,t[5]=(n*E-i*T+a*S)*k,t[6]=(y*x-p*w-v*_)*k,t[7]=(c*w-f*x+d*_)*k,t[8]=(s*z-o*T+h*A)*k,t[9]=(r*T-n*z-a*A)*k,t[10]=(p*M-m*x+v*g)*k,t[11]=(l*x-c*M-d*g)*k,t[12]=(o*S-s*I-u*A)*k,t[13]=(n*I-r*S+i*A)*k,t[14]=(m*_-p*b-y*g)*k,t[15]=(c*b-l*_+f*g)*k,t):null}function V(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],y=e[14],v=e[15];return t[0]=o*(f*v-d*y)-l*(u*v-h*y)+m*(u*d-h*f),t[1]=-(r*(f*v-d*y)-l*(i*v-a*y)+m*(i*d-a*f)),t[2]=r*(u*v-h*y)-o*(i*v-a*y)+m*(i*h-a*u),t[3]=-(r*(u*d-h*f)-o*(i*d-a*f)+l*(i*h-a*u)),t[4]=-(s*(f*v-d*y)-c*(u*v-h*y)+p*(u*d-h*f)),t[5]=n*(f*v-d*y)-c*(i*v-a*y)+p*(i*d-a*f),t[6]=-(n*(u*v-h*y)-s*(i*v-a*y)+p*(i*h-a*u)),t[7]=n*(u*d-h*f)-s*(i*d-a*f)+c*(i*h-a*u),t[8]=s*(l*v-d*m)-c*(o*v-h*m)+p*(o*d-h*l),t[9]=-(n*(l*v-d*m)-c*(r*v-a*m)+p*(r*d-a*l)),t[10]=n*(o*v-h*m)-s*(r*v-a*m)+p*(r*h-a*o),t[11]=-(n*(o*d-h*l)-s*(r*d-a*l)+c*(r*h-a*o)),t[12]=-(s*(l*y-f*m)-c*(o*y-u*m)+p*(o*f-u*l)),t[13]=n*(l*y-f*m)-c*(r*y-i*m)+p*(r*f-i*l),t[14]=-(n*(o*y-u*m)-s*(r*y-i*m)+p*(r*u-i*o)),t[15]=n*(o*f-u*l)-s*(r*f-i*l)+c*(r*u-i*o),t}function B(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8],c=t[9],l=t[10],f=t[11],d=t[12],p=t[13],m=t[14],y=t[15];return(e*s-n*a)*(l*y-f*m)-(e*o-r*a)*(c*y-f*p)+(e*u-i*a)*(c*m-l*p)+(n*o-r*s)*(h*y-f*d)-(n*u-i*s)*(h*m-l*d)+(r*u-i*o)*(h*p-c*d)}function R(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=e[9],d=e[10],p=e[11],m=e[12],y=e[13],v=e[14],g=e[15],_=n[0],x=n[1],b=n[2],M=n[3];return t[0]=_*r+x*o+b*l+M*m,t[1]=_*i+x*u+b*f+M*y,t[2]=_*a+x*h+b*d+M*v,t[3]=_*s+x*c+b*p+M*g,_=n[4],x=n[5],b=n[6],M=n[7],t[4]=_*r+x*o+b*l+M*m,t[5]=_*i+x*u+b*f+M*y,t[6]=_*a+x*h+b*d+M*v,t[7]=_*s+x*c+b*p+M*g,_=n[8],x=n[9],b=n[10],M=n[11],t[8]=_*r+x*o+b*l+M*m,t[9]=_*i+x*u+b*f+M*y,t[10]=_*a+x*h+b*d+M*v,t[11]=_*s+x*c+b*p+M*g,_=n[12],x=n[13],b=n[14],M=n[15],t[12]=_*r+x*o+b*l+M*m,t[13]=_*i+x*u+b*f+M*y,t[14]=_*a+x*h+b*d+M*v,t[15]=_*s+x*c+b*p+M*g,t}function j(t,e,n){var r,i,a,s,o,u,h,c,l,f,d,p,m=n[0],y=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*v+e[12],t[13]=e[1]*m+e[5]*y+e[9]*v+e[13],t[14]=e[2]*m+e[6]*y+e[10]*v+e[14],t[15]=e[3]*m+e[7]*y+e[11]*v+e[15]):(r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=u,t[6]=h,t[7]=c,t[8]=l,t[9]=f,t[10]=d,t[11]=p,t[12]=r*m+o*y+l*v+e[12],t[13]=i*m+u*y+f*v+e[13],t[14]=a*m+h*y+d*v+e[14],t[15]=s*m+c*y+p*v+e[15]),t}function D(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function q(t,e,n,r){var i,a,s,o,u,h,c,l,f,d,p,m,y,v,g,_,x,b,M,w,A,T,I,z,E=r[0],k=r[1],C=r[2],O=Math.hypot(E,k,C);return O<S?null:(E*=O=1/O,k*=O,C*=O,i=Math.sin(n),s=1-(a=Math.cos(n)),o=e[0],u=e[1],h=e[2],c=e[3],l=e[4],f=e[5],d=e[6],p=e[7],m=e[8],y=e[9],v=e[10],g=e[11],_=E*E*s+a,x=k*E*s+C*i,b=C*E*s-k*i,M=E*k*s-C*i,w=k*k*s+a,A=C*k*s+E*i,T=E*C*s+k*i,I=k*C*s-E*i,z=C*C*s+a,t[0]=o*_+l*x+m*b,t[1]=u*_+f*x+y*b,t[2]=h*_+d*x+v*b,t[3]=c*_+p*x+g*b,t[4]=o*M+l*w+m*A,t[5]=u*M+f*w+y*A,t[6]=h*M+d*w+v*A,t[7]=c*M+p*w+g*A,t[8]=o*T+l*I+m*z,t[9]=u*T+f*I+y*z,t[10]=h*T+d*I+v*z,t[11]=c*T+p*I+g*z,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function P(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],s=e[5],o=e[6],u=e[7],h=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+h*r,t[5]=s*i+c*r,t[6]=o*i+l*r,t[7]=u*i+f*r,t[8]=h*i-a*r,t[9]=c*i-s*r,t[10]=l*i-o*r,t[11]=f*i-u*r,t}function L(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],s=e[1],o=e[2],u=e[3],h=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-h*r,t[1]=s*i-c*r,t[2]=o*i-l*r,t[3]=u*i-f*r,t[8]=a*r+h*i,t[9]=s*r+c*i,t[10]=o*r+l*i,t[11]=u*r+f*i,t}function W(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],s=e[1],o=e[2],u=e[3],h=e[4],c=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+h*r,t[1]=s*i+c*r,t[2]=o*i+l*r,t[3]=u*i+f*r,t[4]=h*i-a*r,t[5]=c*i-s*r,t[6]=l*i-o*r,t[7]=f*i-u*r,t}function H(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function X(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Z(t,e,n){var r,i,a,s=n[0],o=n[1],u=n[2],h=Math.hypot(s,o,u);return h<S?null:(s*=h=1/h,o*=h,u*=h,r=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=s*s*a+i,t[1]=o*s*a+u*r,t[2]=u*s*a-o*r,t[3]=0,t[4]=s*o*a-u*r,t[5]=o*o*a+i,t[6]=u*o*a+s*r,t[7]=0,t[8]=s*u*a+o*r,t[9]=o*u*a-s*r,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Y(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Q(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function J(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=r+r,u=i+i,h=a+a,c=r*o,l=r*u,f=r*h,d=i*u,p=i*h,m=a*h,y=s*o,v=s*u,g=s*h;return t[0]=1-(d+m),t[1]=l+g,t[2]=f-v,t[3]=0,t[4]=l-g,t[5]=1-(c+m),t[6]=p+y,t[7]=0,t[8]=f+v,t[9]=p-y,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function K(t,e){var n=new T(3),r=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=r*r+i*i+a*a+s*s;return l>0?(n[0]=2*(o*s+c*r+u*a-h*i)/l,n[1]=2*(u*s+c*i+h*r-o*a)/l,n[2]=2*(h*s+c*a+o*i-u*r)/l):(n[0]=2*(o*s+c*r+u*a-h*i),n[1]=2*(u*s+c*i+h*r-o*a),n[2]=2*(h*s+c*a+o*i-u*r)),J(t,e,n),t}function $(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function tt(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],s=e[5],o=e[6],u=e[8],h=e[9],c=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(a,s,o),t[2]=Math.hypot(u,h,c),t}function et(t,e){var n=new T(3);tt(n,e);var r=1/n[0],i=1/n[1],a=1/n[2],s=e[0]*r,o=e[1]*i,u=e[2]*a,h=e[4]*r,c=e[5]*i,l=e[6]*a,f=e[8]*r,d=e[9]*i,p=e[10]*a,m=s+c+p,y=0;return m>0?(y=2*Math.sqrt(m+1),t[3]=.25*y,t[0]=(l-d)/y,t[1]=(f-u)/y,t[2]=(o-h)/y):s>c&&s>p?(y=2*Math.sqrt(1+s-c-p),t[3]=(l-d)/y,t[0]=.25*y,t[1]=(o+h)/y,t[2]=(f+u)/y):c>p?(y=2*Math.sqrt(1+c-s-p),t[3]=(f-u)/y,t[0]=(o+h)/y,t[1]=.25*y,t[2]=(l+d)/y):(y=2*Math.sqrt(1+p-s-c),t[3]=(o-h)/y,t[0]=(f+u)/y,t[1]=(l+d)/y,t[2]=.25*y),t}function nt(t,e,n,r){var i=e[0],a=e[1],s=e[2],o=e[3],u=i+i,h=a+a,c=s+s,l=i*u,f=i*h,d=i*c,p=a*h,m=a*c,y=s*c,v=o*u,g=o*h,_=o*c,x=r[0],b=r[1],M=r[2];return t[0]=(1-(p+y))*x,t[1]=(f+_)*x,t[2]=(d-g)*x,t[3]=0,t[4]=(f-_)*b,t[5]=(1-(l+y))*b,t[6]=(m+v)*b,t[7]=0,t[8]=(d+g)*M,t[9]=(m-v)*M,t[10]=(1-(l+p))*M,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function rt(t,e,n,r,i){var a=e[0],s=e[1],o=e[2],u=e[3],h=a+a,c=s+s,l=o+o,f=a*h,d=a*c,p=a*l,m=s*c,y=s*l,v=o*l,g=u*h,_=u*c,x=u*l,b=r[0],M=r[1],w=r[2],A=i[0],S=i[1],T=i[2],I=(1-(m+v))*b,z=(d+x)*b,E=(p-_)*b,k=(d-x)*M,C=(1-(f+v))*M,O=(y+g)*M,F=(p+_)*w,N=(y-g)*w,U=(1-(f+m))*w;return t[0]=I,t[1]=z,t[2]=E,t[3]=0,t[4]=k,t[5]=C,t[6]=O,t[7]=0,t[8]=F,t[9]=N,t[10]=U,t[11]=0,t[12]=n[0]+A-(I*A+k*S+F*T),t[13]=n[1]+S-(z*A+C*S+N*T),t[14]=n[2]+T-(E*A+O*S+U*T),t[15]=1,t}function it(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n+n,o=r+r,u=i+i,h=n*s,c=r*s,l=r*o,f=i*s,d=i*o,p=i*u,m=a*s,y=a*o,v=a*u;return t[0]=1-l-p,t[1]=c+v,t[2]=f-y,t[3]=0,t[4]=c-v,t[5]=1-h-p,t[6]=d+m,t[7]=0,t[8]=f+y,t[9]=d-m,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function at(t,e,n,r,i,a,s){var o=1/(n-e),u=1/(i-r),h=1/(a-s);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*u,t[10]=(s+a)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*h,t[15]=0,t}function st(t,e,n,r,i){var a,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function ot(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+o),h=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(s-o)*u*.5,t[9]=(i-a)*h*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function ut(t,e,n,r,i,a,s){var o=1/(e-n),u=1/(r-i),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*u,t[14]=(s+a)*h,t[15]=1,t}function ht(t,e,n,r){var i,a,s,o,u,h,c,l,f,d,p=e[0],m=e[1],y=e[2],v=r[0],g=r[1],_=r[2],x=n[0],b=n[1],M=n[2];return Math.abs(p-x)<S&&Math.abs(m-b)<S&&Math.abs(y-M)<S?F(t):(c=p-x,l=m-b,f=y-M,i=g*(f*=d=1/Math.hypot(c,l,f))-_*(l*=d),a=_*(c*=d)-v*f,s=v*l-g*c,(d=Math.hypot(i,a,s))?(i*=d=1/d,a*=d,s*=d):(i=0,a=0,s=0),o=l*s-f*a,u=f*i-c*s,h=c*a-l*i,(d=Math.hypot(o,u,h))?(o*=d=1/d,u*=d,h*=d):(o=0,u=0,h=0),t[0]=i,t[1]=o,t[2]=c,t[3]=0,t[4]=a,t[5]=u,t[6]=l,t[7]=0,t[8]=s,t[9]=h,t[10]=f,t[11]=0,t[12]=-(i*p+a*m+s*y),t[13]=-(o*p+u*m+h*y),t[14]=-(c*p+l*m+f*y),t[15]=1,t)}function ct(t,e,n,r){var i=e[0],a=e[1],s=e[2],o=r[0],u=r[1],h=r[2],c=i-n[0],l=a-n[1],f=s-n[2],d=c*c+l*l+f*f;d>0&&(c*=d=1/Math.sqrt(d),l*=d,f*=d);var p=u*f-h*l,m=h*c-o*f,y=o*l-u*c;return(d=p*p+m*m+y*y)>0&&(p*=d=1/Math.sqrt(d),m*=d,y*=d),t[0]=p,t[1]=m,t[2]=y,t[3]=0,t[4]=l*y-f*m,t[5]=f*p-c*y,t[6]=c*m-l*p,t[7]=0,t[8]=c,t[9]=l,t[10]=f,t[11]=0,t[12]=i,t[13]=a,t[14]=s,t[15]=1,t}function lt(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ft(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function dt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function pt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function mt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function yt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function vt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function gt(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],c=t[8],l=t[9],f=t[10],d=t[11],p=t[12],m=t[13],y=t[14],v=t[15],g=e[0],_=e[1],x=e[2],b=e[3],M=e[4],w=e[5],A=e[6],T=e[7],I=e[8],z=e[9],E=e[10],k=e[11],C=e[12],O=e[13],F=e[14],N=e[15];return Math.abs(n-g)<=S*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-_)<=S*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-x)<=S*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-b)<=S*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(s-M)<=S*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(o-w)<=S*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(u-A)<=S*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(h-T)<=S*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(c-I)<=S*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(l-z)<=S*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(f-E)<=S*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(d-k)<=S*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-C)<=S*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-O)<=S*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(y-F)<=S*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(v-N)<=S*Math.max(1,Math.abs(v),Math.abs(N))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var _t=R,xt=pt;function bt(){var t=new T(3);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Mt(t){var e=new T(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function wt(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function At(t,e,n){var r=new T(3);return r[0]=t,r[1]=e,r[2]=n,r}function St(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Tt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function It(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function zt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Et(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function kt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ct(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Ot(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Ft(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Nt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Ut(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Vt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Bt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Rt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function jt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Dt(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function qt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Pt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Lt(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function Wt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ht(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[0],o=n[1],u=n[2];return t[0]=i*u-a*o,t[1]=a*s-r*u,t[2]=r*o-i*s,t}function Xt(t,e,n,r){var i=e[0],a=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=s+r*(n[2]-s),t}function Zt(t,e,n,r,i,a){var s=a*a,o=s*(2*a-3)+1,u=s*(a-2)+a,h=s*(a-1),c=s*(3-2*a);return t[0]=e[0]*o+n[0]*u+r[0]*h+i[0]*c,t[1]=e[1]*o+n[1]*u+r[1]*h+i[1]*c,t[2]=e[2]*o+n[2]*u+r[2]*h+i[2]*c,t}function Yt(t,e,n,r,i,a){var s=1-a,o=s*s,u=a*a,h=o*s,c=3*a*o,l=3*u*s,f=u*a;return t[0]=e[0]*h+n[0]*c+r[0]*l+i[0]*f,t[1]=e[1]*h+n[1]*c+r[1]*l+i[1]*f,t[2]=e[2]*h+n[2]*c+r[2]*l+i[2]*f,t}function Gt(t,e){e=e||1;var n=2*I()*Math.PI,r=2*I()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Qt(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[3]*r+n[7]*i+n[11]*a+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/s,t}function Jt(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function Kt(t,e,n){var r=n[0],i=n[1],a=n[2],s=n[3],o=e[0],u=e[1],h=e[2],c=i*h-a*u,l=a*o-r*h,f=r*u-i*o,d=i*f-a*l,p=a*c-r*f,m=r*l-i*c,y=2*s;return c*=y,l*=y,f*=y,d*=2,p*=2,m*=2,t[0]=o+c+d,t[1]=u+l+p,t[2]=h+f+m,t}function $t(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function te(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function ee(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function ne(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(a*a+s*s+o*o),h=u&&Wt(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}function re(t){return t[0]=0,t[1]=0,t[2]=0,t}function ie(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function ae(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function se(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],s=e[1],o=e[2];return Math.abs(n-a)<=S*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=S*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-o)<=S*Math.max(1,Math.abs(i),Math.abs(o))}var oe,ue=zt,he=Et,ce=kt,le=Rt,fe=jt,de=wt,pe=Dt,me=(oe=bt(),function(t,e,n,r,i,a){var s,o;for(e||(e=3),n||(n=0),o=r?Math.min(r*e+n,t.length):t.length,s=n;s<o;s+=e)oe[0]=t[s],oe[1]=t[s+1],oe[2]=t[s+2],i(oe,oe,a),t[s]=oe[0],t[s+1]=oe[1],t[s+2]=oe[2];return t});function ye(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function ve(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}!function(){var t,e=(t=new T(4),T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t)}();function ge(){var t=new T(4);return T!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function _e(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function xe(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function be(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>S?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Me(t,e){var n=Ke(t,e);return Math.acos(2*n*n-1)}function we(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=n[0],u=n[1],h=n[2],c=n[3];return t[0]=r*c+s*o+i*h-a*u,t[1]=i*c+s*u+a*o-r*h,t[2]=a*c+s*h+r*u-i*o,t[3]=s*c-r*o-i*u-a*h,t}function Ae(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*o,t[1]=i*u+a*o,t[2]=a*u-i*o,t[3]=s*u-r*o,t}function Se(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u-a*o,t[1]=i*u+s*o,t[2]=a*u+r*o,t[3]=s*u-i*o,t}function Te(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*o,t[1]=i*u-r*o,t[2]=a*u+s*o,t[3]=s*u-a*o,t}function Ie(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function ze(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=Math.sqrt(n*n+r*r+i*i),o=Math.exp(a),u=s>0?o*Math.sin(s)/s:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=o*Math.cos(s),t}function Ee(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=Math.sqrt(n*n+r*r+i*i),o=s>0?Math.atan2(s,a)/s:0;return t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=.5*Math.log(n*n+r*r+i*i+a*a),t}function ke(t,e,n){return Ee(t,e),Je(t,t,n),ze(t,t),t}function Ce(t,e,n,r){var i,a,s,o,u,h=e[0],c=e[1],l=e[2],f=e[3],d=n[0],p=n[1],m=n[2],y=n[3];return(a=h*d+c*p+l*m+f*y)<0&&(a=-a,d=-d,p=-p,m=-m,y=-y),1-a>S?(i=Math.acos(a),s=Math.sin(i),o=Math.sin((1-r)*i)/s,u=Math.sin(r*i)/s):(o=1-r,u=r),t[0]=o*h+u*d,t[1]=o*c+u*p,t[2]=o*l+u*m,t[3]=o*f+u*y,t}function Oe(t){var e=I(),n=I(),r=I(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function Fe(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n*n+r*r+i*i+a*a,o=s?1/s:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=a*o,t}function Ne(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ue(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+s]-e[3*s+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}return t}function Ve(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),s=Math.cos(e),o=Math.sin(n),u=Math.cos(n),h=Math.sin(r),c=Math.cos(r);return t[0]=a*u*c-s*o*h,t[1]=s*o*c+a*u*h,t[2]=s*u*h-a*o*c,t[3]=s*u*c+a*o*h,t}function Be(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Re,je,De,qe,Pe,Le,We,He=function(t){var e=new T(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Xe=function(t,e,n,r){var i=new T(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},Ze=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Ye=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},Ge=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Qe=we,Je=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},Ke=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},$e=function(t,e,n,r){var i=e[0],a=e[1],s=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=s+r*(n[2]-s),t[3]=o+r*(n[3]-o),t},tn=ye,en=tn,nn=ve,rn=nn,an=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n*n+r*r+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=a*s,t},sn=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},on=function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3],s=e[0],o=e[1],u=e[2],h=e[3];return Math.abs(n-s)<=S*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=S*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-u)<=S*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-h)<=S*Math.max(1,Math.abs(a),Math.abs(h))},un=(Re=bt(),je=At(1,0,0),De=At(0,1,0),function(t,e,n){var r=Wt(e,n);return r<-.999999?(Ht(Re,je,e),de(Re)<1e-6&&Ht(Re,De,e),Lt(Re,Re),xe(t,Re,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Ht(Re,e,n),t[0]=Re[0],t[1]=Re[1],t[2]=Re[2],t[3]=1+r,an(t,t))}),hn=(qe=ge(),Pe=ge(),function(t,e,n,r,i,a){return Ce(qe,e,i,a),Ce(Pe,n,r,a),Ce(t,qe,Pe,2*a*(1-a)),t}),cn=(Le=new T(9),T!=Float32Array&&(Le[1]=0,Le[2]=0,Le[3]=0,Le[5]=0,Le[6]=0,Le[7]=0),Le[0]=1,Le[4]=1,Le[8]=1,We=Le,function(t,e,n,r){return We[0]=n[0],We[3]=n[1],We[6]=n[2],We[1]=r[0],We[4]=r[1],We[7]=r[2],We[2]=-e[0],We[5]=-e[1],We[8]=-e[2],an(t,Ue(t,We))});function ln(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function fn(t,e,n,r){ln.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function dn(t,e,n,r){ln.call(this,t,e,n,r)}function pn(t,e,n,r){ln.call(this,t,e,n,r)}Object.assign(ln.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var a;n:{r:if(!(t<r)){for(var s=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===s)break;if(i=r,t<(r=e[++n]))break e}a=e.length;break n}if(t>=i)break t;var o=e[1];t<o&&(n=2,i=o);for(s=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===s)break;if(r=i,t>=(i=e[--n-1]))break e}a=n,n=0}for(;n<a;){var u=n+a>>>1;t<e[u]?a=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,a=0;a!==r;++a)e[a]=n[i+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ln.prototype,{beforeStart_:ln.prototype.copySampleValue_,afterEnd_:ln.prototype.copySampleValue_}),fn.prototype=Object.assign(Object.create(ln.prototype),{constructor:fn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,a=t+1,s=r[i],o=r[a];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:i=t,s=2*e-n;break;case 2402:s=e+r[i=r.length-2]-r[i+1];break;default:i=t,s=n}if(void 0===o)switch(this.getSettings_().endingEnd){case 2401:a=t,o=2*n-e;break;case 2402:a=1,o=n+r[1]-r[0];break;default:a=t-1,o=e}var u=.5*(n-e),h=this.valueSize;this._weightPrev=u/(e-s),this._weightNext=u/(o-n),this._offsetPrev=i*h,this._offsetNext=a*h},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=t*s,u=o-s,h=this._offsetPrev,c=this._offsetNext,l=this._weightPrev,f=this._weightNext,d=(n-e)/(r-e),p=d*d,m=p*d,y=-l*m+2*l*p-l*d,v=(1+l)*m+(-1.5-2*l)*p+(-.5+l)*d+1,g=(-1-f)*m+(1.5+f)*p+.5*d,_=f*m-f*p,x=0;x!==s;++x)i[x]=y*a[h+x]+v*a[u+x]+g*a[o+x]+_*a[c+x];return i}}),dn.prototype=Object.assign(Object.create(ln.prototype),{constructor:dn,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=t*s,u=o-s,h=(n-e)/(r-e),c=1-h,l=0;l!==s;++l)i[l]=a[u+l]*c+a[o+l]*h;return i}}),pn.prototype=Object.assign(Object.create(ln.prototype),{constructor:pn,interpolate_:function(t){return this.copySampleValue_(t-1)}});var mn={arraySlice:function(t,e,n){return mn.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),a=0,s=0;s!==r;++a)for(var o=n[a]*e,u=0;u!==e;++u)i[s++]=t[o+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,a=t[0];void 0!==a&&void 0===a[r];)a=t[i++];if(void 0!==a){var s=a[r];if(void 0!==s)if(Array.isArray(s))do{void 0!==(s=a[r])&&(e.push(a.time),n.push.apply(n,s)),a=t[i++]}while(void 0!==a);else if(void 0!==s.toArray)do{void 0!==(s=a[r])&&(e.push(a.time),s.toArray(n,n.length)),a=t[i++]}while(void 0!==a);else do{void 0!==(s=a[r])&&(e.push(a.time),n.push(s)),a=t[i++]}while(void 0!==a)}},subclip:function(t,e,n,r,i){i=i||30;var a=t.clone();a.name=e;for(var s=[],o=0;o<a.tracks.length;++o){for(var u=a.tracks[o],h=u.getValueSize(),c=[],l=[],f=0;f<u.times.length;++f){var d=u.times[f]*i;if(!(d<n||d>=r)){c.push(u.times[f]);for(var p=0;p<h;++p)l.push(u.values[f*h+p])}}0!==c.length&&(u.times=mn.convertArray(c,u.times.constructor),u.values=mn.convertArray(l,u.values.constructor),s.push(u))}a.tracks=s;var m=1/0;for(o=0;o<a.tracks.length;++o)m>a.tracks[o].times[0]&&(m=a.tracks[o].times[0]);for(o=0;o<a.tracks.length;++o)a.tracks[o].shift(-1*m);return a.resetDuration(),a}};function yn(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=mn.convertArray(e,this.TimeBufferType),this.values=mn.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}Object.assign(yn,{toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:mn.convertArray(t.times,Array),values:mn.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e}}),Object.assign(yn.prototype,{constructor:yn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new pn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new dn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new fn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<t;)++i;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var s=this.getValueSize();this.times=mn.arraySlice(n,i,a),this.values=mn.arraySlice(this.values,i*s,a*s)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,s=0;s!==i;s++){var o=n[s];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,o),t=!1;break}if(null!==a&&a>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,o,a),t=!1;break}a=o}if(void 0!==r&&mn.isTypedArray(r)){s=0;for(var u=r.length;s!==u;++s){var h=r[s];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,h),t=!1;break}}}return t},optimize:function(){for(var t=mn.arraySlice(this.times),e=mn.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,a=t.length-1,s=1;s<a;++s){var o=!1,u=t[s];if(u!==t[s+1]&&(1!==s||u!==u[0]))if(r)o=!0;else for(var h=s*n,c=h-n,l=h+n,f=0;f!==n;++f){var d=e[h+f];if(d!==e[c+f]||d!==e[l+f]){o=!0;break}}if(o){if(s!==i){t[i]=t[s];var p=s*n,m=i*n;for(f=0;f!==n;++f)e[m+f]=e[p+f]}++i}}if(a>0){t[i]=t[a];for(p=a*n,m=i*n,f=0;f!==n;++f)e[m+f]=e[p+f];++i}return i!==t.length?(this.times=mn.arraySlice(t,0,i),this.values=mn.arraySlice(e,0,i*n)):(this.times=t,this.values=e),this},clone:function(){var t=mn.arraySlice(this.times,0),e=mn.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}});for(var vn=[],gn=0;gn<256;gn++)vn[gn]=(gn<16?"0":"")+gn.toString(16);var _n={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(vn[255&t]+vn[t>>8&255]+vn[t>>16&255]+vn[t>>24&255]+"-"+vn[255&e]+vn[e>>8&255]+"-"+vn[e>>16&15|64]+vn[e>>24&255]+"-"+vn[63&n|128]+vn[n>>8&255]+"-"+vn[n>>16&255]+vn[n>>24&255]+vn[255&r]+vn[r>>8&255]+vn[r>>16&255]+vn[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*_n.DEG2RAD},radToDeg:function(t){return t*_n.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){var a=Math.cos,s=Math.sin,o=a(n/2),u=s(n/2),h=a((e+r)/2),c=s((e+r)/2),l=a((e-r)/2),f=s((e-r)/2),d=a((r-e)/2),p=s((r-e)/2);"XYX"===i?t.set(o*c,u*l,u*f,o*h):"YZY"===i?t.set(u*f,o*c,u*l,o*h):"ZXZ"===i?t.set(u*l,u*f,o*c,o*h):"XZX"===i?t.set(o*c,u*p,u*d,o*h):"YXY"===i?t.set(u*d,o*c,u*p,o*h):"ZYZ"===i?t.set(u*p,u*d,o*c,o*h):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function xn(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function bn(t,e,n,r){ln.call(this,t,e,n,r)}function Mn(t,e,n,r){yn.call(this,t,e,n,r)}function wn(t,e,n,r){yn.call(this,t,e,n,r)}function An(t,e,n){yn.call(this,t,e,n)}function Sn(t,e,n,r){yn.call(this,t,e,n,r)}function Tn(t,e,n,r){yn.call(this,t,e,n,r)}function In(t,e,n,r){yn.call(this,t,e,n,r)}function zn(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=_n.generateUUID(),this.duration<0&&this.resetDuration()}function En(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tn;case"vector":case"vector2":case"vector3":case"vector4":return wn;case"color":return Sn;case"quaternion":return Mn;case"bool":case"boolean":return An;case"string":return In}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],r=[];mn.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}function kn(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,a=new Array(i),s={endingStart:2400,endingEnd:2400},o=0;o!==i;++o){var u=r[o].createInterpolant(null);a[o]=u,u.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Cn(){}Object.assign(xn,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,a,s){var o=n[r+0],u=n[r+1],h=n[r+2],c=n[r+3],l=i[a+0],f=i[a+1],d=i[a+2],p=i[a+3];if(c!==p||o!==l||u!==f||h!==d){var m=1-s,y=o*l+u*f+h*d+c*p,v=y>=0?1:-1,g=1-y*y;if(g>Number.EPSILON){var _=Math.sqrt(g),x=Math.atan2(_,y*v);m=Math.sin(m*x)/_,s=Math.sin(s*x)/_}var b=s*v;if(o=o*m+l*b,u=u*m+f*b,h=h*m+d*b,c=c*m+p*b,m===1-s){var M=1/Math.sqrt(o*o+u*u+h*h+c*c);o*=M,u*=M,h*=M,c*=M}}t[e]=o,t[e+1]=u,t[e+2]=h,t[e+3]=c}}),Object.defineProperties(xn.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(xn.prototype,{isQuaternion:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,a=t.order,s=Math.cos,o=Math.sin,u=s(n/2),h=s(r/2),c=s(i/2),l=o(n/2),f=o(r/2),d=o(i/2);return"XYZ"===a?(this._x=l*h*c+u*f*d,this._y=u*f*c-l*h*d,this._z=u*h*d+l*f*c,this._w=u*h*c-l*f*d):"YXZ"===a?(this._x=l*h*c+u*f*d,this._y=u*f*c-l*h*d,this._z=u*h*d-l*f*c,this._w=u*h*c+l*f*d):"ZXY"===a?(this._x=l*h*c-u*f*d,this._y=u*f*c+l*h*d,this._z=u*h*d+l*f*c,this._w=u*h*c-l*f*d):"ZYX"===a?(this._x=l*h*c-u*f*d,this._y=u*f*c+l*h*d,this._z=u*h*d-l*f*c,this._w=u*h*c+l*f*d):"YZX"===a?(this._x=l*h*c+u*f*d,this._y=u*f*c+l*h*d,this._z=u*h*d-l*f*c,this._w=u*h*c-l*f*d):"XZY"===a&&(this._x=l*h*c-u*f*d,this._y=u*f*c-l*h*d,this._z=u*h*d+l*f*c,this._w=u*h*c+l*f*d),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],a=n[8],s=n[1],o=n[5],u=n[9],h=n[2],c=n[6],l=n[10],f=r+o+l;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(c-u)*e,this._y=(a-h)*e,this._z=(s-i)*e):r>o&&r>l?(e=2*Math.sqrt(1+r-o-l),this._w=(c-u)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(a+h)/e):o>l?(e=2*Math.sqrt(1+o-r-l),this._w=(a-h)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(u+c)/e):(e=2*Math.sqrt(1+l-r-o),this._w=(s-i)/e,this._x=(a+h)/e,this._y=(u+c)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(_n.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var r=Math.min(1,e/n);return this.slerp(t,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,a=t._w,s=e._x,o=e._y,u=e._z,h=e._w;return this._x=n*h+a*s+r*u-i*o,this._y=r*h+a*o+i*s-n*u,this._z=i*h+a*u+n*o-r*s,this._w=a*h-n*s-r*o-i*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,a=this._w,s=a*t._w+n*t._x+r*t._y+i*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var o=1-s*s;if(o<=Number.EPSILON){var u=1-e;return this._w=u*a+e*this._w,this._x=u*n+e*this._x,this._y=u*r+e*this._y,this._z=u*i+e*this._z,this.normalize(),this._onChangeCallback(),this}var h=Math.sqrt(o),c=Math.atan2(h,s),l=Math.sin((1-e)*c)/h,f=Math.sin(e*c)/h;return this._w=a*l+this._w*f,this._x=n*l+this._x*f,this._y=r*l+this._y*f,this._z=i*l+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},fromBufferAttribute:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),bn.prototype=Object.assign(Object.create(ln.prototype),{constructor:bn,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=t*s,u=(n-e)/(r-e),h=o+s;o!==h;o+=4)xn.slerpFlat(i,0,a,o-s,a,o,u);return i}}),Mn.prototype=Object.assign(Object.create(yn.prototype),{constructor:Mn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new bn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),wn.prototype=Object.assign(Object.create(yn.prototype),{constructor:wn,ValueTypeName:"vector"}),An.prototype=Object.assign(Object.create(yn.prototype),{constructor:An,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Sn.prototype=Object.assign(Object.create(yn.prototype),{constructor:Sn,ValueTypeName:"color"}),Tn.prototype=Object.assign(Object.create(yn.prototype),{constructor:Tn,ValueTypeName:"number"}),In.prototype=Object.assign(Object.create(yn.prototype),{constructor:In,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(zn,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,a=n.length;i!==a;++i)e.push(En(n[i]).scale(r));return new zn(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},i=0,a=n.length;i!==a;++i)e.push(yn.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,a=[],s=0;s<i;s++){var o=[],u=[];o.push((s+i-1)%i,s,(s+1)%i),u.push(0,1,0);var h=mn.getKeyframeOrder(o);o=mn.sortedArray(o,1,h),u=mn.sortedArray(u,1,h),r||0!==o[0]||(o.push(i),u.push(u[0])),a.push(new Tn(".morphTargetInfluences["+e[s].name+"]",o,u).scale(1/n))}return new zn(t,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,s=t.length;a<s;a++){var o=t[a],u=o.name.match(i);if(u&&u.length>1){var h=r[l=u[1]];h||(r[l]=h=[]),h.push(o)}}var c=[];for(var l in r)c.push(zn.CreateFromMorphTargetSequence(l,r[l],e,n));return c},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var a=[],s=[];mn.flattenJSON(n,a,s,r),0!==a.length&&i.push(new t(e,a,s))}},r=[],i=t.name||"default",a=t.length||-1,s=t.fps||30,o=t.hierarchy||[],u=0;u<o.length;u++){var h=o[u].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var c={},l=0;l<h.length;l++)if(h[l].morphTargets)for(var f=0;f<h[l].morphTargets.length;f++)c[h[l].morphTargets[f]]=-1;for(var d in c){var p=[],m=[];for(f=0;f!==h[l].morphTargets.length;++f){var y=h[l];p.push(y.time),m.push(y.morphTarget===d?1:0)}r.push(new Tn(".morphTargetInfluence["+d+"]",p,m))}a=c.length*(s||1)}else{var v=".bones["+e[u].name+"]";n(wn,v+".position",h,"pos",r),n(Mn,v+".quaternion",h,"rot",r),n(wn,v+".scale",h,"scl",r)}}return 0===r.length?null:new zn(i,a,r)}}),Object.assign(zn.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new zn(this.name,this.duration,t)}}),Object.assign(kn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,a=i/r,s=r/i;t.warp(1,a,e),this.warp(s,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,s=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var o=a.parameterPositions,u=a.sampleValues;return o[0]=i,o[1]=i+n,u[0]=t/s,u[1]=e/s,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(t-i)*n;if(a<0||0===n)return;this._startTime=null,e=n*a}e*=this._updateTimeScale(t);var s=this._updateTime(e),o=this._updateWeight(t);if(o>0)for(var u=this._interpolants,h=this._propertyBindings,c=0,l=u.length;c!==l;++c)u[c].evaluate(s),h[c].accumulate(r,o)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,n=this._clip.duration,r=this.loop,i=this._loopCount,a=2202===r;if(0===t)return-1===i?e:a&&1==(1&i)?n-e:e;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0)){this.time=e;break t}e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=n||e<0){var s=Math.floor(e/n);e-=n*s,i+=Math.abs(s);var o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this.time=e,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){var u=t<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=e;if(a&&1==(1&i))return n-e}return e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var s=a.parameterPositions,o=a.sampleValues;return s[0]=i,o[0]=e,s[1]=i+t,o[1]=n,this}}),Object.assign(Cn.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});var On=new RegExp("[\\[\\]\\.:\\/]","g"),Fn="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Nn=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Un=/(WCOD+)?/.source.replace("WCOD",Fn),Vn=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Bn=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Rn=new RegExp("^"+Nn+Un+Vn+Bn+"$"),jn=["material","materials","bones"];function Dn(t,e,n){var r=n||qn.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function qn(t,e,n){this.path=e,this.parsedPath=n||qn.parseTrackName(e),this.node=qn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Pn(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Ln(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Object.assign(Dn.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(qn,{Composite:Dn,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new qn.Composite(t,e,n):new qn(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(On,"")},parseTrackName:function(t){var e=Rn.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==jn.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var a=r(i.children);if(a)return a}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(qn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=qn.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var a=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===a){a=s;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var o=t[r];if(void 0!==o){var u=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var h=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(t.geometry.morphAttributes.position[s].name===i){i=s;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(s=0;s<this.node.geometry.morphTargets.length;s++)if(t.geometry.morphTargets[s].name===i){i=s;break}}}h=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(h=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}else{var c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(qn.prototype,{_getValue_unbound:qn.prototype.getValue,_setValue_unbound:qn.prototype.setValue}),Object.assign(Pn.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,a=this.cumulativeWeight;if(0===a){for(var s=0;s!==r;++s)n[i+s]=n[s];a=e}else{var o=e/(a+=e);this._mixBufferRegion(n,i,0,o,r)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var s=3*e;this._mixBufferRegion(n,r,s,1-i,e)}for(var o=e,u=e+e;o!==u;++o)if(n[o]!==n[o+e]){a.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,a=r;i!==a;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)t[e+a]=t[n+a]},_slerp:function(t,e,n,r){xn.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var a=1-r,s=0;s!==i;++s){var o=e+s;t[o]=t[o]*a+t[n+s]*r}}}),Ln.prototype=Object.assign(Object.create(Cn.prototype),{constructor:Ln,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,a=t._propertyBindings,s=t._interpolants,o=n.uuid,u=this._bindingsByRootAndName,h=u[o];void 0===h&&(h={},u[o]=h);for(var c=0;c!==i;++c){var l=r[c],f=l.name,d=h[f];if(void 0!==d)a[c]=d;else{if(void 0!==(d=a[c])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,o,f));continue}var p=e&&e._propertyBindings[c].binding.parsedPath;++(d=new Pn(qn.create(n,f,p),l.ValueTypeName,l.getValueSize())).referenceCount,this._addInactiveBinding(d,o,f),a[c]=d}s[c].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,a=0,s=i.length;a!==s;++a){var o=i[a];0==o.useCount++&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,a=i[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=a;else{var s=a.knownActions;t._byClipCacheIndex=s.length,s.push(t)}t._cacheIndex=r.length,r.push(t),a.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,a=this._actionsByClip,s=a[i],o=s.knownActions,u=o[o.length-1],h=t._byClipCacheIndex;u._byClipCacheIndex=h,o[h]=u,o.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],0===o.length&&delete a[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],a=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,s=a[r],o=e[e.length-1],u=t._cacheIndex;o._cacheIndex=u,e[u]=o,e.pop(),delete s[i],0===Object.keys(s).length&&delete a[r]},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new dn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?zn.findByName(n,t):t,a=null!==i?i.uuid:t,s=this._actionsByClip[a],o=null;if(void 0!==s){var u=s.actionByRoot[r];if(void 0!==u)return u;o=s.knownActions[0],null===i&&(i=o._clip)}if(null===i)return null;var h=new kn(this,i,e);return this._bindAction(h,o),this._addInactiveAction(h,a,r),h},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?zn.findByName(n,t):t,a=i?i.uuid:t,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[r]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),a=this._accuIndex^=1,s=0;s!==n;++s){e[s]._update(r,t,i,a)}var o=this._bindings,u=this._nActiveBindings;for(s=0;s!==u;++s)o[s].apply(a);return this},setTime:function(t){this.time=0;for(var e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,s=0,o=a.length;s!==o;++s){var u=a[s];this._deactivateAction(u);var h=u._cacheIndex,c=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=h,e[h]=c,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var s in a){var o=a[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});var Wn=new Xn,Hn=new xn;function Xn(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(Xn.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Hn.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(Hn.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,a=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,a=t.y,s=t.z,o=t.w,u=o*e+a*r-s*n,h=o*n+s*e-i*r,c=o*r+i*n-a*e,l=-i*e-a*n-s*r;return this.x=u*o+l*-i+h*-s-c*-a,this.y=h*o+l*-a+c*-i-u*-s,this.z=c*o+l*-s+u*-a-h*-i,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,a=e.x,s=e.y,o=e.z;return this.x=r*o-i*s,this.y=i*a-n*o,this.z=n*s-r*a,this},projectOnVector:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)},projectOnPlane:function(t){return Wn.copy(this).projectOnVector(t),this.sub(Wn)},reflect:function(t){return this.sub(Wn.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(_n.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var Zn=new Xn,Yn=new tr,Gn=new Xn(0,0,0),Qn=new Xn(1,1,1),Jn=new Xn,Kn=new Xn,$n=new Xn;function tr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(tr.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,a,s,o,u,h,c,l,f,d,p,m){var y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=r,y[1]=i,y[5]=a,y[9]=s,y[13]=o,y[2]=u,y[6]=h,y[10]=c,y[14]=l,y[3]=f,y[7]=d,y[11]=p,y[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new tr).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,r=1/Zn.setFromMatrixColumn(t,0).length(),i=1/Zn.setFromMatrixColumn(t,1).length(),a=1/Zn.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,a=Math.cos(n),s=Math.sin(n),o=Math.cos(r),u=Math.sin(r),h=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var l=a*h,f=a*c,d=s*h,p=s*c;e[0]=o*h,e[4]=-o*c,e[8]=u,e[1]=f+d*u,e[5]=l-p*u,e[9]=-s*o,e[2]=p-l*u,e[6]=d+f*u,e[10]=a*o}else if("YXZ"===t.order){var m=o*h,y=o*c,v=u*h,g=u*c;e[0]=m+g*s,e[4]=v*s-y,e[8]=a*u,e[1]=a*c,e[5]=a*h,e[9]=-s,e[2]=y*s-v,e[6]=g+m*s,e[10]=a*o}else if("ZXY"===t.order){m=o*h,y=o*c,v=u*h,g=u*c;e[0]=m-g*s,e[4]=-a*c,e[8]=v+y*s,e[1]=y+v*s,e[5]=a*h,e[9]=g-m*s,e[2]=-a*u,e[6]=s,e[10]=a*o}else if("ZYX"===t.order){l=a*h,f=a*c,d=s*h,p=s*c;e[0]=o*h,e[4]=d*u-f,e[8]=l*u+p,e[1]=o*c,e[5]=p*u+l,e[9]=f*u-d,e[2]=-u,e[6]=s*o,e[10]=a*o}else if("YZX"===t.order){var _=a*o,x=a*u,b=s*o,M=s*u;e[0]=o*h,e[4]=M-_*c,e[8]=b*c+x,e[1]=c,e[5]=a*h,e[9]=-s*h,e[2]=-u*h,e[6]=x*c+b,e[10]=_-M*c}else if("XZY"===t.order){_=a*o,x=a*u,b=s*o,M=s*u;e[0]=o*h,e[4]=-c,e[8]=u*h,e[1]=_*c+M,e[5]=a*h,e[9]=x*c-b,e[2]=b*c-x,e[6]=s*h,e[10]=M*c+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Gn,t,Qn)},lookAt:function(t,e,n){var r=this.elements;return $n.subVectors(t,e),0===$n.lengthSq()&&($n.z=1),$n.normalize(),Jn.crossVectors(n,$n),0===Jn.lengthSq()&&(1===Math.abs(n.z)?$n.x+=1e-4:$n.z+=1e-4,$n.normalize(),Jn.crossVectors(n,$n)),Jn.normalize(),Kn.crossVectors($n,Jn),r[0]=Jn.x,r[4]=Kn.x,r[8]=$n.x,r[1]=Jn.y,r[5]=Kn.y,r[9]=$n.y,r[2]=Jn.z,r[6]=Kn.z,r[10]=$n.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],s=n[4],o=n[8],u=n[12],h=n[1],c=n[5],l=n[9],f=n[13],d=n[2],p=n[6],m=n[10],y=n[14],v=n[3],g=n[7],_=n[11],x=n[15],b=r[0],M=r[4],w=r[8],A=r[12],S=r[1],T=r[5],I=r[9],z=r[13],E=r[2],k=r[6],C=r[10],O=r[14],F=r[3],N=r[7],U=r[11],V=r[15];return i[0]=a*b+s*S+o*E+u*F,i[4]=a*M+s*T+o*k+u*N,i[8]=a*w+s*I+o*C+u*U,i[12]=a*A+s*z+o*O+u*V,i[1]=h*b+c*S+l*E+f*F,i[5]=h*M+c*T+l*k+f*N,i[9]=h*w+c*I+l*C+f*U,i[13]=h*A+c*z+l*O+f*V,i[2]=d*b+p*S+m*E+y*F,i[6]=d*M+p*T+m*k+y*N,i[10]=d*w+p*I+m*C+y*U,i[14]=d*A+p*z+m*O+y*V,i[3]=v*b+g*S+_*E+x*F,i[7]=v*M+g*T+_*k+x*N,i[11]=v*w+g*I+_*C+x*U,i[15]=v*A+g*z+_*O+x*V,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],a=t[1],s=t[5],o=t[9],u=t[13],h=t[2],c=t[6],l=t[10],f=t[14];return t[3]*(+i*o*c-r*u*c-i*s*l+n*u*l+r*s*f-n*o*f)+t[7]*(+e*o*f-e*u*l+i*a*l-r*a*f+r*u*h-i*o*h)+t[11]*(+e*u*c-e*s*f-i*a*c+n*a*f+i*s*h-n*u*h)+t[15]*(-r*s*h-e*o*c+e*s*l+r*a*c-n*a*l+n*o*h)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t,e,n){var r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=t.elements,i=r[0],a=r[1],s=r[2],o=r[3],u=r[4],h=r[5],c=r[6],l=r[7],f=r[8],d=r[9],p=r[10],m=r[11],y=r[12],v=r[13],g=r[14],_=r[15],x=d*g*l-v*p*l+v*c*m-h*g*m-d*c*_+h*p*_,b=y*p*l-f*g*l-y*c*m+u*g*m+f*c*_-u*p*_,M=f*v*l-y*d*l+y*h*m-u*v*m-f*h*_+u*d*_,w=y*d*c-f*v*c-y*h*p+u*v*p+f*h*g-u*d*g,A=i*x+a*b+s*M+o*w;if(0===A)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var S=1/A;return n[0]=x*S,n[1]=(v*p*o-d*g*o-v*s*m+a*g*m+d*s*_-a*p*_)*S,n[2]=(h*g*o-v*c*o+v*s*l-a*g*l-h*s*_+a*c*_)*S,n[3]=(d*c*o-h*p*o-d*s*l+a*p*l+h*s*m-a*c*m)*S,n[4]=b*S,n[5]=(f*g*o-y*p*o+y*s*m-i*g*m-f*s*_+i*p*_)*S,n[6]=(y*c*o-u*g*o-y*s*l+i*g*l+u*s*_-i*c*_)*S,n[7]=(u*p*o-f*c*o+f*s*l-i*p*l-u*s*m+i*c*m)*S,n[8]=M*S,n[9]=(y*d*o-f*v*o-y*a*m+i*v*m+f*a*_-i*d*_)*S,n[10]=(u*v*o-y*h*o+y*a*l-i*v*l-u*a*_+i*h*_)*S,n[11]=(f*h*o-u*d*o-f*a*l+i*d*l+u*a*m-i*h*m)*S,n[12]=w*S,n[13]=(f*v*s-y*d*s+y*a*p-i*v*p-f*a*g+i*d*g)*S,n[14]=(y*h*s-u*v*s-y*a*c+i*v*c+u*a*g-i*h*g)*S,n[15]=(u*d*s-f*h*s+f*a*c-i*d*c-u*a*p+i*h*p)*S,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,a=t.x,s=t.y,o=t.z,u=i*a,h=i*s;return this.set(u*a+n,u*s-r*o,u*o+r*s,0,u*s+r*o,h*s+n,h*o-r*a,0,u*o-r*s,h*o+r*a,i*o*o+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var r=this.elements,i=e._x,a=e._y,s=e._z,o=e._w,u=i+i,h=a+a,c=s+s,l=i*u,f=i*h,d=i*c,p=a*h,m=a*c,y=s*c,v=o*u,g=o*h,_=o*c,x=n.x,b=n.y,M=n.z;return r[0]=(1-(p+y))*x,r[1]=(f+_)*x,r[2]=(d-g)*x,r[3]=0,r[4]=(f-_)*b,r[5]=(1-(l+y))*b,r[6]=(m+v)*b,r[7]=0,r[8]=(d+g)*M,r[9]=(m-v)*M,r[10]=(1-(l+p))*M,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this},decompose:function(t,e,n){var r=this.elements,i=Zn.set(r[0],r[1],r[2]).length(),a=Zn.set(r[4],r[5],r[6]).length(),s=Zn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],Yn.copy(this);var o=1/i,u=1/a,h=1/s;return Yn.elements[0]*=o,Yn.elements[1]*=o,Yn.elements[2]*=o,Yn.elements[4]*=u,Yn.elements[5]*=u,Yn.elements[6]*=u,Yn.elements[8]*=h,Yn.elements[9]*=h,Yn.elements[10]*=h,e.setFromRotationMatrix(Yn),n.x=i,n.y=a,n.z=s,this},makePerspective:function(t,e,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,o=2*i/(e-t),u=2*i/(n-r),h=(e+t)/(e-t),c=(n+r)/(n-r),l=-(a+i)/(a-i),f=-2*a*i/(a-i);return s[0]=o,s[4]=0,s[8]=h,s[12]=0,s[1]=0,s[5]=u,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=l,s[14]=f,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,r,i,a){var s=this.elements,o=1/(e-t),u=1/(n-r),h=1/(a-i),c=(e+t)*o,l=(n+r)*u,f=(a+i)*h;return s[0]=2*o,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*u,s[9]=0,s[13]=-l,s[2]=0,s[6]=0,s[10]=-2*h,s[14]=-f,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var er=new tr,nr=new xn;function rr(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||rr.DefaultOrder}function ir(){this.mask=1}function ar(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}rr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],rr.DefaultOrder="XYZ",Object.defineProperties(rr.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(rr.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=_n.clamp,i=t.elements,a=i[0],s=i[4],o=i[8],u=i[1],h=i[5],c=i[9],l=i[2],f=i[6],d=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(f,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-l,d),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===e?(this._y=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-s,h))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-c,h),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(o,d))):"XZY"===e?(this._z=Math.asin(-r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-c,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(t,e,n){return er.makeRotationFromQuaternion(t),this.setFromRotationMatrix(er,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(t){return nr.setFromEuler(this),this.setFromQuaternion(nr,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Xn(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(ir.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(ar.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,a,s,o,u){var h=this.elements;return h[0]=t,h[1]=r,h[2]=s,h[3]=e,h[4]=i,h[5]=o,h[6]=n,h[7]=a,h[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,a=n[0],s=n[3],o=n[6],u=n[1],h=n[4],c=n[7],l=n[2],f=n[5],d=n[8],p=r[0],m=r[3],y=r[6],v=r[1],g=r[4],_=r[7],x=r[2],b=r[5],M=r[8];return i[0]=a*p+s*v+o*x,i[3]=a*m+s*g+o*b,i[6]=a*y+s*_+o*M,i[1]=u*p+h*v+c*x,i[4]=u*m+h*g+c*b,i[7]=u*y+h*_+c*M,i[2]=l*p+f*v+d*x,i[5]=l*m+f*g+d*b,i[8]=l*y+f*_+d*M,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8];return e*a*h-e*s*u-n*i*h+n*s*o+r*i*u-r*a*o},getInverse:function(t,e){void 0!==e&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=t.elements,r=this.elements,i=n[0],a=n[1],s=n[2],o=n[3],u=n[4],h=n[5],c=n[6],l=n[7],f=n[8],d=f*u-h*l,p=h*c-f*o,m=l*o-u*c,y=i*d+a*p+s*m;if(0===y)return this.set(0,0,0,0,0,0,0,0,0);var v=1/y;return r[0]=d*v,r[1]=(s*l-f*a)*v,r[2]=(h*a-s*u)*v,r[3]=p*v,r[4]=(f*i-s*c)*v,r[5]=(s*o-h*i)*v,r[6]=m*v,r[7]=(a*c-l*i)*v,r[8]=(u*i-a*o)*v,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,a,s){var o=Math.cos(i),u=Math.sin(i);this.set(n*o,n*u,-n*(o*a+u*s)+a+t,-r*u,r*o,-r*(-u*a+o*s)+s+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],a=r[3],s=r[6],o=r[1],u=r[4],h=r[7];return r[0]=e*i+n*o,r[3]=e*a+n*u,r[6]=e*s+n*h,r[1]=-n*i+e*o,r[4]=-n*a+e*u,r[7]=-n*s+e*h,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var sr=0,or=new Xn,ur=new xn,hr=new tr,cr=new Xn,lr=new Xn,fr=new Xn,dr=new xn,pr=new Xn(1,0,0),mr=new Xn(0,1,0),yr=new Xn(0,0,1),vr={type:"added"},gr={type:"removed"};function _r(){Object.defineProperty(this,"id",{value:sr++}),this.uuid=_n.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_r.DefaultUp.clone();var t=new Xn,e=new rr,n=new xn,r=new Xn(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new tr},normalMatrix:{value:new ar}}),this.matrix=new tr,this.matrixWorld=new tr,this.matrixAutoUpdate=_r.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ir,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}_r.DefaultUp=new Xn(0,1,0),_r.DefaultMatrixAutoUpdate=!0,_r.prototype=Object.assign(Object.create(Cn.prototype),{constructor:_r,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return ur.setFromAxisAngle(t,e),this.quaternion.multiply(ur),this},rotateOnWorldAxis:function(t,e){return ur.setFromAxisAngle(t,e),this.quaternion.premultiply(ur),this},rotateX:function(t){return this.rotateOnAxis(pr,t)},rotateY:function(t){return this.rotateOnAxis(mr,t)},rotateZ:function(t){return this.rotateOnAxis(yr,t)},translateOnAxis:function(t,e){return or.copy(t).applyQuaternion(this.quaternion),this.position.add(or.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(pr,t)},translateY:function(t){return this.translateOnAxis(mr,t)},translateZ:function(t){return this.translateOnAxis(yr,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(hr.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?cr.copy(t):cr.set(t,e,n);var r=this.parent;this.updateWorldMatrix(!0,!1),lr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hr.lookAt(lr,cr,this.up):hr.lookAt(cr,lr,this.up),this.quaternion.setFromRotationMatrix(hr),r&&(hr.extractRotation(r.matrixWorld),ur.setFromRotationMatrix(hr),this.quaternion.premultiply(ur.inverse()))},add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(vr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(gr)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),hr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),hr.multiply(t.parent.matrixWorld)),t.applyMatrix4(hr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Xn),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new xn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(lr,t,fr),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new Xn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(lr,dr,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Xn),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var s=a.shapes;if(Array.isArray(s))for(var o=0,u=s.length;o<u;o++){var h=s[o];i(t.shapes,h)}else i(t.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(o=0,u=this.material.length;o<u;o++)c.push(i(t.materials,this.material[o]));r.material=c}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(e){var l=m(t.geometries),f=m(t.materials),d=m(t.textures),p=m(t.images);s=m(t.shapes);l.length>0&&(n.geometries=l),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),s.length>0&&(n.shapes=s)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}});const xr=1313821514,br=5130562;let Mr=new TextDecoder;function wr(t){return Mr.decode(t)}class Ar{constructor(t){const e=new DataView(t,0,12),n=new DataView(t,12),r=wr(new Uint8Array(t,0,4)),i=e.getUint32(4,!0);e.getUint32(8,!0);if("glTF"!==r)throw new Error("Unsupported glTF-Binary header.");if(i<2)throw new Error("Unsupported legacy binary file detected.");let a=0;for(;a<n.byteLength;){const e=n.getUint32(a,!0);a+=4;const r=n.getUint32(a,!0);switch(a+=4,r){case xr:{const n=new Uint8Array(t,12+a,e);this.json=wr(n)}break;case br:{const n=12+a;this.binaryChunk=new Uint8Array(t,n,e)}break;default:console.warn("Skipping unexpected glTF-Binary chunk type:",r)}a+=e}b(!!this.json,"glTF-Binary: JSON content not found.")}}class Sr{constructor(t,e){this.gltf=t,this.bufferData=e}bufferViewData(t){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const e=this.gltf.bufferViews[t],n=M(this.bufferData[e.buffer],`No data for buffer ${e.buffer}`),r=e.byteLength||0,i=e.byteOffset||0,a=n.buffer,s=n.byteOffset;return new Uint8Array(a,s+i,r)}accessorData(t){if(!this.gltf.accessors)throw new Error("No accessors views found.");const e=this.gltf.accessors[t],n=Nr[e.type];let r;const i=Fr[e.componentType],a=i.BYTES_PER_ELEMENT*n*e.count;if(void 0!==e.bufferView){const t=this.bufferViewData(e.bufferView);r=new i(t.buffer,t.byteOffset+A(e.byteOffset,0),e.count*n)}else r=new i(a);if(e.sparse){const{count:t,indices:i,values:a}=e.sparse;let s=Fr[i.componentType],o=this.bufferViewData(i.bufferView);const u=new s(o.buffer,o.byteOffset+(i.byteOffset||0),t);s=Fr[e.componentType],o=this.bufferViewData(a.bufferView);const h=new s(this.bufferViewData(a.bufferView).buffer,o.byteOffset+(a.byteOffset||0),t*n);e.bufferView&&(r=new Uint8Array(r));const c=new Fr[e.componentType](r.buffer);for(let e=0;e<t;e++)for(let t=0;t<n;t++)c[n*u[e]+t]=h[n*e+t]}return r}}class Tr extends _r{clone(t=!1){const e=super.clone(t);return e.morphWeight=this.morphWeight,e.meshId=this.meshId,e.skinId=this.skinId,e}}function Ir(t,e){let n;switch(e){case 5120:n=u.Char;break;case 5121:n=u.Uchar;break;case 5122:n=u.Short;break;case 5123:n=u.Ushort;break;case 5125:n=u.Uint;break;case 5126:n=u.Float;break;default:throw new Error("Invalid GLTF component type")}switch(t){case"SCALAR":n+=0;break;case"VEC2":n+=1;break;case"VEC3":n+=2;break;case"VEC4":n+=3;break;case"MAT2":throw new Error("2x2 Matrice not yet supported");case"MAT3":n=u.Float3x3;break;case"MAT4":n=u.Float4x4}return n}function zr(t){switch(t){case 5124:return u.Int;case 5126:return u.Float;case 35664:return u.Float2;case 35665:return u.Float3;case 35666:return u.Float4;case 35667:return u.Int2;case 35668:return u.Int3;case 35669:return u.Int4;case 35675:return u.Float3x3;case 35676:return u.Float4x4;case 35678:return u.Texture2D;default:throw new Error("Invalid GLTF component type")}}function Er(t){switch(t){case 0:return p.Points;case 1:return p.Lines;case 2:return p.LineLoop;case 3:return p.LineStrip;case 4:return p.Triangles;case 5:return p.TriangleStrip;case 6:return p.TriangleFan;default:throw new Error("Invalid GLTF primitive mode")}}const kr={9728:l.Nearest,9729:l.Linear},Cr={9728:l.Nearest,9729:l.Linear},Or={33071:f.Clamp,10497:f.Repeat},Fr={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Nr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ur={POSITION:"a_pos",NORMAL:"a_normal",TANGENT:"a_tangent",JOINTS_0:"a_joints",WEIGHTS_0:"a_weights",COLOR_0:"a_color",TEXCOORD_0:"a_uv0",TEXCOORD_1:"a_uv1",MORPH0_POSITION:"a_posMorph0"},Vr={NORMAL:"HAS_NORMALS 1",TANGENT:"HAS_TANGENT 1",JOINTS_0:"HAS_JOINT_SET0 1",WEIGHTS_0:"HAS_WEIGHT_SET0 1",COLOR_0:"HAS_COLOR0 1",TEXCOORD_0:"HAS_UV_SET0 1",TEXCOORD_1:"HAS_UV_SET1 1"},Br={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},Rr={translation:"position",rotation:"quaternion",scale:"scale",weights:"_UNSUPPORTED"};function jr(t,e,n){const r=n,i=e.gltf;let a=w(n.material)?M(t.transient.materials[n.material]):void 0;const s=[];let o=void 0;const u=[];if(w(r.indices)){const n=M(i.accessors)[r.indices];o=Dr(t,e,M(n.bufferView),m.Index)}let h;if(a&&w(a.techniqueIndex)){h={};const e=M(t.transient.techniques).techniques[a.techniqueIndex],n=Object.keys(e.attributes);for(const t of n){h[e.attributes[t].semantic]=t}}else h=Ur;const c={buffers:[]},l={};for(let n in r.attributes){const a=M(i.accessors)[r.attributes[n]],o=M(a.bufferView,"Undefined accessor buffers are not yet implemented"),f=l[o];let d;if(w(f))d=c.buffers[f];else{l[o]=u.length;const n=Dr(t,e,o,m.Vertex);d={stride:A(M(i.bufferViews)[o].byteStride,0),layout:{}},u.push(n),c.buffers.push(d)}const p=Vr[n];w(p)&&s.push(p);const y=M(h[n],`Unknown vertex attribute semantic: ${n}`);d.layout[y]={type:Ir(a.type,a.componentType),offset:a.byteOffset||0}}if(r.targets){s.push("HAS_MORPH0 1"),b(1===r.targets.length,"Only 1 morph target is currently supported");const n=r.targets[0];for(let r in n)if("POSITION"===r){const a=M(i.accessors)[n[r]],s=M(a.bufferView,"Undefined accessor buffers are not yet implemented"),o=M(i.bufferViews)[s];let l=c.buffers[s];const f=Dr(t,e,s,m.Vertex);w(l)||(u[s]=f,l=c.buffers[s]={stride:A(o.byteStride,0),layout:{}});const d=h[`MORPH0_${r}`];l.layout[d]={type:Ir(a.type,a.componentType),offset:a.byteOffset||0}}}const f=i.accessors[M(r.indices,"Only indexed primitives are currently supported")],d=M(o,"Only indexed primitives are currently supported");return{mesh:{elementCount:f.count,vertexBuffers:u,primitiveType:Er(A(r.mode,4)),indexType:Ir(f.type,f.componentType),indexBuffer:d,vertexLayout:c},materialIndex:n.material}}function Dr(t,e,n,r){if(w(t.bufferViews[n]))return t.bufferViews[n];const i=M(e.gltf.bufferViews)[n].name||`buffer${n}`;t.bufferData[n]=new Uint8Array(e.bufferViewData(n)).buffer,b(!t.transferList.includes(t.bufferData[n])),t.transferList.push(t.bufferData[n]);const a={name:i,type:r,buffer:-1};return t.bufferViews[n]=a,a}function qr(t,e){return A(e.gltf.materials,[]).map((t,e)=>{var n;const r=null===(n=t.extensions)||void 0===n?void 0:n.KHR_techniques_webgl,i=r?r.technique:void 0,a=r?r.values:void 0;return{name:A(t.name,`Material${e}`),renderFormat:{blendingEnabled:!1},cullMode:t.doubleSided?g.None:g.Back,techniqueIndex:i,values:a}})}function Pr(t,e){var n;if(!(null===(n=e.gltf.extensionsUsed)||void 0===n?void 0:n.includes("KHR_techniques_webgl")))return;const r=M(e.gltf.extensions.KHR_techniques_webgl);return{shaderData:r.shaders.map((n,r)=>{const i=M(n.bufferView,"Shader loading from URI not yet supported"),a=new Uint8Array(e.bufferViewData(i)).buffer;return b(!t.transferList.includes(a)),t.transferList.push(a),a}),shaders:r.programs.map(t=>({name:t.name,fsIndex:t.fragmentShader,vsIndex:t.vertexShader})),techniques:r.techniques.map((t,e)=>{const n={};for(const e in A(t.uniforms,{})){const r=t.uniforms[e];n[e]=Object.assign(Object.assign({},r),{type:zr(r.type)})}return{shaderIndex:t.program,attributes:A(t.attributes,{}),uniforms:n}})}}function Lr(t,e){return A(e.gltf.nodes,[]).map(t=>{const n=A(t.scale,[1,1,1]),a=A(t.rotation,[0,0,0,1]),o=A(t.translation,[0,0,0]),u={name:t.name,scale:i.fromValues(n[0],n[1],n[2]),rotation:s.fromValues(a[0],a[1],a[2],a[3]),translation:i.fromValues(o[0],o[1],o[2]),morphWeight:A(t.weights,[0])[0],transform:r.create(),meshId:w(t.mesh)?t.mesh:void 0,skinId:w(t.skin)?t.skin:void 0,children:[]};if(w(t.matrix)?(u.transform.set(t.matrix),r.getRotation(u.rotation,u.transform),r.getTranslation(u.translation,u.transform),r.getScaling(u.scale,u.transform)):u.transform=r.fromRotationTranslationScale(r.create(),u.rotation,u.translation,u.scale),w(t.children))for(let n=0;n<t.children.length;n++){const r=t.children[n];M(e.gltf.nodes)[r];u.children.push(r)}return u})}async function Wr(t,e){const n=A(e.gltf.images,[]),r=A(e.gltf.textures,[]),i=A(e.gltf.samplers,[]),a={type:h.Texture2D,format:c.U8x4,usage:v.Static},s={wrapS:10497,wrapT:10497},o=n.map(n=>{const r=M(n.bufferView,"Image loading from a URI is not yet supported"),i=e.bufferViewData(r);let a;if(w(self.createImageBitmap)){const t=new Blob([i],{type:M(n.mimeType)});a=createImageBitmap(t)}else a=Promise.resolve(new Uint8Array(i).buffer);return a.then(e=>(b(!t.transferList.includes(e)),t.transferList.push(e),e))}),u=r.map(t=>{const e=A(i[t.sampler],s),n=Object.assign({},a);return w(e.magFilter)&&(n.defaultMagFilter=kr[e.magFilter],w(n.defaultMagFilter)||console.warn(`Unsupported texture mag filter: ${e.magFilter}`)),w(e.minFilter)&&(n.defaultMagFilter=Cr[e.minFilter],w(n.defaultMagFilter)||console.warn(`Unsupported texture min filter: ${e.magFilter}`)),w(e.wrapS)&&(n.defaultWrapS=Or[e.wrapS],w(n.defaultWrapS)||console.warn(`Unsupported texture wrap mode: ${e.wrapS}`)),w(e.wrapT)&&(n.defaultWrapT=Or[e.wrapT],w(n.defaultWrapT)||console.warn(`Unsupported texture wrap mode: ${e.wrapS}`)),{name:t.name,desc:n,imageIndex:M(t.source)}});return{imageData:await Promise.all(o),textures:u}}function Hr(t,e){let n=[];for(const r of A(e.gltf.animations,[])){const i=r.samplers.map(n=>{b(5126===e.gltf.accessors[n.input].componentType,"Non-float animation time type unsupported"),b(5126===e.gltf.accessors[n.output].componentType,"Non-float animation values type unsupported");const r=new Float32Array(e.accessorData(n.input)),i=new Float32Array(e.accessorData(n.output));return t.transferList.push(r.buffer,i.buffer),{times:r,values:i}}),a=[];for(const t of r.channels){const e=t.target.node;if(!w(e))continue;const n=Rr[t.target.path],s=i[t.sampler],o=A(r.samplers[t.sampler].interpolation,"LINEAR");a.push({targetNodeId:e,targetProperty:n,times:s.times,values:s.values,interpolation:o})}n.push({name:r.name,maxTime:r.maxTime,tracks:a})}return n}class Xr extends ln{copySampleValue_(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r,a=0;a!==r;a++)e[a]=n[i+a];return e}beforeStart_(t){this.copySampleValue_(t)}afterEnd_(t){this.copySampleValue_(t)}interpolate_(t,e,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=2*s,u=3*s,h=r-e,c=(n-e)/h,l=c*c,f=l*c,d=t*u,p=d-u,m=-2*f+3*l,y=f-l,v=1-m,g=y-l+c;for(let t=0;t!==s;t++){const e=a[p+t+s],n=a[p+t+o]*h,r=a[d+t+s],u=a[d+t]*h;i[t]=v*e+g*n+m*r+y*u}return i}}const Zr=self,Yr={texture:new class{async loadAsync(t){const e=await fetch(t.source.uri);if(200!=e.status)throw new Error("Failed to download image");const n=t.source.uri.match(/.*\/(.+?)\./);t.name=n&&n.length>1?n[1]:"Unknown",self.createImageBitmap?(t.imageBitmap=await createImageBitmap(await e.blob()),t.transferList.push(t.imageBitmap),t.status=a.LoadingSync):(t.imageBuffer=await e.arrayBuffer(),t.transferList.push(t.imageBuffer),t.status=a.LoadingSync)}loadSync(t,e){if(e.imageBitmap)e.texture=t.renderer?t.renderer.createTexture(e.name,{usage:v.Static,type:h.Texture2D,format:c.U8x3,maxAnistropy:16},e.imageBitmap):-1,e.imageBitmap.close(),delete e.imageBitmap,e.status=a.Loaded;else{if(e.imageBuffer){var n=new Blob([e.imageBuffer],{type:"image/jpeg"});let t=window.URL.createObjectURL(n);delete e.imageBuffer,e.imageElement=new Image,e.imageElement.src=t,e.status=a.LoadingSync}w(e.imageElement)&&e.imageElement.complete&&(e.texture=t.renderer?t.renderer.createTexture(e.name,{usage:v.Static,type:h.Texture2D,format:c.U8x3,maxAnistropy:16},e.imageElement):-1,delete e.imageElement,e.status=a.Loaded)}}unloadSync(t,e){w(e.texture)&&t.renderer&&t.renderer.removeTexture(e.texture),w(e.imageBitmap)&&e.imageBitmap.close()}},gltf:new class{async loadAsync(t){const e=await fetch(t.source.uri);if(200!=e.status)throw new Error("Failed to download GLTF");const n=await e.arrayBuffer(),r=new Ar(n),i=JSON.parse(r.json),s=new Sr(i,[r.binaryChunk]);t.nodes=[],t.meshes=[],t.materials=[],t.textures=[],t.bufferViews=[],t.animations=[],t.rootNodeIds=[],t.bufferData=[],t.transient={techniques:Pr(t,s),materials:qr(0,s),nodes:Lr(0,s),animation:Hr(t,s),textures:await Wr(t,s)},function(t,e){const n=A(e.gltf.meshes,[]);t.meshes=[];for(let r=0;r<n.length;r++){const i=M(n[r]),a=[];for(let n of i.primitives)a.push(jr(t,e,n));const s={name:i.name,id:r,primitives:a};t.meshes[r]=s}}(t,s),function(t,e){const n=A(e.gltf.skins,[]);t.skins=[];for(let r=0;r<n.length;r++){const i=n[r];let a=void 0;if(w(i.inverseBindMatrices)){const n=new Float32Array(e.accessorData(i.inverseBindMatrices));b(!t.transferList.includes(n.buffer)),t.transferList.push(n.buffer),a=[];for(let t=0;t<i.joints.length;t++)a[t]=n.subarray(16*t,16*t+16)}t.skins[r]={name:i.name,skeleton:i.skeleton,joints:i.joints,inverseBindMatrices:a}}}(t,s),function(t,e){const n=A(e.gltf.scene,0);if(w(n)){const r=M(e.gltf.scenes),i=M(r[n]);t.rootNodeIds=A(i.nodes,[])}}(t,s),b(!t.transferList.includes(n)),t.status=a.LoadingSync}loadSync(t,e){if(w(self.createImageBitmap))e.status=a.Loaded;else if(function(t,e){let n=!1;const r=t.transient.textures;let i=0;for(let o=0;o<r.textures.length;o++){const u=r.textures[o],h=r.imageData[u.imageIndex];if(w(t.textures[o]))i+=1;else{if(h instanceof ArrayBuffer){n=!0;var s=new Blob([h],{type:"image/jpeg"});let e=window.URL.createObjectURL(s);r.imageData[u.imageIndex]=new Image,r.imageData[u.imageIndex].src=e,t.status=a.LoadingSync}h.complete&&(b(w(t.textures),"This should have been defined as an empty array by loadTexturesSync()"),t.textures[o]={desc:u.desc,name:u.name,id:w(e.renderer)?e.renderer.createTexture(u.name,u.desc,h):-1})}}return i===r.textures.length?t.status=a.Loaded:t.status=a.LoadingSync,!n}(e,t))return;if(e.techniques=function(t,e){if(!w(t))return[];const n=w(e.renderer)?t.shaders.map(n=>{const r=t.shaderData[n.vsIndex],i=t.shaderData[n.fsIndex],a={name:n.name,vertSource:wr(r),fragSource:wr(i)};return e.renderer.createShader(a)}):[];return t.techniques.map(t=>({shaderId:n[t.shaderIndex],attributes:t.attributes,uniforms:t.uniforms}))}(e.transient.techniques,t),e.materials=function(t,e){return t.map(t=>({name:t.name,renderFormat:t.renderFormat,cullMode:t.cullMode,values:t.values,technique:w(t.techniqueIndex)?e.techniques[t.techniqueIndex]:void 0}))}(e.transient.materials,e),e.nodes=function(t){const e=t.map((t,e)=>{const n=new Tr;return n.name=A(t.name,`Node${e}`),n.position.set(t.translation[0],t.translation[1],t.translation[2]),n.quaternion.set(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]),n.scale.set(t.scale[0],t.scale[1],t.scale[2]),n.updateWorldMatrix(!0,!1),n.skinId=t.skinId,n.meshId=t.meshId,n.morphWeight=t.morphWeight,n});for(let n=0;n<e.length;n++){const r=t[n],i=e[n];for(const t of r.children)i.add(e[t])}return e}(e.transient.nodes),e.animations=function(t,e){const n=[];for(const r of t){const t=r.tracks.map(t=>{let n;switch(t.targetProperty){case"quaternion":n=Mn;break;case"position":case"scale":n=wn;break;default:throw new Error("Unsupported animation target property")}const r=new n(`${e.nodes[t.targetNodeId].name}.${t.targetProperty}`,t.times,t.values,Br[t.interpolation]);return"CUBICSPLINE"===t.interpolation&&(r.createInterpolant=function(t){return new Xr(this.times,this.values,this.getValueSize()/3,t)},r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),r});n.push(new zn(r.name,r.maxTime,t))}return n}(e.transient.animation,e),e.textures=function(t,e){const n=[];if(w(self.createImageBitmap)&&w(e.renderer)){for(const r of t.textures){const i=t.imageData[r.imageIndex];b(i instanceof ImageBitmap),n.push({desc:r.desc,name:r.name,id:e.renderer.createTexture(r.name,r.desc,i)})}for(const e of t.imageData)e.close()}return n}(e.transient.textures,t),w(t.renderer))for(let n in e.bufferData){const r=e.bufferViews[n],i=e.bufferData[n];r.buffer=t.renderer.createBuffer(r.name,r.type,v.Static,i)}e.status===a.Loaded&&delete e.transient}unloadSync(t,e){}}};onmessage=async t=>{Qr.onMessage(t)};class Gr{constructor(){this.processed=[],setInterval(()=>this.update(),Gr.kTickIntervalMs)}async onMessage(t){const e=t.data;for(let t of e){const e=Yr[t.source.type];if(e||(t.status=a.Failed),t.status===a.LoadingAsync)try{await e.loadAsync(t)}catch(e){t.status=a.Failed,t.error=e.stack}this.processed.push(t)}}update(){if(this.processed.length>0){const t=[];for(let e of this.processed)Array.prototype.push.apply(t,e.transferList);Zr.postMessage(this.processed,t),this.processed.length=0}}}Gr.kTickIntervalMs=33;const Qr=new Gr;e.default={}}});